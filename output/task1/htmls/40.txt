<!doctype html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0"> 
  <meta name="referrer" content="unsafe-url"> 
  <title>Компилятор с полностью гомоморфным шифрованием от Google / Хабр</title> 
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style> 
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.66f44d11.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.a5368ccd.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/css/app.080de328.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/app.34e7f643.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/6741.eb1970d2.js" as="script"> 
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.66f44d11.css">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.080de328.css"> 
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.55f14b6ad3f6b5d3418716684e371add.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script> 
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/717848\/"},"headline":"Компилятор с полностью гомоморфным шифрованием от Google","datePublished":"2023-02-19T12:36:09+03:00","dateModified":"2023-02-19T18:06:41+03:00","author":{"@type":"Person","name":"Sivchenko_translate"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования (вот объявление об этом в рассылке). С тех пор я учас...","url":"https:\/\/habr.com\/ru\/post\/717848\/#post-content-body","about":["h_crypto","h_programming","h_cpp","h_compilers","f_develop"],"image":["https:\/\/habr.com\/share\/publication\/717848\/2ffb5cd42998b306be858a79da78af13\/"]}</script> 
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script> 
  <style>.grecaptcha-badge{visibility: hidden;}</style> 
  <meta name="habr-version" content="2.112.0"> 
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613">
  <meta data-vue-meta="ssr" property="fb:pages" content="472597926099084">
  <meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image">
  <meta data-vue-meta="ssr" name="twitter:site" content="@habr_com">
  <meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name">
  <meta data-vue-meta="ssr" property="og:title" content="Компилятор с полностью гомоморфным шифрованием от Google" data-vmid="og:title">
  <meta data-vue-meta="ssr" name="twitter:title" content="Компилятор с полностью гомоморфным шифрованием от Google" data-vmid="twitter:title">
  <meta data-vue-meta="ssr" name="aiturec:title" content="Компилятор с полностью гомоморфным шифрованием от Google" data-vmid="aiturec:title">
  <meta data-vue-meta="ssr" name="description" content="Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования ( вот объявление об этом в рассылке ). С тех пор я участвовал в работе над многими..." data-vmid="description">
  <meta data-vue-meta="ssr" itemprop="description" content="Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования ( вот объявление об этом в рассылке ). С тех пор я участвовал в работе над многими..." data-vmid="description:itemprop">
  <meta data-vue-meta="ssr" property="og:description" content="Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования ( вот объявление об этом в рассылке ). С тех пор я участвовал в работе над многими..." data-vmid="og:description">
  <meta data-vue-meta="ssr" name="twitter:description" content="Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования ( вот объявление об этом в рассылке ). С тех пор я участвовал в работе над многими..." data-vmid="twitter:description">
  <meta data-vue-meta="ssr" property="aiturec:description" content="Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования ( вот объявление об этом в рассылке ). С тех пор я участвовал в работе над многими..." data-vmid="aiturec:description">
  <meta data-vue-meta="ssr" itemprop="image" content="https://habrastorage.org/getpro/habr/upload_files/7bc/7e8/1c8/7bc7e81c85f1a3b17fdb3bc800b63b3b.png" data-vmid="image:itemprop">
  <meta data-vue-meta="ssr" property="og:image" content="https://habrastorage.org/getpro/habr/upload_files/7bc/7e8/1c8/7bc7e81c85f1a3b17fdb3bc800b63b3b.png" data-vmid="og:image">
  <meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width">
  <meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <meta data-vue-meta="ssr" property="aiturec:image" content="https://habrastorage.org/getpro/habr/upload_files/7bc/7e8/1c8/7bc7e81c85f1a3b17fdb3bc800b63b3b.png" data-vmid="aiturec:image">
  <meta data-vue-meta="ssr" name="twitter:image" content="https://habrastorage.org/getpro/habr/upload_files/7bc/7e8/1c8/7bc7e81c85f1a3b17fdb3bc800b63b3b.png" data-vmid="twitter:image">
  <meta data-vue-meta="ssr" property="vk:image" content="https://habrastorage.org/getpro/habr/upload_files/7bc/7e8/1c8/7bc7e81c85f1a3b17fdb3bc800b63b3b.png?format=vk" data-vmid="vk:image">
  <meta data-vue-meta="ssr" property="aiturec:item_id" content="717848" data-vmid="aiturec:item_id">
  <meta data-vue-meta="ssr" property="aiturec:datetime" content="2023-02-19T09:36:09.000Z" data-vmid="aiturec:datetime">
  <meta data-vue-meta="ssr" content="https://habr.com/ru/post/717848/" property="og:url" data-vmid="og:url">
  <meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type">
  <meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale">
  <meta data-vue-meta="ssr" name="keywords" content="fhe, компилятор, шифрование, оптимизация"> 
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/717848/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss">
  <link data-vue-meta="ssr" href="https://habr.com/ru/post/717848/" rel="canonical" data-vmid="canonical">
  <link data-vue-meta="ssr" rel="image_src" href="https://habrastorage.org/getpro/habr/upload_files/7bc/7e8/1c8/7bc7e81c85f1a3b17fdb3bc800b63b3b.png" data-vmid="image:href">
  <link data-vue-meta="ssr" rel="amphtml" href="https://habr.com/ru/amp/post/717848/"> 
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44"> 
  <meta name="msapplication-TileColor" content="#629FBC"> 
  <meta name="apple-mobile-web-app-capable" content="yes"> 
  <meta name="mobile-web-app-capable" content="yes"> 
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"> 
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"> 
  <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"> 
  <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest"> 
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script> 
  <script>window.yaContextCb = window.yaContextCb || []</script> 
  <script src="https://yandex.ru/ads/system/context.js" async></script> 
 </head> 
 <body> 
  <div id="app" data-server-rendered="true" data-async-called="true">
   <div class="tm-layout__wrapper">
    <!----> 
    <div></div> <!----> 
    <header class="tm-header">
     <div class="tm-page-width">
      <div class="tm-header__container">
       <!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru">
         <svg height="16" width="16" class="tm-svg-img tm-header__icon">
          <title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use>
         </svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> 
       <div class="tm-dropdown tm-header__projects">
        <div class="tm-dropdown__head">
         <button class="tm-header__dropdown-toggle">
          <svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown">
           <title>Открыть список</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#arrow-down"></use>
          </svg></button>
        </div> <!---->
       </div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn"> Как стать автором </a> 
       <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline">
        <!---->
       </div> <!----> <!---->
      </div>
     </div>
    </header> 
    <div class="tm-layout">
     <div class="tm-page-progress-bar"></div> 
     <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky">
      <div class="tm-page-width">
       <div class="tm-base-layout__header-wrapper">
        <div class="tm-main-menu">
         <div class="tm-main-menu__section">
          <nav class="tm-main-menu__section-content">
           <!----> <a href="/ru/all/" class="tm-main-menu__item"> Все потоки </a> <a href="/ru/flows/develop/" class="tm-main-menu__item"> Разработка </a><a href="/ru/flows/admin/" class="tm-main-menu__item"> Администрирование </a><a href="/ru/flows/design/" class="tm-main-menu__item"> Дизайн </a><a href="/ru/flows/management/" class="tm-main-menu__item"> Менеджмент </a><a href="/ru/flows/marketing/" class="tm-main-menu__item"> Маркетинг </a><a href="/ru/flows/popsci/" class="tm-main-menu__item"> Научпоп </a>
          </nav>
         </div>
        </div> 
        <div class="tm-header-user-menu tm-base-layout__user-menu">
         <a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search">
          <svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark">
           <title>Поиск</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#search"></use>
          </svg></a> <!----> <!----> <!----> 
         <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop">
          <div class="tm-dropdown">
           <div class="tm-dropdown__head">
            <svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark">
             <title>Профиль</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#header-user"></use>
            </svg> <!---->
           </div> <!---->
          </div> <!---->
         </div> <!---->
        </div>
       </div>
      </div>
     </div> <!----> 
     <div class="tm-page-width"></div> 
     <main class="tm-layout__container">
      <div hl="ru" data-async-called="true" class="tm-page">
       <div class="tm-page-width">
        <!----> 
        <div class="tm-page__wrapper">
         <div class="tm-page__main tm-page__main_has-sidebar">
          <div class="pull-down">
           <!----> 
           <div class="pull-down__header" style="height:0px;">
            <div class="pull-down__content" style="bottom:10px;">
             <svg height="24" width="24" class="tm-svg-img pull-down__arrow">
              <title>Обновить</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#pull-arrow"></use>
             </svg>
            </div>
           </div> 
           <div class="tm-article-presenter"> 
            <div class="tm-article-presenter__body">
             <div class="tm-misprint-area">
              <div class="tm-misprint-area__wrapper">
               <article class="tm-article-presenter__content tm-article-presenter__content_narrow">
                <div class="tm-article-presenter__header"> 
                 <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet">
                  <div class="tm-article-snippet__meta-container">
                   <div class="tm-article-snippet__meta">
                    <span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/Sivchenko_translate/" title="Sivchenko_translate" class="tm-user-info__userpic">
                      <div class="tm-entity-image">
                       <svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_green">
                        <!----> <use xlink:href="/img/megazord-v28.78dd0d98..svg#placeholder-user"></use>
                       </svg>
                      </div></a> <span class="tm-user-info__user"><a href="/ru/users/Sivchenko_translate/" class="tm-user-info__username"> Sivchenko_translate <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-02-19T09:36:09.000Z" title="2023-02-19, 12:36">6 часов назад</time></span></span></span>
                   </div> <!---->
                  </div> 
                  <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Компилятор с полностью гомоморфным шифрованием от Google</span></h1> 
                  <div class="tm-article-snippet__stats">
                   <!----> 
                   <div class="tm-article-reading-time">
                    <span class="tm-svg-icon__wrapper tm-article-reading-time__icon">
                     <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                      <title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#clock"></use>
                     </svg></span> <span class="tm-article-reading-time__label"> 19 мин </span>
                   </div> <span class="tm-icon-counter tm-data-icons__item">
                    <svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon">
                     <title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#counter-views"></use>
                    </svg> <span class="tm-icon-counter__value">1.8K</span></span>
                  </div> 
                  <div class="tm-article-snippet__hubs-container">
                   <div class="tm-article-snippet__hubs">
                    <span class="tm-article-snippet__hubs-item"><a href="/ru/hub/crypto/" class="tm-article-snippet__hubs-item-link"><span>Криптография</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/programming/" class="tm-article-snippet__hubs-item-link"><span>Программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/cpp/" class="tm-article-snippet__hubs-item-link"><span>C++</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/compilers/" class="tm-article-snippet__hubs-item-link"><span>Компиляторы</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span>
                   </div>
                  </div> 
                  <div class="tm-article-snippet__labels-container">
                   <div class="tm-article-snippet__labels">
                    <!----> 
                    <div class="tm-article-snippet__label tm-article-snippet__label tm-article-snippet__label_variant-translation">
                     <span> Перевод </span>
                    </div>
                   </div>
                  </div> <!----> <!---->
                 </div>
                </div> 
                <div class="tm-article-presenter__origin">
                 <a href="https://jeremykun.com/2023/02/13/googles-fully-homomorphic-encryption-compiler-a-primer/" target="_blank" class="tm-article-presenter__origin-link"> Автор оригинала: <span> Jeremy Kun </span></a>
                </div> 
                <div data-gallery-root="" lang="ru" class="tm-article-body">
                 <div></div> 
                 <div id="post-content-body">
                  <div>
                   <div class="article-formatted-body article-formatted-body article-formatted-body_version-2">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                     <p>Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования (<a href="https://buttondown.email/j2kun/archive/career-update-homomorphic-encryption/" rel="noopener noreferrer nofollow">вот объявление об этом в рассылке</a>). С тех пор я участвовал в работе над многими проектами в этой области, в частности, руководил поддержкой на <a href="http://github.com/google/fully-homomorphic-encryption" rel="noopener noreferrer nofollow">github.com/google/fully-homomorphic-encryption</a> – это опенсорсный ПГШ-компилятор для C++. В этой статье даётся вводная информация о том, как при помощи этого инструмента компилировать программы с расчётом на ПГШ. Также пробежимся по тому, из чего этот компилятор состоит.</p>
                     <p>Если вы хотели бы поучаствовать в этом проекте, пожалуйста, напишите мне на <a href="mailto:mathintersectprogramming@gmail.com" rel="noopener noreferrer nofollow">mathintersectprogramming@gmail.com</a>&nbsp;или&nbsp;<a href="https://mathstodon.xyz/@j2kun" rel="noopener noreferrer nofollow">j2kun@mathstodon.xyz</a>. Мне придётся решить несколько бюрократических вопросов, чтобы можно было принимать вклад от сторонних разработчиков (должным образом ссылаясь на разработчиков в git-коммитах), но, при наличии достаточного интереса с вашей стороны я постараюсь управиться с этим, не откладывая.</p>
                     <h2>Обзор </h2>
                     <p>Ключевая идея в основе полностью гомоморфного шифрования (далее — ПГШ) заключается в том, что можно зашифровать данные, а затем гонять на них программы, даже не расшифровывая самих данных. Если довести такую ситуацию до крайности, то можно сказать, что обладай кто-либо физическим доступом к машине и, следовательно, возможностью проверить значения у неё в отдельных ячейках памяти в ходе выполнения программы, он всё равно не увидел бы ни малейшей информации об обрабатываемых данных (если бы не взломал криптосистему). </p>
                     <p>Наш ПГШ-компилятор преобразует программы C++, работающие с обычным текстом, в программы, работающие с соответствующими ПГШ-шифротекстами (поскольку выдаёт высокоуровневый код, затем подлежащий дальнейшей компиляции. Следовательно, этот инструмент можно охарактеризовать как <em>транспилятор</em>). Если конкретнее, транспилятор преобразует конкретное <em>подмножество</em>&nbsp;правильных программ на C++ — подробнее о том, как определяется это подмножество, мы поговорим ниже — в программы, решающие те же задачи на зашифрованных данных посредством одной из поддерживаемых реализаций ПГШ-криптосистем. В данном смысле они близки к традиционному компилятору: разбирают ввод, прогоняют несколько этапов оптимизации, генерируют некоторый вывод. Правда, как будет показано в этой статье, благодаря уникальным свойствам ПГШ этот компилятор сближается по свойствам с инструментариями для операций над аппаратными схемами.</p>
                     <p>Разнообразные варианты ПГШ, ныне поддерживаемые компилятором, называются «предзагрузкой вентилей» (gate bootstrapping). Мне не хватило бы времени детально разобрать здесь математику, лежащую в основе этого процесса — достаточно сказать, что такая технология позволяет пожертвовать производительностью, зато решает более простую задачу: выполняет оптимизацию и выдаёт работающую программу. А далее я скажу, что такая смесь ПГШ позволяет зашифровать <em>каждый бит</em> входной информации, превращая ввод в отдельный шифротекст. Затем программа представляется в виде логических (комбинационных) схем, состоящих из таких вентилей как AND (И), OR (ИЛИ), XNOR (исключающее ИЛИ), т.д.&nbsp; Одно из достоинств компилятора заключается в том, что он управляет отображением типов высшего порядка (например, целых чисел, массивов и структур) на списки зашифрованных булевых значений и обратно.</p>
                     <p>Такой подход на основе схем приводит к некоторым ограничениям, которые пронизывают всю оставшуюся часть этого материала. Во-первых, все циклы должны быть полностью размотаны, и у них должны быть статически известные границы. Во-вторых, здесь не поддерживаются такие конструкции как указатели, а также динамическое выделение памяти. В-третьих, весь поток управления мультиплексируется; это значит, что вычисляются все ветвления всех операторов if, после чего выбирается только один вариант. Наконец, есть важные практические соображения, касающиеся используемой битовой ширины типов и расширения открытого текста до зашифрованного, что влияет на производительность результирующей программы.</p>
                     <p>С другой стороны, оптимизация комбинационных схем – это хорошо изученная задача, для решения которой есть готовые продукты, поддающиеся интеграции (от автора: они что-то интегрировали) в ПГШ-компилятор. Так можно ускорить работу программ.</p>
                     <h2>Зависимости</h2>
                     <p><em>Если коротко:</em>&nbsp;почитайте&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/tree/main/docker" rel="noopener noreferrer nofollow">файлы docker</a>.</p>
                     <p>В Google применяется внутренняя система сборки, именуемая&nbsp;blaze, а её опенсорсный аналог (полностью эквивалентный оригиналу за исключением названия) именуется bazel. Одна из первых любопытных вещей, которую можно отметить по поводу компилятора: bazel используется как для сборки, так и для <em>использования</em> проекта (второй аспект хотелось бы изменить). Так что вам потребуется установить bazel, а легче всего это сделать, <a href="https://bazel.build/install/bazelisk" rel="noopener noreferrer nofollow">установив&nbsp;bazelisk</a>, который аналогичен nvm&nbsp;для Node или&nbsp;pyenv&nbsp;для Python. Сразу много версий bazel вам не понадобится, но так легче всего установить новейшую версию. Я буду пользоваться Bazel 4.0.0, но есть и более свежие версии, которые также должны нормально работать. </p>
                     <p>Вам понадобится компилятор C (я пользуюсь gcc12), поскольку большинство зависимостей в проекте построены на основе исходников (см. в следующем абзаце) и небольшого количества внешних библиотек и программ, обеспечивающих поддержку некоторых плагинов для оптимизации схем. Ниже приведён полный список для систем, основанных на debian.</p>
                     <pre><code>apt-get update &amp;&amp; apt-get install -y \
  gcc \
  git \
  libtinfo5 \
  python \
  python3 \
  python3-pip \
  autoconf \
  libreadline-dev \
  flex \
  bison \
  wget</code></pre>
                     <p>Как упоминалось выше, все остальные зависимости собираются&nbsp;<em>из исходного кода</em>, и при первой сборке проекта на эту работу требуется существенное время. Поэтому вы вполне можете клонировать и запустить эту сборку, прямо пока читаете статью. Приведённая ниже команда соберёт проект и все приводимые в качестве примера двоичные файлы, а затем кэширует промежуточные артефакты, чтобы можно было пользоваться ими в будущих сборках, просто перекомпилируя те элементы, которые могли измениться со времени последней сборки. В разделе о Bazel/Starlark подробнее рассказано о том, что делает эта команда.&nbsp;<strong>Замечание:&nbsp;</strong>особо странный случай – с LLVM. Если вы пользуетесь экзотической операционной системой (или контейнером docker, только позвольте мне не углубляться в объяснения, почему с этим есть проблема), то bazel может предпочесть собрать LLVM с нуля – в случае с первой сборкой на это может потребоваться час-два. Также он может отказать из-за того, что в вашей системе не хватает какой-то зависимости. Это особо тяжёлый случай (и жалоба №1 в случае со всеми проблемами, заводимыми у нас на GitHub). Но, если вы работаете на стандартной комбинации ОС/архитектура процессора (<a href="https://github.com/grailbio/bazel-toolchain/blob/08d1aa8cee67a7a9c51c09225cead1dad42dadc3/toolchain/internal/common.bzl" rel="noopener noreferrer nofollow">из тех, что перечислены здесь</a>), компилятор просто выберет нужную зависимость LLVM и установит её в вашей системе.</p>
                     <pre><code>git clone https://github.com/google/fully-homomorphic-encryption.git
cd fully-homomorphic-encryption
bazel build ...:all</code></pre>
                     <p>Чистая сборка на моём домашнем компьютере делается примерно за 16 минут. </p>
                     <h2>Подробный разбор двух примеров: add и string_cap </h2>
                     <p>В этом разделе я покажу два сквозных примера, в которых буду работать с компилятором как конечный пользователь. В первом примере рассмотрим донельзя простую программу, складывающую два 32-разрядных целых числа. Во втором примере будет программа, которая делает заглавным первый символ в каждом слове в строке, записанной в кодировке ASCII. Примеры уже лежат в репозитории в разделе&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/tree/main/transpiler/examples" rel="noopener noreferrer nofollow">transpiler/examples</a>, они называются&nbsp;<code>simple_sum</code>&nbsp;и&nbsp;<code>string_cap</code>.</p>
                     <p>Обе эти программы представлены в виде компиляции единственной функции, которая является входной точкой для ПГШ-компонента программы. Также предоставляются API и библиотека для интеграции этой программы с более крупной.</p>
                     <p>Начнём с&nbsp;simple_sum. Добавим заголовок и файл с исходным кодом как в любой стандартной программе на C++, но с одной дополнительной строкой, сообщающей компилятору, какую именно функцию нужно скомпилировать (а также какие функции внутри неё вызываются).</p>
                     <pre><code class="cpp">// add.h
int add(int a, int b);
 
// add.cc
#include "add.h"
 
#pragma hls_top
int add(int a, int b) {
  return a + b;
}</code></pre>
                     <p>Строка&nbsp;<code>#pragma hls_top</code>&nbsp;сообщает компилятору, какая функция является входной точкой. Кстати,&nbsp;hls&nbsp;здесь означает “<a href="https://en.wikipedia.org/wiki/High-level_synthesis" rel="noopener noreferrer nofollow">high level synthesis</a>” (высокоуровневый синтез), а сама инструкция компилятора взята из проекта <a href="https://github.com/google/xls" rel="noopener noreferrer nofollow">XLS</a>, используемого у нас в качестве парсера и первичного сборщика схем. Здесь <code>‘top’</code> означает просто «функция верхнего уровня».</p>
                     <p>Затем в файле из того же каталога, именуемом BUILD&nbsp;(см. далее раздел о Bazel/Starlark, где даётся обзор системы сборки) создаётся цель для сборки, вызывающая ПГШ-компилятор. В данном случае в качестве бэкенда воспользуемся&nbsp;<a href="https://github.com/openfheorg/openfhe-development" rel="noopener noreferrer nofollow">OpenFHE</a>.</p>
                     <pre><code class="cpp"># BUILD
# загружает ПГШ-компилятор в качестве расширения Bazel.
load("//transpiler:fhe.bzl", "fhe_cc_library")
 
fhe_cc_library(
  name = "add_fhe_lib",
  src = "add.cc",
  hdrs = ["add.h"],
  encryption = "openfhe",  # библиотека для криптосистемы бэкенда
  interpreter = True,      # используем динамическое планирование потоков
  optimizer = "yosys",     # оптимизатор логических схем
)</code></pre>
                     <p>Полный набор опций для данного правила сборки (т.e., документация по главной входной точке компилятора) находится в&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/blob/f6b6fe3894e134827010524914d8993aa994ab08/transpiler/fhe.bzl#L585" rel="noopener noreferrer nofollow">docstring по макросу bazel</a>. Я выбрал те параметры, которые, на мой взгляд, позволяют добиться золотой середины между стабильностью и производительностью.</p>
                     <p>Если выполните&nbsp;bazel build add_fhe_lib, то увидите, что сборка идёт – и на этом всё (подробнее см. в разделе «промежуточные файлы» о том, что здесь происходит за кулисами). Но, если вы что-либо неправильно введёте в файле сборки, то на этом месте компилятор споткнётся. Он генерирует заголовок и файл&nbsp;cc, содержащий тот же API, что и add, но с другими типами в качестве аргументов, а также дополнительные аргументы, требуемые на бэкенде библиотеки ПГШ.</p>
                     <p>Далее нам потребуется главная процедура, использующая эту библиотеку. Поскольку бэкендом нам служит OpenFHE, здесь понадобится некоторая работа по конфигурации и первичное шифрование всех входных значений. Вот&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/tree/main/transpiler/codelab/add" rel="noopener noreferrer nofollow">полный код</a> с небольшими изменениями, внесёнными для публикации в блоге. </p>
                     <pre><code class="cpp">#include &lt;stdio.h&gt;
#include &lt;iostream&gt;
#include &lt;ostream&gt;
 
#include "absl/strings/numbers.h"
#include "transpiler/codelab/add/add_fhe_lib.h"
#include "transpiler/data/openfhe_data.h"
 
constexpr auto kSecurityLevel = lbcrypto::MEDIUM;
 
int main(int argc, char** argv) {
  if (argc &lt; 3) {
    fprintf(stderr, "Usage: add_main [int] [int]\n\n");
    return 1;
  }
 
  int x, y;
  if(!absl::SimpleAtoi(argv[1], &amp;x)) {
    std::cout &lt;&lt; "Bad int " &lt;&lt; argv[1] &lt;&lt; std::endl;
    return 1;
  }
  if(!absl::SimpleAtoi(argv[2], &amp;y)) {
    std::cout &lt;&lt; "Bad int " &lt;&lt; argv[2] &lt;&lt; std::endl;
    return 1;
  }
  std::cout &lt;&lt; "Computing " &lt;&lt; x &lt;&lt; " + " &lt;&lt; y &lt;&lt; std::endl;
 
  // Настраиваем контекст бэкенда и ключи шифрования.
  auto context = lbcrypto::BinFHEContext();
  context.GenerateBinFHEContext(kSecurityLevel);
  auto sk = context.KeyGen();
  context.BTKeyGen(sk);
 
  OpenFhe&lt;int&gt; ciphertext_x = OpenFhe&lt;int&gt;::Encrypt(x, context, sk);
  OpenFhe&lt;int&gt; ciphertext_y = OpenFhe&lt;int&gt;::Encrypt(y, context, sk);
  OpenFhe&lt;int&gt; result(context);
  auto status = add(result, ciphertext_x, ciphertext_y, context);
  if(!status.ok()) {
    std::cout &lt;&lt; "FHE computation failed: " &lt;&lt; status &lt;&lt; std::endl;
    return 1;
  }
 
  std::cout &lt;&lt; "Result: " &lt;&lt; result.Decrypt(sk) &lt;&lt; "\n";
  return 0;
}</code></pre>
                     <p>Вот что происходит в тех частях, которые не являются явно шаблонным кодом:</p>
                     <p>Конфигурирование уровня безопасности библиотеки OpenFHE (он называется BinFHE, подсказывая, что выполняет полное гомоморфное шифрование двоичных схем).</p>
                     <pre><code>constexpr auto kSecurityLevel = lbcrypto::MEDIUM;</code></pre>
                     <p>Настройка первичного секретного ключа OpenFHE</p>
                     <pre><code>auto context = lbcrypto::BinFHEContext();
context.GenerateBinFHEContext(kSecurityLevel);
auto sk = context.KeyGen();
context.BTKeyGen(sk);</code></pre>
                     <p>Шифрование входных значений. Здесь используется API, предоставляемый компилятором (хотя, поскольку весь проект представляет собой исследовательский прототип, мне кажется, что его авторы так и не принялись за унификацию части, отвечающей за «настройку первичного секретного ключа» за API) и включаемый сюда из&nbsp;<code>include "transpiler/data/openfhe_data.h"</code> </p>
                     <pre><code class="cpp">OpenFhe&lt;int&gt; ciphertext_x = OpenFhe&lt;int&gt;::Encrypt(x, context, sk);
OpenFhe&lt;int&gt; ciphertext_y = OpenFhe&lt;int&gt;::Encrypt(y, context, sk)</code></pre>
                     <p>Затем вызываем функцию <code>add</code>&nbsp;с активированным ПГШ и дешифруем результаты.</p>
                     <p>Далее создаём ещё одно правило&nbsp;BUILD для двоичного файла:</p>
                     <pre><code class="cpp">cc_binary(
    name = "add_openfhe_fhe_demo",
    srcs = [
        "add_openfhe_fhe_demo.cc",
    ],
    deps = [
        ":add_fhe_lib",
        "//transpiler/data:openfhe_data",
        "@com_google_absl//absl/strings",
        "@openfhe//:binfhe",
    ],
)</code></pre>
                     <p>Запускаем код при помощи bazel: </p>
                     <pre><code>$ bazel run add_openfhe_fhe_demo -- 5 7
Computing 5 + 7
Result: 12</code></pre>
                     <p>На моей системе на это потребовалось менее 7 секунд.</p>
                     <p>Рассмотрим более сложный пример&nbsp;string_cap, где во всей красе предстают циклы и массивы. Это слегка упрощённая версия примера,&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/tree/main/transpiler/examples/string_cap" rel="noopener noreferrer nofollow">выложенного на GitHub</a>. Начнём с заголовка и файла с исходным кодом:</p>
                     <pre><code class="cpp">// string_cap.h
#define MAX_LENGTH 32
void CapitalizeString(char my_string[MAX_LENGTH]);
 
// string_cap.cc
#include "string_cap.h"
 
#pragma hls_top
void CapitalizeString(char my_string[MAX_LENGTH]) {
  bool last_was_space = true;
#pragma hls_unroll yes
  for (int i = 0; i &lt; MAX_LENGTH; i++) {
    char c = my_string[i];
    if (last_was_space &amp;&amp; c &gt;= 'a' &amp;&amp; c &lt;= 'z') {
      my_string[i] = c - ('a' - 'A');
    }
    last_was_space = (c == ' ');
  }
}</code></pre>
                     <p>Вот теперь есть что обсудить. Начнём с того, что у этой строки статическая длина, известная во время компиляции. Это необходимо, поскольку программа ПГШ является логической схемой. Она определяет подключения для каждого из входных значений и должна знать, сколько таких подключений определять. В данном случае у нас будет схема с 32 * 8&nbsp;подключениями, по одному на каждый разряд каждого из символов в массиве.</p>
                     <p>Вторая новинка здесь – это&nbsp;<code>#pragma hsl_unroll yes</code>, которая, как и&nbsp;<code>hls_top</code>, приказывает компилятору XLS полностью размотать этот цикл. Поскольку программа ПГШ – это статическая схема, никаких циклов в ней быть не может. XLS разматывает наши циклы за нас – и, кстати, я недавно узнал, что она использует решатель Z3, чтобы сначала&nbsp;<em>доказать</em>, что циклы могут быть размотаны (в сложных программах это может приводить к увеличению времени компиляции). Я не знаю никаких других компиляторов, в которых предусматривался бы такой этап доказательства. Складывается впечатление, что&nbsp;<a href="https://llvm.org/doxygen/LoopUnroll_8cpp_source.html#l00269" rel="noopener noreferrer nofollow">размотчик циклов LLVM</a>&nbsp;просто транжирит свои циклы ЦП, если поручить ему полностью размотать бесконечный цикл.</p>
                     <p>Основная процедура похожа на ту, что мы рассмотрели ранее:</p>
                     <pre><code class="cpp">#include &lt;array&gt;
#include &lt;iostream&gt;
#include &lt;string&gt;
 
#include "openfhe/binfhe/binfhecontext.h"
#include "transpiler/data/openfhe_data.h"
#include "transpiler/examples/string_cap/string_cap.h"
#include "transpiler/examples/string_cap/string_cap_openfhe_yosys_interpreted.h"
 
int main(int argc, char** argv) {
  if (argc &lt; 2) {
    fprintf(stderr, "Usage: string_cap_openfhe_testbench string_input\n\n");
    return 1;
  }
 
  std::string input = argv[1];
  input.resize(MAX_LENGTH, '\0');
  std::string plaintext(input);
 
  auto cc = lbcrypto::BinFHEContext();
  cc.GenerateBinFHEContext(lbcrypto::MEDIUM);
  auto sk = cc.KeyGen();
  cc.BTKeyGen(sk);
 
  auto ciphertext = OpenFheArray&lt;char&gt;::Encrypt(plaintext, cc, sk);
  auto status = CapitalizeString(ciphertext, cc);
  if (!status.ok()) {
    std::cout &lt;&lt; "FHE computation failed " &lt;&lt; status &lt;&lt; std::endl;
    return 1;
  };
  std::cout &lt;&lt; "Decrypted result: " &lt;&lt; ciphertext.Decrypt(sk) &lt;&lt; std::endl;
}</code></pre>
                     <p>Вот ключевые отличия: </p>
                     <ul>
                      <li><p>Мы изменяем размер входной информации так, чтобы она точно равнялась&nbsp;<code>MAX_LENGTH</code>, заполняя пространство нулевыми байтами.</p></li>
                      <li><p>Мы используем&nbsp;<code>OpenFheArray</code>, а не&nbsp;<code>OpenFhe</code>, чтобы закодировать массив символов. </p></li>
                     </ul>
                     <p>А теперь, пропустив&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/blob/main/transpiler/examples/string_cap/BUILD#L35" rel="noopener noreferrer nofollow">правило сборки</a>&nbsp;двоичного файла и запустив его, получим:</p>
                     <pre><code>$ bazel run string_cap_openfhe_yosys_interpreted_testbench -- 'hello there'
Decrypted result: Hello There</code></pre>
                     <p>Интересно, что на моей машине на это также уходит около 6 секунд (столько же, сколько и в случае с программой, складывающей 32-разрядные числа). Для более длинной строки (до 32 символов) получим такое же время выполнения, поскольку, естественно, программа обрабатывает все символы из <code>MAX_LENGTH</code>, не зная, являются ли они нулевыми байтами.</p>
                     <h2>Обзор Bazel и Starlark </h2>
                     <p>ПГШ-компилятор зародился в Google любопытным образом. Он был создан десятками участников-добровольцев (в те самые 20% рабочего времени, которые уделяются на сторонние проекты), и многие из них работали над инструментарием <a href="https://github.com/google/xls" rel="noopener noreferrer nofollow">XLS для аппаратного синтеза</a>, который является центральным компонентом этого компилятора. В силу таких ограничений, а также потому, что вся работа полностью велась в Google, не было особого поля для манёвра, которое позволило бы обеспечить независимость компилятора от внутреннего сборочного инструментария, используемого в Google. </p>
                     <p>Здесь мы подходим к Bazel и Starlark, сегодня служащие фасадом этого компилятора, обращённым к пользователю. <a href="https://bazel.build/" rel="noopener noreferrer nofollow">Bazel</a>&nbsp;– это опенсорсный аналог внутрикорпоративной сборочной системы Google (внутренний инструмент называется “Blaze”), а&nbsp;<a href="https://bazel.build/rules/language" rel="noopener noreferrer nofollow">Starlark</a>&nbsp;– это язык сценариев, созданный по образцу Python. Есть <a href="https://medium.com/windmill-engineering/bazel-is-the-worst-build-system-except-for-all-the-others-b369396a9e26" rel="noopener noreferrer nofollow">множество мнений</a>&nbsp;о Bazel, которые я не буду здесь повторять. Лучше сделаю минимальный обзор того, как он работает в контексте ПГШ-компилятора.</p>
                     <p>Сначала немного терминологии. Чтобы приступить к работе с Bazel, нужно сделать следующее.</p>
                     <ul>
                      <li><p>Определить <a href="https://github.com/google/fully-homomorphic-encryption/blob/main/WORKSPACE" rel="noopener noreferrer nofollow">файл</a> WORKSPACE, в котором описаны все внешние зависимости вашего проекта, рассказано, как вытягивать их исходный код, и какие команды bazel должны использоваться для их сборки. Можно сравнить эту информацию с высокоуровневыми списками CMakeList, за тем исключением, что в этом файле не содержится никаких инструкций о сборке проекта – просто объявляется корень дерева каталогов этого проекта и указывается имя проекта. </p></li>
                      <li><p>Определить набор файлов&nbsp;BUILD&nbsp;в каждом подкаталоге, указав здесь&nbsp;<em>целевые сборки</em>, которые могут быть сделаны из содержащихся в этом каталоге файлов с исходным кодом (но не из его подкаталогов). Всё точно, как с файлами CMakeLists в подкаталогах. Каждая цель для сборки может объявлять зависимости, связывающие её с другими целями для сборки, а bazel build&nbsp;гарантирует, что первым делом будут собираться именно зависимости, а также кэширует результаты сборки в пределах всего сеанса. В корне многих проектов лежит файл BUILD, это нужно для предоставления публичных библиотек и API данного проекта. </p></li>
                      <li><p>Использовать встроенные <em>правила</em> bazel, например,&nbsp;<code>cc_library</code>,&nbsp;<code>cc_binary</code>&nbsp;и&nbsp;<code>cc_test</code>, чтобы сгруппировать файлы в библиотеки, поддающиеся сборке при помощи <code>bazel build</code>, исполняемые двоичные файлы, которые также можно выполнять при помощи &nbsp;<code>bazel run</code>, а также тесты, которые можно выполнять при помощи&nbsp;bazel test. Большинство правил bazel сводятся к вызову какой-либо исполняемой программы, например, gcc или&nbsp;javac&nbsp;с конкретными аргументами. Одновременно с этим отслеживается накапливающееся множество зависимостей, касающихся артефактов сборки, это делается в «герметичном» месте файловой системы. </p></li>
                      <li><p>Написать любые дополнительные <em>макросы</em> bazel,&nbsp;сцепляющие встроенные команды bazel, например, чтобы определять локальные группирования сборочных команд, которые должны происходить в определённой последовательности. Эти макросы выглядят как функции на Python, вызывающие отдельные правила bazel и, возможно, передающие данные между ними. Они записываются в файлах&nbsp;.bzl, которые интерпретируются непосредственно самим bazel. </p></li>
                     </ul>
                     <p>Вообще сборка целей в&nbsp;bazel&nbsp;проходит в две фазы. Сначала идёт фаза анализа. На ней загружаются все файлы BUILD&nbsp;и импортированные файлы .bzl, а также просматриваются все правила, которые при этом вызывались. В частности, компилятор&nbsp;<em>выполняет</em>&nbsp;макросы, так как должен знать, какие правила через них вызываются (а выполнение правил можно подстраховывать на уровне потока управления, либо можно динамически генерировать их аргументы, т.д.). Но правила сборки как таковые он <em>не выполняет</em>. За этой работой компилятору удаётся построить полный граф зависимостей, сообщить об опечатках, недостающих зависимостях, циклах, т.д. По завершении фазы анализа компилятор выполняет базовые правила в том порядке, в котором идут зависимости, и кэширует результаты. Bazel вновь выполнит какое-либо правило только в случае, если что-либо изменится в базовых зависимостях или в тех файлах, от которых он зависит.</p>
                     <p>Компилятор ПГШ написан на Starlark – в том смысле, что главной входной точкой компилятора является макрос Bazel <code>fhe_cc_library</code>. Этот макрос сцепляет ряд правил, которые вызывают парсер, оптимизатор схем и этапы генерации кода – для каждого из этих элементов предусмотрено своё правило Bazel. Каждое из этих правил по очереди объявляет или записывает файлы, которые мы можем проверить – об этом в следующем разделе.</p>
                     <p>Вот как выглядит&nbsp;<code>fhecclibrary</code>&nbsp;(если коротко, это подмножество потока управления):</p>
                     <pre><code class="python">def fhe_cc_library(name, src, hdrs, copts = [], num_opt_passes = 1,
        encryption = "openfhe", optimizer = "xls", interpreter = False, library_name = None,
        **kwargs):
    """Правило для сборки библиотек cc_libraries на основе ПГШ. [docstring пропущен]"""
    transpiled_xlscc_files = "{}.cc_to_xls_ir".format(name)
    library_name = library_name or name
    cc_to_xls_ir(
        name = transpiled_xlscc_files,
        library_name = library_name,
        src = src,
        hdrs = hdrs,
        defines = kwargs.get("defines", None),
    )
 
    # ниже мы добавляем ведущее двоеточие к аргументу `src`, тем самым указывая, 
    # где находятся файлы, сгенерированные по предыдущему правилу. При этом имя файла 
    # служит уникальным идентификатором.
    transpiled_structs_headers = "{}.xls_cc_transpiled_structs".format(name)
    xls_cc_transpiled_structs(
        name = transpiled_structs_headers,
        src = ":" + transpiled_xlscc_files,
        encryption = encryption,
    )
 
    if optimizer == "yosys":  # other branch omitted for brevity
        verilog = "{}.verilog".format(name)
        xls_ir_to_verilog(name = verilog, src = ":" + transpiled_xlscc_files)
        netlist = "{}.netlist".format(name)
        verilog_to_netlist(name = netlist, src = ":" + verilog, encryption = encryption)
        cc_fhe_netlist_library(
            name = name,
            src = ":" + netlist,
            encryption = encryption,
            interpreter = interpreter,
            transpiled_structs = ":" + transpiled_structs_headers,
            copts = copts,
            **kwargs
        )
</code></pre>
                     <p>Среди правил, вызываемых макросом, есть следующие: </p>
                     <ul>
                      <li><p><code>cc_to_xls_ir</code>, вызывающее парсер&nbsp;xlscc&nbsp;и выдающее внутреннее представление программы в виде высокоуровневой схемы. На этом шаге выполняется размотка циклов и другие умные вещи, связанные с преобразованием кода C++ в схему. </p></li>
                      <li><p><code>xlscc_transpiled_structs</code>, вызывающее двоичный файл, который обрабатывает структуры (эта часть сложная, её рассмотрение выходит за рамки данной статьи). </p></li>
                      <li><p><code>xls_ir_to_verilog</code>, преобразующее внутреннее представление XLS IR в verilog, так, чтобы его можно было оптимизировать при помощи Yosys/ABC – популярной программы для проектирования и оптимизации схем. </p></li>
                      <li><p><code>verilog_to_netlist</code>, вызывающее Yosys как для оптимизации схемы, так и для преобразования её в максимально низкоуровневое внутреннее представление, называемое&nbsp;<a href="https://en.wikipedia.org/wiki/Netlist" rel="noopener noreferrer nofollow">netlist</a>. </p></li>
                      <li><p>cc_fhe_netlist_library, вызывающее этап генерации, чтобы сформировать код C++ из netlist, сделанного на предыдущем этапе. </p></li>
                     </ul>
                     <p>В результате всей этой работы получается библиотека на C++ (сгенерированная на предыдущем этапе), которую можно слинковать для работы с имеющейся программой, и исходный код которой (сгенерированный выше) можно проверить. Теперь давайте посмотрим, как выглядит каждый из сгенерированных файлов. </p>
                     <h2>Промежуточные файлы, сгенерированные компилятором</h2>
                     <p>Выше я упоминал, что промежуточные файлы, сгенерированные каждым правилом сборки, bazel кладёт в «герметичное» место в файловой системе. На это место ставится символьная ссылка из корня рабочего пространства, это делается при помощи&nbsp;<code>bazel-bin</code>. </p>
                     <pre><code>$ ls -al . | grep bazel-bin
/home/j2kun/.cache/bazel/_bazel_j2kun/42987a3d4769c6105b2fa57d2291edc3/execroot/com_google_fully_homomorphic_encryption/bazel-out/k8-opt/bin</code></pre>
                     <p>В&nbsp;bazel-bin&nbsp;содержится зеркало дерева исходников проекта, а в каталоге для правила сборки находятся все сгенерированные файлы. Вот как эта информация выглядит для нашего сумматора 32-разрядных чисел: </p>
                     <pre><code>$ ls
_objs                                   add_test
add_fhe_lib.cc                          add_test-2.params
add_fhe_lib.entry                       add_test.runfiles
add_fhe_lib.generic.types.h             add_test.runfiles_manifest
add_fhe_lib.h                           libadd.a
add_fhe_lib.ir                          libadd.a-2.params
add_fhe_lib.netlist.v                   libadd.pic.a
add_fhe_lib.netlist.v.dot               libadd.pic.a-2.params
add_fhe_lib.opt.ir                      libadd.so
add_fhe_lib.types.h                     libadd.so-2.params
add_fhe_lib.v                           libadd_fhe_lib.a
add_fhe_lib.ys                          libadd_fhe_lib.a-2.params
add_fhe_lib_meta.proto                  libadd_fhe_lib.pic.a
add_openfhe_fhe_demo                    libadd_fhe_lib.pic.a-2.params
add_openfhe_fhe_demo-2.params           libadd_fhe_lib.so
add_openfhe_fhe_demo.runfiles           libadd_fhe_lib.so-2.params
add_openfhe_fhe_demo.runfiles_manifest</code></pre>
                     <p>Виден вывод, это файлы&nbsp;<code>.h</code>&nbsp;и&nbsp;<code>.cc</code>, а также скомпилированные на их основе файлы&nbsp;<code>.so</code>&nbsp;(артефакты сборки вывода), но для нас важнее внутренние сгенерированные файлы. Именно здесь можно посмотреть, какими получились сгенерированные схемы.</p>
                     <p>Первый файл, который лучше рассмотреть подробнее – это&nbsp;<code>add_fhe_lib.opt.ir</code>, представляющий собой вывод компилятора xlscc&nbsp;с включением XLS-внутреннего шага оптимизации. Именно здесь в основном изложено, как компилятор использует проект XLS: преобразует входную программу в схему. Файл выглядит так:</p>
                     <pre><code>package my_package
 
file_number 1 "./transpiler/codelab/add/add.cc"
 
top fn add(x: bits[32], y: bits[32]) -&gt; bits[32] {
  ret add.3: bits[32] = add(x, y, id=3, pos=[(1,18,25)])
}</code></pre>
                     <p>Как видите, это определённое в XLS внутреннее представление (IR) главной процедуры, снабжённое некоторыми дополнительными метаданными к исходному коду. Поскольку XLS-IR нативно поддерживает операции сложения, результат тривиален. Здесь интересно отметить, что числа представлены в виде битовых массивов. Если коротко,&nbsp;<a href="https://google.github.io/xls/ir_semantics/" rel="noopener noreferrer nofollow">система значимых типов</a>&nbsp;XLS-IR поддерживает только биты, массивы и кортежи, причём, кортежи здесь – это механизм для поддержки структур.</p>
                     <p>Далее XLS-IR преобразуется в Verilog в&nbsp;<code>addfhelib.v</code>, и в результате даёт (тоже тривиальный) код:</p>
                     <pre><code class="cpp">module add(
  input wire [31:0] x,
  input wire [31:0] y,
  output wire [31:0] out
);
  wire [31:0] add_6;
  assign add_6 = x + y;
  assign out = add_6;
endmodule</code></pre>
                     <p>На следующем этапе нужно прогнать этот verilog через&nbsp;<a href="https://github.com/YosysHQ/yosys" rel="noopener noreferrer nofollow">Yosys</a>, это зрелый комплект для синтеза схем. В контексте нашего проекта Yosys решает две задачи: </p>
                     <ul>
                      <li><p>Преобразует высокоуровневые операции в заданный набор логических вентилей (оперирующих отдельными битами) </p></li>
                      <li><p>Оптимизирует полученную в результате схему, так, чтобы её размер получился минимальным </p></li>
                     </ul>
                     <p>XLS также на это способен, и, если хотите в этом убедиться, можете заменить у сборочного правила <code>optimizer</code>&nbsp;атрибут&nbsp;<code>yosys</code>&nbsp;на&nbsp;<code>xls</code>. Но мы обнаружили, что у Yosys схемы, как правило, получаются в 2-3 раза меньше. Скрипт, который мы даём yosys, находится в файле <code>fhe_yosys.bzl</code>. В этом файле заключены макросы bazel и правила, касающиеся вызова Yosys. Вывод программы-сумматора получается таким: </p>
                     <pre><code>module add(x, y, out);
  wire _000_;
  wire _001_;
  wire _002_;
  [...]
  wire _131_;
  wire _132_;
  output [31:0] out;
  wire [31:0] out;
  input [31:0] x;
  wire [31:0] x;
  input [31:0] y;
  wire [31:0] y;
  nand2 _133_ (.A(x[12]), .B(y[12]), .Y(_130_));
  xor2 _134_ ( .A(x[12]), .B(y[12]), .Y(_131_));
  nand2 _135_ ( .A(x[11]), .B(y[11]), .Y(_132_));
  or2 _136_ ( .A(x[11]), .B(y[11]), .Y(_000_));
  nand2 _137_ ( .A(x[10]), .B(y[10]), .Y(_001_));
  xor2 _138_ ( .A(x[10]), .B(y[10]), .Y(_002_));
  nand2 _139_ ( .A(x[9]), .B(y[9]), .Y(_003_));
  or2 _140_ ( .A(x[9]), .B(y[9]), .Y(_004_));
  nand2 _141_ ( .A(x[8]), .B(y[8]), .Y(_005_));
  xor2 _142_ ( .A(x[8]), .B(y[8]), .Y(_006_));
  nand2 _143_ ( .A(x[7]), .B(y[7]), .Y(_007_));
  or2 _144_ ( .A(x[7]), .B(y[7]), .Y(_008_));
  [...]
  xor2 _291_ ( .A(_006_), .B(_035_), .Y(out[8]));
  xnor2 _292_ ( .A(x[9]), .B(y[9]), .Y(_128_));
  xnor2 _293_ ( .A(_037_), .B(_128_), .Y(out[9]));
  xor2 _294_ ( .A(_002_), .B(_039_), .Y(out[10]));
  xnor2 _295_ ( .A(x[11]), .B(y[11]), .Y(_129_));
  xnor2 _296_ ( .A(_041_), .B(_129_), .Y(out[11]));
  xor2 _297_ ( .A(_131_), .B(_043_), .Y(out[12]));
endmodule</code></pre>
                     <p>Получается схема, в которой всего 165 вентилей.</p>
                     <p>Затем на этапе генерации кода производится файл&nbsp;<code>add_fhe_lib.cc</code>, загружающий схему в интерпретатор, а интерпретатор умеет отобразить операцию&nbsp;<code>and2</code>&nbsp;на выбранный библиотечный вызов бэкендовой криптосистемы (см.&nbsp;<a href="https://github.com/google/fully-homomorphic-encryption/blob/main/transpiler/yosys_openfhe_runner.cc" rel="noopener noreferrer nofollow">исходный код бэкенда OpenFHE</a>) и использует планирование пула потоков на ЦП, чтобы ускорить вычисление всей схемы.</p>
                     <p>Что касается схемы string_cap, файл&nbsp;<a href="https://pastebin.com/raw/1friPEPh" rel="noopener noreferrer nofollow">opt.ir</a>&nbsp;демонстрирует более разнообразное внутреннее представление XLS, в том числе, операции по расширению знака, индексированию и срезу массивов, а также мультиплексированию веток (<code>sel</code>). В результате оптимизации получается <a href="https://pastebin.com/raw/DMhP941T" rel="noopener noreferrer nofollow">684-вентильная схема</a>&nbsp;(хотя, многие из этих вентилей являются «инвертирующими» или «буферные», а значит, обходятся для ПГШ фактически даром).</p>
                     <p>Компилятор также выдаёт файл <code>.dot</code>, который можно отобразить <a href="https://github.com/j2kun/j2kun.github.io/blob/main/svg/string_cap_openfhe_yosys_interpreted.netlist.v.dot.svg" rel="noopener noreferrer nofollow">в формате SVG</a>&nbsp;(внимание, размер SVG ~2,3 МибиБ). Осмотрев схему, вы убедитесь, что она достаточно неглубокая и широкая, что позволяет планировщику потоков развернуться в этой схеме с параллелизмом, и в результате она станет быстро работать. Тем временем сумматор 32-разрядных чисел, пусть на него и приходится всего около 25% вентилей – схема гораздо более глубокая и, следовательно, параллелизма в нём меньше.</p>
                     <h2>Поддерживаемые программы для ввода C++ и издержки на шифрование</h2>
                     <p>Выше у нас была экскурсия по компилятору, но, если вы собираетесь писать программы при помощи этого компилятора, необходимо учитывать несколько вещей.</p>
                     <p>Во-первых, поддерживаемое этим компилятором подмножество C++ довольно невелико. Как упоминалось выше, все данные должны иметь статические размеры. Таким образом, нельзя написать программу, которая обрабатывала бы произвольные изображения. Вместо этого придётся взять верхнюю границу размера изображения, в соответствии с этим заполнить изображение нулями и только потом шифровать, а затем написать программу, которая бы оперировала изображением именно такого размера. В том же ключе выбранные вами целочисленные типы нетривиальным образом повлияют на производительность. Чтобы в этом убедиться, замените тип <code>int</code>&nbsp;в 32-разрядном сумматоре на&nbsp;<code>char</code>&nbsp;и посмотрите, какая схема у вас получится.</p>
                     <p>Аналогично, в циклах нужно предусмотреть статические ограничения на количество итераций. Точнее, xlscc&nbsp;должен быть в состоянии полностью размотать каждый цикл. Таким образом, допускаются некоторые формы циклов while и такая рекурсия, которая доказуемо завершается. Здесь возможны некоторые проблемы, если во вводимом коде содержатся циклы со сложными критериями выхода (например,&nbsp;<code>break</code> контролируется при помощи if/else). Также в таком случае нужно тщательно продумывать, как именно писать циклы, хотя, работа над компилятором продолжается, и возможно, что в будущем он возьмёт это продумывание на себя.</p>
                     <p>Наконец, если шифровать каждый бит обычного текста, это серьёзно сказывается на использовании доступного пространства. Каждая операция по шифрованию отдельного бита соответствует списку примерно из 700 32-разрядных целых чисел. Если вы хотите зашифровать монохромное изображение размером 100×100 пикселей, каждый пиксель которого выражается 8-разрядным целым числом (0-255), вам понадобится&nbsp;<strong>218 МибиБ,</strong>&nbsp;чтобы сохранить все эти пиксели в памяти. Это примерно 20&nbsp;000-кратные издержки. Для сравнения, видеоклип на песню Рика Эстли “Never Gonna Give You Up” при качестве 360p занимает около 9 МибиБ (что довольно мало для трёхминутного видео!). Если же этот видеоклип будет зашифрован по ПГШ, то его размер составит <strong>188 ГибиБ</strong>, что (осторожная оценка) соответствует 20 полнометражным фильмам в качестве 1080p. В некоторых других схемах ПГШ предусмотрены меньшие размеры шифротекста, но это достигается за счёт ещё более высоких требований к оперативной памяти, в которой будут производиться вычисления. Поэтому, если вы собираетесь эксплуатировать программы для обработки видео – это осуществимо, но работу потребуется должным образом распределить, а также продумать, как максимально ужать данные перед шифрованием. Например, можно работать при низком разрешении, в тонах серого, с пониженной кадровой частотой. Все эти меры также в целом ускорят работу программ.</p>
                     <p>До новых встреч!</p>
                     <p></p>
                    </div>
                   </div>
                  </div> <!----> <!---->
                 </div> <!----> <!---->
                </div> <!----> 
                <div class="tm-article-presenter__meta">
                 <div class="tm-separated-list tm-article-presenter__meta-list">
                  <span class="tm-separated-list__title">Теги:</span> 
                  <ul class="tm-separated-list__list">
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bfhe%5D" class="tm-tags-list__link">fhe</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BA%D0%BE%D0%BC%D0%BF%D0%B8%D0%BB%D1%8F%D1%82%D0%BE%D1%80%5D" class="tm-tags-list__link">компилятор</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%88%D0%B8%D1%84%D1%80%D0%BE%D0%B2%D0%B0%D0%BD%D0%B8%D0%B5%5D" class="tm-tags-list__link">шифрование</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D0%BE%D0%BF%D1%82%D0%B8%D0%BC%D0%B8%D0%B7%D0%B0%D1%86%D0%B8%D1%8F%5D" class="tm-tags-list__link">оптимизация</a></li>
                  </ul>
                 </div> 
                 <div class="tm-separated-list tm-article-presenter__meta-list">
                  <span class="tm-separated-list__title">Хабы:</span> 
                  <ul class="tm-separated-list__list">
                   <li class="tm-separated-list__item"><a href="/ru/hub/crypto/" class="tm-hubs-list__link">Криптография</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/hub/programming/" class="tm-hubs-list__link">Программирование</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/hub/cpp/" class="tm-hubs-list__link">C++</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/hub/compilers/" class="tm-hubs-list__link">Компиляторы</a></li>
                  </ul>
                 </div>
                </div>
               </article>
              </div> <!---->
             </div> 
             <div class="tm-article-sticky-panel">
              <div class="tm-data-icons tm-article-sticky-panel__icons">
               <div class="tm-article-rating tm-data-icons__item">
                <div class="tm-votes-meter tm-article-rating__votes-switcher">
                 <svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article">
                  <title>Всего голосов 14: ↑13 и ↓1</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#counter-rating"></use>
                 </svg> <span title="Всего голосов 14: ↑13 и ↓1" class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_positive tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">+12</span>
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon">
                 <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                  <title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#counter-favorite"></use>
                 </svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter"> 20 </span></button> 
               <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item">
                <a href="/ru/post/717848/comments/" class="tm-article-comments-counter-link__link">
                 <svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon">
                  <title>Комментарии</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#counter-comments"></use>
                 </svg> <span class="tm-article-comments-counter-link__value"> 1 </span></a> <!---->
               </div> 
               <div title="Поделиться" class="tm-sharing tm-data-icons__item">
                <button type="button" class="tm-sharing__button">
                 <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon">
                  <path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path>
                 </svg></button> 
                <div class="v-portal" style="display:none;"></div>
               </div> 
               <div class="v-portal" style="display:none;"></div>
              </div> 
             </div>
            </div> 
            <div class="v-portal" style="display:none;"></div> 
            <div class="tm-article-presenter__footer">
             <div class="tm-article-blocks">
              <!----> 
              <section class="tm-block tm-block tm-block_spacing-bottom">
               <!----> 
               <div class="tm-block__body tm-block__body tm-block__body_variant-balanced">
                <div class="tm-article-author"> 
                 <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article">
                  <div class="tm-user-card__info-container">
                   <div class="tm-user-card__header">
                    <div class="tm-user-card__header-data">
                     <a href="/ru/users/Sivchenko_translate/" class="tm-user-card__userpic tm-user-card__userpic_size-40">
                      <div class="tm-entity-image">
                       <svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_green">
                        <!----> <use xlink:href="/img/megazord-v28.78dd0d98..svg#placeholder-user"></use>
                       </svg>
                      </div></a> 
                     <div class="tm-user-card__meta">
                      <div title=" 138 голосов " class="tm-karma tm-user-card__karma tm-karma">
                       <div class="tm-karma__votes tm-karma__votes_positive">
                         96 
                       </div> 
                       <div class="tm-karma__text">
                         Карма 
                       </div> 
                       <div class="v-portal" style="display:none;"></div>
                      </div> 
                      <div title="Рейтинг пользователя" class="tm-rating tm-user-card__rating">
                       <div class="tm-rating__header"> 
                        <div class="tm-rating__counter tm-rating__counter">
                         43.2
                        </div>
                       </div> 
                       <div class="tm-rating__text tm-rating__text">
                         Рейтинг 
                       </div>
                      </div>
                     </div>
                    </div>
                   </div> 
                   <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article">
                    <div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article">
                     <!----> <a href="/ru/users/Sivchenko_translate/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article"> @Sivchenko_translate </a> <!---->
                    </div> 
                    <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p>
                   </div>
                  </div> 
                  <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article">
                   <!----> <!----> <!----> <!----> <!---->
                  </div>
                 </div> <!---->
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div> <!---->
              </section> 
              <div class="tm-adfox-banner__container tm-page-article__banner">
               <!----> 
               <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div>
              </div> 
              <div class="tm-article-blocks__comments">
               <div class="tm-article-page-comments">
                <div class="tm-article-comments-counter-link tm-article-comments-counter-button">
                 <a href="/ru/post/717848/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style">
                  <svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted">
                   <title>Комментарии</title> <use xlink:href="/img/megazord-v28.78dd0d98..svg#counter-comments"></use>
                  </svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментарии 1 </span></a> <!---->
                </div>
               </div>
              </div> 
              <section class="tm-block tm-block tm-block_spacing-bottom">
               <header class="tm-block__header tm-block__header tm-block__header_variant-borderless">
                <div class="tm-block__header-container">
                 <h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> 
                </div> <!---->
               </header> 
               <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim">
                <div class="tm-tabs tm-tabs">
                 <div>
                  <span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim"> Лучшие за сутки </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim"> Похожие </button></span>
                 </div> <!---->
                </div> 
                <div class="similar-and-daily__tab-view">
                 <div>
                  <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> 
                  <div class="tm-placeholder-article-cards">
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                  </div> <!----> <!----> <!----> <!---->
                 </div> <!---->
                </div>
               </div> <!---->
              </section> 
              <div>
               <div>
                <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> 
                <div class="tm-placeholder-promo">
                 <div class="tm-placeholder-promo__header">
                  <div class="tm-placeholder__line tm-placeholder__line_promo-title"></div>
                 </div> 
                 <div class="tm-placeholder-promo__body">
                  <div class="tm-placeholder-promo__posts">
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div> 
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div> 
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div>
                  </div> 
                  <div class="tm-placeholder-promo__dots">
                   <div class="tm-placeholder-promo__dot"></div> 
                   <div class="tm-placeholder-promo__dot"></div> 
                   <div class="tm-placeholder-promo__dot"></div>
                  </div>
                 </div>
                </div> <!----> <!----> <!----> <!----> <!---->
               </div>
              </div> 
              <div>
               <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> 
               <div class="tm-placeholder-inset tm-placeholder-courses">
                <div class="tm-placeholder-inset__header">
                 <div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div>
                </div> 
                <div class="tm-placeholder-inset__body">
                 <ul class="tm-placeholder-list">
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__company-avatar"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__company-avatar"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__company-avatar"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__company-avatar"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__company-avatar"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                 </ul>
                </div> 
                <div class="tm-placeholder-inset__footer">
                 <div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div>
                </div>
               </div> <!----> <!----> <!----> <!----> <!----> <!----> <!---->
              </div> <!----> <!----> 
             </div>
            </div>
           </div>
          </div>
         </div> 
         <div class="tm-page__sidebar">
          <div class="tm-layout-sidebar">
           <div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial">
            <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top">
             <!----> 
             <div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-half-page"></div>
            </div>
           </div> 
           <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;">
            <!----> 
            <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-stories-block tm-block tm-block_spacing-top">
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Истории</h2> 
              </div> <!---->
             </header> 
             <div class="tm-block__body tm-block__body tm-block__body_variant-equal-small">
              <div class="tm-stories-empty">
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
              </div> <!---->
             </div> <!---->
            </section> 
            <section data-async-called="true" class="tm-block tm-block tm-block_spacing-around">
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Работа</h2> 
              </div> <!---->
             </header> 
             <div class="tm-block__body tm-block__body">
              <div class="tm-vacancies-block__item">
               <a href="https://career.habr.com/vacancies/c_plus_plus_qt_developer" target="_blank" class="tm-vacancies-block__vacancy-title"> QT разработчик </a> 
               <div class="tm-vacancies-block__vacancies-count">
                 14 вакансий 
               </div>
              </div>
              <div class="tm-vacancies-block__item">
               <a href="https://career.habr.com/vacancies/programmist_c_plus_plus" target="_blank" class="tm-vacancies-block__vacancy-title"> Программист C++ </a> 
               <div class="tm-vacancies-block__vacancies-count">
                 117 вакансий 
               </div>
              </div>
             </div> 
             <footer class="tm-block__footer">
              <a href="https://career.habr.com/catalog" class="tm-block-extralink"> Все вакансии </a>
             </footer>
            </section> 
            <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom">
             <!----> 
             <div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-medium-rectangle"></div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </main> <!---->
    </div> 
    <div class="tm-footer-menu">
     <div class="tm-page-width">
      <div class="tm-footer-menu__container">
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Ваш аккаунт </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/717848/&amp;hl=ru" rel="nofollow" target="_self"> Войти </a></li>
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/717848/&amp;hl=ru" rel="nofollow" target="_self"> Регистрация </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Разделы </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active"> Публикации </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link"> Новости </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link"> Хабы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link"> Компании </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link"> Авторы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link"> Песочница </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Информация </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link"> Устройство сайта </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link"> Для авторов </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link"> Для компаний </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link"> Документы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank"> Соглашение </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank"> Конфиденциальность </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Услуги </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank"> Корпоративный блог </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank"> Медийная реклама </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank"> Нативные проекты </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank"> Образовательные программы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank"> Стартапам </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link"> Мегапроекты </a></li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div> 
    <div class="tm-footer">
     <div class="tm-page-width">
      <div class="tm-footer__container">
       <!----> 
       <div class="tm-footer__social">
        <a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use>
         </svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use>
         </svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use>
         </svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use>
         </svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use>
         </svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use>
         </svg></a>
       </div> 
       <div class="v-portal" style="display:none;"></div> <button class="tm-footer__link"><!----> Настройка языка </button> <a href="/ru/feedback/" class="tm-footer__link"> Техническая поддержка </a> <a href="/berserk-mode-nope" class="tm-footer__link"> Вернуться на старую версию </a> 
       <div class="tm-footer-copyright">
        <span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span>
       </div>
      </div>
     </div>
    </div> <!----> <!---->
   </div> 
   <div class="vue-portal-target"></div>
  </div> 
  <script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"717848":{"id":"717848","timePublished":"2023-02-19T09:36:09+00:00","isCorporative":false,"lang":"ru","titleHtml":"Компилятор с полностью гомоморфным шифрованием от Google","leadData":{"textHtml":"\u003Cp\u003EЕщё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования (\u003Ca href=\"https:\u002F\u002Fbuttondown.email\u002Fj2kun\u002Farchive\u002Fcareer-update-homomorphic-encryption\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eвот объявление об этом в рассылке\u003C\u002Fa\u003E). С тех пор я участвовал в работе над многими проектами в этой области, в частности, руководил поддержкой на \u003Ca href=\"http:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\" rel=\"noopener noreferrer nofollow\"\u003Egithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u003C\u002Fa\u003E – это опенсорсный ПГШ-компилятор для C++. В этой статье даётся вводная информация о том, как при помощи этого инструмента компилировать программы с расчётом на ПГШ. Также пробежимся по тому, из чего этот компилятор состоит.\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E","imageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7bc\u002F7e8\u002F1c8\u002F7bc7e81c85f1a3b17fdb3bc800b63b3b.png","buttonTextHtml":"Читать далее","image":{"url":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7bc\u002F7e8\u002F1c8\u002F7bc7e81c85f1a3b17fdb3bc800b63b3b.png","fit":"cover","positionY":84,"positionX":0}},"editorVersion":"2.0","postType":"article","postLabels":[{"type":"translation","data":{"originalAuthorName":"Jeremy Kun","originalUrl":"https:\u002F\u002Fjeremykun.com\u002F2023\u002F02\u002F13\u002Fgoogles-fully-homomorphic-encryption-compiler-a-primer\u002F"}}],"author":{"id":"2793727","alias":"Sivchenko_translate","fullname":null,"avatarUrl":null,"speciality":null,"scoreStats":{"score":96,"votesCount":138},"rating":43.2,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":1,"favoritesCount":20,"readingCount":1848,"score":12,"votesCount":14,"votesCountPlus":13,"votesCountMinus":1},"hubs":[{"id":"118","alias":"crypto","type":"collective","title":"Криптография","titleHtml":"Криптография","isProfiled":true,"relatedData":null},{"id":"359","alias":"programming","type":"collective","title":"Программирование","titleHtml":"Программирование","isProfiled":true,"relatedData":null},{"id":"559","alias":"cpp","type":"collective","title":"C++","titleHtml":"C++","isProfiled":true,"relatedData":null},{"id":"17188","alias":"compilers","type":"collective","title":"Компиляторы","titleHtml":"Компиляторы","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EЕщё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования (\u003Ca href=\"https:\u002F\u002Fbuttondown.email\u002Fj2kun\u002Farchive\u002Fcareer-update-homomorphic-encryption\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eвот объявление об этом в рассылке\u003C\u002Fa\u003E). С тех пор я участвовал в работе над многими проектами в этой области, в частности, руководил поддержкой на \u003Ca href=\"http:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\" rel=\"noopener noreferrer nofollow\"\u003Egithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u003C\u002Fa\u003E – это опенсорсный ПГШ-компилятор для C++. В этой статье даётся вводная информация о том, как при помощи этого инструмента компилировать программы с расчётом на ПГШ. Также пробежимся по тому, из чего этот компилятор состоит.\u003C\u002Fp\u003E\u003Cp\u003EЕсли вы хотели бы поучаствовать в этом проекте, пожалуйста, напишите мне на \u003Ca href=\"mailto:mathintersectprogramming@gmail.com\" rel=\"noopener noreferrer nofollow\"\u003Emathintersectprogramming@gmail.com\u003C\u002Fa\u003E или \u003Ca href=\"https:\u002F\u002Fmathstodon.xyz\u002F@j2kun\" rel=\"noopener noreferrer nofollow\"\u003Ej2kun@mathstodon.xyz\u003C\u002Fa\u003E. Мне придётся решить несколько бюрократических вопросов, чтобы можно было принимать вклад от сторонних разработчиков (должным образом ссылаясь на разработчиков в git-коммитах), но, при наличии достаточного интереса с вашей стороны я постараюсь управиться с этим, не откладывая.\u003C\u002Fp\u003E\u003Ch2\u003EОбзор \u003C\u002Fh2\u003E\u003Cp\u003EКлючевая идея в основе полностью гомоморфного шифрования (далее — ПГШ) заключается в том, что можно зашифровать данные, а затем гонять на них программы, даже не расшифровывая самих данных. Если довести такую ситуацию до крайности, то можно сказать, что обладай кто-либо физическим доступом к машине и, следовательно, возможностью проверить значения у неё в отдельных ячейках памяти в ходе выполнения программы, он всё равно не увидел бы ни малейшей информации об обрабатываемых данных (если бы не взломал криптосистему). \u003C\u002Fp\u003E\u003Cp\u003EНаш ПГШ-компилятор преобразует программы C++, работающие с обычным текстом, в программы, работающие с соответствующими ПГШ-шифротекстами (поскольку выдаёт высокоуровневый код, затем подлежащий дальнейшей компиляции. Следовательно, этот инструмент можно охарактеризовать как \u003Cem\u003Eтранспилятор\u003C\u002Fem\u003E). Если конкретнее, транспилятор преобразует конкретное \u003Cem\u003Eподмножество\u003C\u002Fem\u003E правильных программ на C++ — подробнее о том, как определяется это подмножество, мы поговорим ниже — в программы, решающие те же задачи на зашифрованных данных посредством одной из поддерживаемых реализаций ПГШ-криптосистем. В данном смысле они близки к традиционному компилятору: разбирают ввод, прогоняют несколько этапов оптимизации, генерируют некоторый вывод. Правда, как будет показано в этой статье, благодаря уникальным свойствам ПГШ этот компилятор сближается по свойствам с инструментариями для операций над аппаратными схемами.\u003C\u002Fp\u003E\u003Cp\u003EРазнообразные варианты ПГШ, ныне поддерживаемые компилятором, называются «предзагрузкой вентилей» (gate bootstrapping). Мне не хватило бы времени детально разобрать здесь математику, лежащую в основе этого процесса — достаточно сказать, что такая технология позволяет пожертвовать производительностью, зато решает более простую задачу: выполняет оптимизацию и выдаёт работающую программу. А далее я скажу, что такая смесь ПГШ позволяет зашифровать \u003Cem\u003Eкаждый бит\u003C\u002Fem\u003E входной информации, превращая ввод в отдельный шифротекст. Затем программа представляется в виде логических (комбинационных) схем, состоящих из таких вентилей как AND (И), OR (ИЛИ), XNOR (исключающее ИЛИ), т.д.  Одно из достоинств компилятора заключается в том, что он управляет отображением типов высшего порядка (например, целых чисел, массивов и структур) на списки зашифрованных булевых значений и обратно.\u003C\u002Fp\u003E\u003Cp\u003EТакой подход на основе схем приводит к некоторым ограничениям, которые пронизывают всю оставшуюся часть этого материала. Во-первых, все циклы должны быть полностью размотаны, и у них должны быть статически известные границы. Во-вторых, здесь не поддерживаются такие конструкции как указатели, а также динамическое выделение памяти. В-третьих, весь поток управления мультиплексируется; это значит, что вычисляются все ветвления всех операторов if, после чего выбирается только один вариант. Наконец, есть важные практические соображения, касающиеся используемой битовой ширины типов и расширения открытого текста до зашифрованного, что влияет на производительность результирующей программы.\u003C\u002Fp\u003E\u003Cp\u003EС другой стороны, оптимизация комбинационных схем – это хорошо изученная задача, для решения которой есть готовые продукты, поддающиеся интеграции (от автора: они что-то интегрировали) в ПГШ-компилятор. Так можно ускорить работу программ.\u003C\u002Fp\u003E\u003Ch2\u003EЗависимости\u003C\u002Fh2\u003E\u003Cp\u003E\u003Cem\u003EЕсли коротко:\u003C\u002Fem\u003E почитайте \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Ftree\u002Fmain\u002Fdocker\" rel=\"noopener noreferrer nofollow\"\u003Eфайлы docker\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cp\u003EВ Google применяется внутренняя система сборки, именуемая blaze, а её опенсорсный аналог (полностью эквивалентный оригиналу за исключением названия) именуется bazel. Одна из первых любопытных вещей, которую можно отметить по поводу компилятора: bazel используется как для сборки, так и для \u003Cem\u003Eиспользования\u003C\u002Fem\u003E проекта (второй аспект хотелось бы изменить). Так что вам потребуется установить bazel, а легче всего это сделать, \u003Ca href=\"https:\u002F\u002Fbazel.build\u002Finstall\u002Fbazelisk\" rel=\"noopener noreferrer nofollow\"\u003Eустановив bazelisk\u003C\u002Fa\u003E, который аналогичен nvm для Node или pyenv для Python. Сразу много версий bazel вам не понадобится, но так легче всего установить новейшую версию. Я буду пользоваться Bazel 4.0.0, но есть и более свежие версии, которые также должны нормально работать. \u003C\u002Fp\u003E\u003Cp\u003EВам понадобится компилятор C (я пользуюсь gcc12), поскольку большинство зависимостей в проекте построены на основе исходников (см. в следующем абзаце) и небольшого количества внешних библиотек и программ, обеспечивающих поддержку некоторых плагинов для оптимизации схем. Ниже приведён полный список для систем, основанных на debian.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eapt-get update &amp;&amp; apt-get install -y \\\n  gcc \\\n  git \\\n  libtinfo5 \\\n  python \\\n  python3 \\\n  python3-pip \\\n  autoconf \\\n  libreadline-dev \\\n  flex \\\n  bison \\\n  wget\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКак упоминалось выше, все остальные зависимости собираются \u003Cem\u003Eиз исходного кода\u003C\u002Fem\u003E, и при первой сборке проекта на эту работу требуется существенное время. Поэтому вы вполне можете клонировать и запустить эту сборку, прямо пока читаете статью. Приведённая ниже команда соберёт проект и все приводимые в качестве примера двоичные файлы, а затем кэширует промежуточные артефакты, чтобы можно было пользоваться ими в будущих сборках, просто перекомпилируя те элементы, которые могли измениться со времени последней сборки. В разделе о Bazel\u002FStarlark подробнее рассказано о том, что делает эта команда. \u003Cstrong\u003EЗамечание: \u003C\u002Fstrong\u003Eособо странный случай – с LLVM. Если вы пользуетесь экзотической операционной системой (или контейнером docker, только позвольте мне не углубляться в объяснения, почему с этим есть проблема), то bazel может предпочесть собрать LLVM с нуля – в случае с первой сборкой на это может потребоваться час-два. Также он может отказать из-за того, что в вашей системе не хватает какой-то зависимости. Это особо тяжёлый случай (и жалоба №1 в случае со всеми проблемами, заводимыми у нас на GitHub). Но, если вы работаете на стандартной комбинации ОС\u002Fархитектура процессора (\u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgrailbio\u002Fbazel-toolchain\u002Fblob\u002F08d1aa8cee67a7a9c51c09225cead1dad42dadc3\u002Ftoolchain\u002Finternal\u002Fcommon.bzl\" rel=\"noopener noreferrer nofollow\"\u003Eиз тех, что перечислены здесь\u003C\u002Fa\u003E), компилятор просто выберет нужную зависимость LLVM и установит её в вашей системе.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Egit clone https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption.git\ncd fully-homomorphic-encryption\nbazel build ...:all\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЧистая сборка на моём домашнем компьютере делается примерно за 16 минут.   \u003C\u002Fp\u003E\u003Ch2\u003EПодробный разбор двух примеров: add и string_cap   \u003C\u002Fh2\u003E\u003Cp\u003EВ этом разделе я покажу два сквозных примера, в которых буду работать с компилятором как конечный пользователь. В первом примере рассмотрим донельзя простую программу, складывающую два 32-разрядных целых числа. Во втором примере будет программа, которая делает заглавным первый символ в каждом слове в строке, записанной в кодировке ASCII. Примеры уже лежат в репозитории в разделе \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Ftree\u002Fmain\u002Ftranspiler\u002Fexamples\" rel=\"noopener noreferrer nofollow\"\u003Etranspiler\u002Fexamples\u003C\u002Fa\u003E, они называются \u003Ccode\u003Esimple_sum\u003C\u002Fcode\u003E и \u003Ccode\u003Estring_cap\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cp\u003EОбе эти программы представлены в виде компиляции единственной функции, которая является входной точкой для ПГШ-компонента программы. Также предоставляются API и библиотека для интеграции этой программы с более крупной.\u003C\u002Fp\u003E\u003Cp\u003EНачнём с simple_sum. Добавим заголовок и файл с исходным кодом как в любой стандартной программе на C++, но с одной дополнительной строкой, сообщающей компилятору, какую именно функцию нужно скомпилировать (а также какие функции внутри неё вызываются).\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E\u002F\u002F add.h\nint add(int a, int b);\n \n\u002F\u002F add.cc\n#include \"add.h\"\n \n#pragma hls_top\nint add(int a, int b) {\n  return a + b;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСтрока \u003Ccode\u003E#pragma hls_top\u003C\u002Fcode\u003E сообщает компилятору, какая функция является входной точкой. Кстати, hls здесь означает “\u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FHigh-level_synthesis\" rel=\"noopener noreferrer nofollow\"\u003Ehigh level synthesis\u003C\u002Fa\u003E” (высокоуровневый синтез), а сама инструкция компилятора взята из проекта \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Fxls\" rel=\"noopener noreferrer nofollow\"\u003EXLS\u003C\u002Fa\u003E, используемого у нас в качестве парсера и первичного сборщика схем. Здесь \u003Ccode\u003E‘top’\u003C\u002Fcode\u003E означает просто «функция верхнего уровня».\u003C\u002Fp\u003E\u003Cp\u003EЗатем в файле из того же каталога, именуемом BUILD (см. далее раздел о Bazel\u002FStarlark, где даётся обзор системы сборки) создаётся цель для сборки, вызывающая ПГШ-компилятор. В данном случае в качестве бэкенда воспользуемся \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fopenfheorg\u002Fopenfhe-development\" rel=\"noopener noreferrer nofollow\"\u003EOpenFHE\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E# BUILD\n# загружает ПГШ-компилятор в качестве расширения Bazel.\nload(\"\u002F\u002Ftranspiler:fhe.bzl\", \"fhe_cc_library\")\n \nfhe_cc_library(\n  name = \"add_fhe_lib\",\n  src = \"add.cc\",\n  hdrs = [\"add.h\"],\n  encryption = \"openfhe\",  # библиотека для криптосистемы бэкенда\n  interpreter = True,      # используем динамическое планирование потоков\n  optimizer = \"yosys\",     # оптимизатор логических схем\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПолный набор опций для данного правила сборки (т.e., документация по главной входной точке компилятора) находится в \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Fblob\u002Ff6b6fe3894e134827010524914d8993aa994ab08\u002Ftranspiler\u002Ffhe.bzl#L585\" rel=\"noopener noreferrer nofollow\"\u003Edocstring по макросу bazel\u003C\u002Fa\u003E. Я выбрал те параметры, которые, на мой взгляд, позволяют добиться золотой середины между стабильностью и производительностью.\u003C\u002Fp\u003E\u003Cp\u003EЕсли выполните bazel build add_fhe_lib, то увидите, что сборка идёт – и на этом всё (подробнее см. в разделе «промежуточные файлы» о том, что здесь происходит за кулисами). Но, если вы что-либо неправильно введёте в файле сборки, то на этом месте компилятор споткнётся. Он генерирует заголовок и файл cc, содержащий тот же API, что и add, но с другими типами в качестве аргументов, а также дополнительные аргументы, требуемые на бэкенде библиотеки ПГШ.\u003C\u002Fp\u003E\u003Cp\u003EДалее нам потребуется главная процедура, использующая эту библиотеку. Поскольку бэкендом нам служит OpenFHE, здесь понадобится некоторая работа по конфигурации и первичное шифрование всех входных значений. Вот \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Ftree\u002Fmain\u002Ftranspiler\u002Fcodelab\u002Fadd\" rel=\"noopener noreferrer nofollow\"\u003Eполный код\u003C\u002Fa\u003E с небольшими изменениями, внесёнными для публикации в блоге. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E#include &lt;stdio.h\u003E\n#include &lt;iostream\u003E\n#include &lt;ostream\u003E\n \n#include \"absl\u002Fstrings\u002Fnumbers.h\"\n#include \"transpiler\u002Fcodelab\u002Fadd\u002Fadd_fhe_lib.h\"\n#include \"transpiler\u002Fdata\u002Fopenfhe_data.h\"\n \nconstexpr auto kSecurityLevel = lbcrypto::MEDIUM;\n \nint main(int argc, char** argv) {\n  if (argc &lt; 3) {\n    fprintf(stderr, \"Usage: add_main [int] [int]\\n\\n\");\n    return 1;\n  }\n \n  int x, y;\n  if(!absl::SimpleAtoi(argv[1], &amp;x)) {\n    std::cout &lt;&lt; \"Bad int \" &lt;&lt; argv[1] &lt;&lt; std::endl;\n    return 1;\n  }\n  if(!absl::SimpleAtoi(argv[2], &amp;y)) {\n    std::cout &lt;&lt; \"Bad int \" &lt;&lt; argv[2] &lt;&lt; std::endl;\n    return 1;\n  }\n  std::cout &lt;&lt; \"Computing \" &lt;&lt; x &lt;&lt; \" + \" &lt;&lt; y &lt;&lt; std::endl;\n \n  \u002F\u002F Настраиваем контекст бэкенда и ключи шифрования.\n  auto context = lbcrypto::BinFHEContext();\n  context.GenerateBinFHEContext(kSecurityLevel);\n  auto sk = context.KeyGen();\n  context.BTKeyGen(sk);\n \n  OpenFhe&lt;int\u003E ciphertext_x = OpenFhe&lt;int\u003E::Encrypt(x, context, sk);\n  OpenFhe&lt;int\u003E ciphertext_y = OpenFhe&lt;int\u003E::Encrypt(y, context, sk);\n  OpenFhe&lt;int\u003E result(context);\n  auto status = add(result, ciphertext_x, ciphertext_y, context);\n  if(!status.ok()) {\n    std::cout &lt;&lt; \"FHE computation failed: \" &lt;&lt; status &lt;&lt; std::endl;\n    return 1;\n  }\n \n  std::cout &lt;&lt; \"Result: \" &lt;&lt; result.Decrypt(sk) &lt;&lt; \"\\n\";\n  return 0;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВот что происходит в тех частях, которые не являются явно шаблонным кодом:\u003C\u002Fp\u003E\u003Cp\u003EКонфигурирование уровня безопасности библиотеки OpenFHE (он называется BinFHE, подсказывая, что выполняет полное гомоморфное шифрование двоичных схем).\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Econstexpr auto kSecurityLevel = lbcrypto::MEDIUM;\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНастройка первичного секретного ключа OpenFHE\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Eauto context = lbcrypto::BinFHEContext();\ncontext.GenerateBinFHEContext(kSecurityLevel);\nauto sk = context.KeyGen();\ncontext.BTKeyGen(sk);\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EШифрование входных значений. Здесь используется API, предоставляемый компилятором (хотя, поскольку весь проект представляет собой исследовательский прототип, мне кажется, что его авторы так и не принялись за унификацию части, отвечающей за «настройку первичного секретного ключа» за API) и включаемый сюда из \u003Ccode\u003Einclude \"transpiler\u002Fdata\u002Fopenfhe_data.h\"\u003C\u002Fcode\u003E   \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003EOpenFhe&lt;int\u003E ciphertext_x = OpenFhe&lt;int\u003E::Encrypt(x, context, sk);\nOpenFhe&lt;int\u003E ciphertext_y = OpenFhe&lt;int\u003E::Encrypt(y, context, sk)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЗатем вызываем функцию \u003Ccode\u003Eadd\u003C\u002Fcode\u003E с активированным ПГШ и дешифруем результаты.\u003C\u002Fp\u003E\u003Cp\u003EДалее создаём ещё одно правило BUILD для двоичного файла:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003Ecc_binary(\n    name = \"add_openfhe_fhe_demo\",\n    srcs = [\n        \"add_openfhe_fhe_demo.cc\",\n    ],\n    deps = [\n        \":add_fhe_lib\",\n        \"\u002F\u002Ftranspiler\u002Fdata:openfhe_data\",\n        \"@com_google_absl\u002F\u002Fabsl\u002Fstrings\",\n        \"@openfhe\u002F\u002F:binfhe\",\n    ],\n)\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EЗапускаем код при помощи bazel:   \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ bazel run add_openfhe_fhe_demo -- 5 7\nComputing 5 + 7\nResult: 12\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНа моей системе на это потребовалось менее 7 секунд.\u003C\u002Fp\u003E\u003Cp\u003EРассмотрим более сложный пример string_cap, где во всей красе предстают циклы и массивы. Это слегка упрощённая версия примера, \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Ftree\u002Fmain\u002Ftranspiler\u002Fexamples\u002Fstring_cap\" rel=\"noopener noreferrer nofollow\"\u003Eвыложенного на GitHub\u003C\u002Fa\u003E. Начнём с заголовка и файла с исходным кодом:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E\u002F\u002F string_cap.h\n#define MAX_LENGTH 32\nvoid CapitalizeString(char my_string[MAX_LENGTH]);\n \n\u002F\u002F string_cap.cc\n#include \"string_cap.h\"\n \n#pragma hls_top\nvoid CapitalizeString(char my_string[MAX_LENGTH]) {\n  bool last_was_space = true;\n#pragma hls_unroll yes\n  for (int i = 0; i &lt; MAX_LENGTH; i++) {\n    char c = my_string[i];\n    if (last_was_space &amp;&amp; c \u003E= 'a' &amp;&amp; c &lt;= 'z') {\n      my_string[i] = c - ('a' - 'A');\n    }\n    last_was_space = (c == ' ');\n  }\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВот теперь есть что обсудить. Начнём с того, что у этой строки статическая длина, известная во время компиляции. Это необходимо, поскольку программа ПГШ является логической схемой. Она определяет подключения для каждого из входных значений и должна знать, сколько таких подключений определять. В данном случае у нас будет схема с 32 * 8 подключениями, по одному на каждый разряд каждого из символов в массиве.\u003C\u002Fp\u003E\u003Cp\u003EВторая новинка здесь – это \u003Ccode\u003E#pragma hsl_unroll yes\u003C\u002Fcode\u003E, которая, как и \u003Ccode\u003Ehls_top\u003C\u002Fcode\u003E, приказывает компилятору XLS полностью размотать этот цикл. Поскольку программа ПГШ – это статическая схема, никаких циклов в ней быть не может. XLS разматывает наши циклы за нас – и, кстати, я недавно узнал, что она использует решатель Z3, чтобы сначала \u003Cem\u003Eдоказать\u003C\u002Fem\u003E, что циклы могут быть размотаны (в сложных программах это может приводить к увеличению времени компиляции). Я не знаю никаких других компиляторов, в которых предусматривался бы такой этап доказательства. Складывается впечатление, что \u003Ca href=\"https:\u002F\u002Fllvm.org\u002Fdoxygen\u002FLoopUnroll_8cpp_source.html#l00269\" rel=\"noopener noreferrer nofollow\"\u003Eразмотчик циклов LLVM\u003C\u002Fa\u003E просто транжирит свои циклы ЦП, если поручить ему полностью размотать бесконечный цикл.\u003C\u002Fp\u003E\u003Cp\u003EОсновная процедура похожа на ту, что мы рассмотрели ранее:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003E#include &lt;array\u003E\n#include &lt;iostream\u003E\n#include &lt;string\u003E\n \n#include \"openfhe\u002Fbinfhe\u002Fbinfhecontext.h\"\n#include \"transpiler\u002Fdata\u002Fopenfhe_data.h\"\n#include \"transpiler\u002Fexamples\u002Fstring_cap\u002Fstring_cap.h\"\n#include \"transpiler\u002Fexamples\u002Fstring_cap\u002Fstring_cap_openfhe_yosys_interpreted.h\"\n \nint main(int argc, char** argv) {\n  if (argc &lt; 2) {\n    fprintf(stderr, \"Usage: string_cap_openfhe_testbench string_input\\n\\n\");\n    return 1;\n  }\n \n  std::string input = argv[1];\n  input.resize(MAX_LENGTH, '\\0');\n  std::string plaintext(input);\n \n  auto cc = lbcrypto::BinFHEContext();\n  cc.GenerateBinFHEContext(lbcrypto::MEDIUM);\n  auto sk = cc.KeyGen();\n  cc.BTKeyGen(sk);\n \n  auto ciphertext = OpenFheArray&lt;char\u003E::Encrypt(plaintext, cc, sk);\n  auto status = CapitalizeString(ciphertext, cc);\n  if (!status.ok()) {\n    std::cout &lt;&lt; \"FHE computation failed \" &lt;&lt; status &lt;&lt; std::endl;\n    return 1;\n  };\n  std::cout &lt;&lt; \"Decrypted result: \" &lt;&lt; ciphertext.Decrypt(sk) &lt;&lt; std::endl;\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВот ключевые отличия:   \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EМы изменяем размер входной информации так, чтобы она точно равнялась \u003Ccode\u003EMAX_LENGTH\u003C\u002Fcode\u003E, заполняя пространство нулевыми байтами.\u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EМы используем \u003Ccode\u003EOpenFheArray\u003C\u002Fcode\u003E, а не \u003Ccode\u003EOpenFhe\u003C\u002Fcode\u003E, чтобы закодировать массив символов.   \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EА теперь, пропустив \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Fblob\u002Fmain\u002Ftranspiler\u002Fexamples\u002Fstring_cap\u002FBUILD#L35\" rel=\"noopener noreferrer nofollow\"\u003Eправило сборки\u003C\u002Fa\u003E двоичного файла и запустив его, получим:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ bazel run string_cap_openfhe_yosys_interpreted_testbench -- 'hello there'\nDecrypted result: Hello There\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EИнтересно, что на моей машине на это также уходит около 6 секунд (столько же, сколько и в случае с программой, складывающей 32-разрядные числа). Для более длинной строки (до 32 символов) получим такое же время выполнения, поскольку, естественно, программа обрабатывает все символы из \u003Ccode\u003EMAX_LENGTH\u003C\u002Fcode\u003E, не зная, являются ли они нулевыми байтами.\u003C\u002Fp\u003E\u003Ch2\u003EОбзор Bazel и Starlark   \u003C\u002Fh2\u003E\u003Cp\u003EПГШ-компилятор зародился в Google любопытным образом. Он был создан десятками участников-добровольцев (в те самые 20% рабочего времени, которые уделяются на сторонние проекты), и многие из них работали над инструментарием \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Fxls\" rel=\"noopener noreferrer nofollow\"\u003EXLS для аппаратного синтеза\u003C\u002Fa\u003E, который является центральным компонентом этого компилятора. В силу таких ограничений, а также потому, что вся работа полностью велась в Google, не было особого поля для манёвра, которое позволило бы обеспечить независимость компилятора от внутреннего сборочного инструментария, используемого в Google. \u003C\u002Fp\u003E\u003Cp\u003EЗдесь мы подходим к Bazel и Starlark, сегодня служащие фасадом этого компилятора, обращённым к пользователю. \u003Ca href=\"https:\u002F\u002Fbazel.build\u002F\" rel=\"noopener noreferrer nofollow\"\u003EBazel\u003C\u002Fa\u003E – это опенсорсный аналог внутрикорпоративной сборочной системы Google (внутренний инструмент называется “Blaze”), а \u003Ca href=\"https:\u002F\u002Fbazel.build\u002Frules\u002Flanguage\" rel=\"noopener noreferrer nofollow\"\u003EStarlark\u003C\u002Fa\u003E – это язык сценариев, созданный по образцу Python. Есть \u003Ca href=\"https:\u002F\u002Fmedium.com\u002Fwindmill-engineering\u002Fbazel-is-the-worst-build-system-except-for-all-the-others-b369396a9e26\" rel=\"noopener noreferrer nofollow\"\u003Eмножество мнений\u003C\u002Fa\u003E о Bazel, которые я не буду здесь повторять. Лучше сделаю минимальный обзор того, как он работает в контексте ПГШ-компилятора.\u003C\u002Fp\u003E\u003Cp\u003EСначала немного терминологии. Чтобы приступить к работе с Bazel, нужно сделать следующее.\u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EОпределить \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Fblob\u002Fmain\u002FWORKSPACE\" rel=\"noopener noreferrer nofollow\"\u003Eфайл\u003C\u002Fa\u003E WORKSPACE, в котором описаны все внешние зависимости вашего проекта, рассказано, как вытягивать их исходный код, и какие команды bazel должны использоваться для их сборки. Можно сравнить эту информацию с высокоуровневыми списками CMakeList, за тем исключением, что в этом файле не содержится никаких инструкций о сборке проекта – просто объявляется корень дерева каталогов этого проекта и указывается имя проекта.   \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EОпределить набор файлов BUILD в каждом подкаталоге, указав здесь \u003Cem\u003Eцелевые сборки\u003C\u002Fem\u003E, которые могут быть сделаны из содержащихся в этом каталоге файлов с исходным кодом (но не из его подкаталогов). Всё точно, как с файлами CMakeLists в подкаталогах. Каждая цель для сборки может объявлять зависимости, связывающие её с другими целями для сборки, а bazel build гарантирует, что первым делом будут собираться именно зависимости, а также кэширует результаты сборки в пределах всего сеанса. В корне многих проектов лежит файл BUILD, это нужно для предоставления публичных библиотек и API данного проекта.   \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EИспользовать встроенные \u003Cem\u003Eправила\u003C\u002Fem\u003E bazel, например, \u003Ccode\u003Ecc_library\u003C\u002Fcode\u003E, \u003Ccode\u003Ecc_binary\u003C\u002Fcode\u003E и \u003Ccode\u003Ecc_test\u003C\u002Fcode\u003E, чтобы сгруппировать файлы в библиотеки, поддающиеся сборке при помощи \u003Ccode\u003Ebazel build\u003C\u002Fcode\u003E, исполняемые двоичные файлы, которые также можно выполнять при помощи  \u003Ccode\u003Ebazel run\u003C\u002Fcode\u003E, а также тесты, которые можно выполнять при помощи bazel test. Большинство правил bazel сводятся к вызову какой-либо исполняемой программы, например, gcc или javac с конкретными аргументами. Одновременно с этим отслеживается накапливающееся множество зависимостей, касающихся артефактов сборки, это делается в «герметичном» месте файловой системы. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EНаписать любые дополнительные \u003Cem\u003Eмакросы\u003C\u002Fem\u003E bazel, сцепляющие встроенные команды bazel, например, чтобы определять локальные группирования сборочных команд, которые должны происходить в определённой последовательности. Эти макросы выглядят как функции на Python, вызывающие отдельные правила bazel и, возможно, передающие данные между ними. Они записываются в файлах .bzl, которые интерпретируются непосредственно самим bazel.   \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВообще сборка целей в bazel проходит в две фазы. Сначала идёт фаза анализа. На ней загружаются все файлы BUILD и импортированные файлы .bzl, а также просматриваются все правила, которые при этом вызывались. В частности, компилятор \u003Cem\u003Eвыполняет\u003C\u002Fem\u003E макросы, так как должен знать, какие правила через них вызываются (а выполнение правил можно подстраховывать на уровне потока управления, либо можно динамически генерировать их аргументы, т.д.). Но правила сборки как таковые он \u003Cem\u003Eне выполняет\u003C\u002Fem\u003E. За этой работой компилятору удаётся построить полный граф зависимостей, сообщить об опечатках, недостающих зависимостях, циклах, т.д. По завершении фазы анализа компилятор выполняет базовые правила в том порядке, в котором идут зависимости, и кэширует результаты. Bazel вновь выполнит какое-либо правило только в случае, если что-либо изменится в базовых зависимостях или в тех файлах, от которых он зависит.\u003C\u002Fp\u003E\u003Cp\u003EКомпилятор ПГШ написан на Starlark – в том смысле, что главной входной точкой компилятора является макрос Bazel \u003Ccode\u003Efhe_cc_library\u003C\u002Fcode\u003E. Этот макрос сцепляет ряд правил, которые вызывают парсер, оптимизатор схем и этапы генерации кода – для каждого из этих элементов предусмотрено своё правило Bazel. Каждое из этих правил по очереди объявляет или записывает файлы, которые мы можем проверить – об этом в следующем разделе.\u003C\u002Fp\u003E\u003Cp\u003EВот как выглядит \u003Ccode\u003Efhecclibrary\u003C\u002Fcode\u003E (если коротко, это подмножество потока управления):\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"python\"\u003Edef fhe_cc_library(name, src, hdrs, copts = [], num_opt_passes = 1,\n        encryption = \"openfhe\", optimizer = \"xls\", interpreter = False, library_name = None,\n        **kwargs):\n    \"\"\"Правило для сборки библиотек cc_libraries на основе ПГШ. [docstring пропущен]\"\"\"\n    transpiled_xlscc_files = \"{}.cc_to_xls_ir\".format(name)\n    library_name = library_name or name\n    cc_to_xls_ir(\n        name = transpiled_xlscc_files,\n        library_name = library_name,\n        src = src,\n        hdrs = hdrs,\n        defines = kwargs.get(\"defines\", None),\n    )\n \n    # ниже мы добавляем ведущее двоеточие к аргументу `src`, тем самым указывая, \n    # где находятся файлы, сгенерированные по предыдущему правилу. При этом имя файла \n    # служит уникальным идентификатором.\n    transpiled_structs_headers = \"{}.xls_cc_transpiled_structs\".format(name)\n    xls_cc_transpiled_structs(\n        name = transpiled_structs_headers,\n        src = \":\" + transpiled_xlscc_files,\n        encryption = encryption,\n    )\n \n    if optimizer == \"yosys\":  # other branch omitted for brevity\n        verilog = \"{}.verilog\".format(name)\n        xls_ir_to_verilog(name = verilog, src = \":\" + transpiled_xlscc_files)\n        netlist = \"{}.netlist\".format(name)\n        verilog_to_netlist(name = netlist, src = \":\" + verilog, encryption = encryption)\n        cc_fhe_netlist_library(\n            name = name,\n            src = \":\" + netlist,\n            encryption = encryption,\n            interpreter = interpreter,\n            transpiled_structs = \":\" + transpiled_structs_headers,\n            copts = copts,\n            **kwargs\n        )\n\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EСреди правил, вызываемых макросом, есть следующие:   \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Ecc_to_xls_ir\u003C\u002Fcode\u003E, вызывающее парсер xlscc и выдающее внутреннее представление программы в виде высокоуровневой схемы. На этом шаге выполняется размотка циклов и другие умные вещи, связанные с преобразованием кода C++ в схему. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Exlscc_transpiled_structs\u003C\u002Fcode\u003E, вызывающее двоичный файл, который обрабатывает структуры (эта часть сложная, её рассмотрение выходит за рамки данной статьи). \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Exls_ir_to_verilog\u003C\u002Fcode\u003E, преобразующее внутреннее представление XLS IR в verilog, так, чтобы его можно было оптимизировать при помощи Yosys\u002FABC – популярной программы для проектирования и оптимизации схем.     \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003E\u003Ccode\u003Everilog_to_netlist\u003C\u002Fcode\u003E, вызывающее Yosys как для оптимизации схемы, так и для преобразования её в максимально низкоуровневое внутреннее представление, называемое \u003Ca href=\"https:\u002F\u002Fen.wikipedia.org\u002Fwiki\u002FNetlist\" rel=\"noopener noreferrer nofollow\"\u003Enetlist\u003C\u002Fa\u003E. \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003Ecc_fhe_netlist_library, вызывающее этап генерации, чтобы сформировать код C++ из netlist, сделанного на предыдущем этапе.        \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EВ результате всей этой работы получается библиотека на C++ (сгенерированная на предыдущем этапе), которую можно слинковать для работы с имеющейся программой, и исходный код которой (сгенерированный выше) можно проверить. Теперь давайте посмотрим, как выглядит каждый из сгенерированных файлов.   \u003C\u002Fp\u003E\u003Ch2\u003EПромежуточные файлы, сгенерированные компилятором\u003C\u002Fh2\u003E\u003Cp\u003EВыше я упоминал, что промежуточные файлы, сгенерированные каждым правилом сборки, bazel кладёт в «герметичное» место в файловой системе. На это место ставится символьная ссылка из корня рабочего пространства, это делается при помощи \u003Ccode\u003Ebazel-bin\u003C\u002Fcode\u003E. \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ ls -al . | grep bazel-bin\n\u002Fhome\u002Fj2kun\u002F.cache\u002Fbazel\u002F_bazel_j2kun\u002F42987a3d4769c6105b2fa57d2291edc3\u002Fexecroot\u002Fcom_google_fully_homomorphic_encryption\u002Fbazel-out\u002Fk8-opt\u002Fbin\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВ bazel-bin содержится зеркало дерева исходников проекта, а в каталоге для правила сборки находятся все сгенерированные файлы. Вот как эта информация выглядит для нашего сумматора 32-разрядных чисел:   \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003E$ ls\n_objs                                   add_test\nadd_fhe_lib.cc                          add_test-2.params\nadd_fhe_lib.entry                       add_test.runfiles\nadd_fhe_lib.generic.types.h             add_test.runfiles_manifest\nadd_fhe_lib.h                           libadd.a\nadd_fhe_lib.ir                          libadd.a-2.params\nadd_fhe_lib.netlist.v                   libadd.pic.a\nadd_fhe_lib.netlist.v.dot               libadd.pic.a-2.params\nadd_fhe_lib.opt.ir                      libadd.so\nadd_fhe_lib.types.h                     libadd.so-2.params\nadd_fhe_lib.v                           libadd_fhe_lib.a\nadd_fhe_lib.ys                          libadd_fhe_lib.a-2.params\nadd_fhe_lib_meta.proto                  libadd_fhe_lib.pic.a\nadd_openfhe_fhe_demo                    libadd_fhe_lib.pic.a-2.params\nadd_openfhe_fhe_demo-2.params           libadd_fhe_lib.so\nadd_openfhe_fhe_demo.runfiles           libadd_fhe_lib.so-2.params\nadd_openfhe_fhe_demo.runfiles_manifest\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EВиден вывод, это файлы \u003Ccode\u003E.h\u003C\u002Fcode\u003E и \u003Ccode\u003E.cc\u003C\u002Fcode\u003E, а также скомпилированные на их основе файлы \u003Ccode\u003E.so\u003C\u002Fcode\u003E (артефакты сборки вывода), но для нас важнее внутренние сгенерированные файлы. Именно здесь можно посмотреть, какими получились сгенерированные схемы.\u003C\u002Fp\u003E\u003Cp\u003EПервый файл, который лучше рассмотреть подробнее – это \u003Ccode\u003Eadd_fhe_lib.opt.ir\u003C\u002Fcode\u003E, представляющий собой вывод компилятора xlscc с включением XLS-внутреннего шага оптимизации. Именно здесь в основном изложено, как компилятор использует проект XLS: преобразует входную программу в схему. Файл выглядит так:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Epackage my_package\n \nfile_number 1 \".\u002Ftranspiler\u002Fcodelab\u002Fadd\u002Fadd.cc\"\n \ntop fn add(x: bits[32], y: bits[32]) -\u003E bits[32] {\n  ret add.3: bits[32] = add(x, y, id=3, pos=[(1,18,25)])\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EКак видите, это определённое в XLS внутреннее представление (IR) главной процедуры, снабжённое некоторыми дополнительными метаданными к исходному коду. Поскольку XLS-IR нативно поддерживает операции сложения, результат тривиален. Здесь интересно отметить, что числа представлены в виде битовых массивов. Если коротко, \u003Ca href=\"https:\u002F\u002Fgoogle.github.io\u002Fxls\u002Fir_semantics\u002F\" rel=\"noopener noreferrer nofollow\"\u003Eсистема значимых типов\u003C\u002Fa\u003E XLS-IR поддерживает только биты, массивы и кортежи, причём, кортежи здесь – это механизм для поддержки структур.\u003C\u002Fp\u003E\u003Cp\u003EДалее XLS-IR преобразуется в Verilog в \u003Ccode\u003Eaddfhelib.v\u003C\u002Fcode\u003E, и в результате даёт (тоже тривиальный) код:\u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode class=\"cpp\"\u003Emodule add(\n  input wire [31:0] x,\n  input wire [31:0] y,\n  output wire [31:0] out\n);\n  wire [31:0] add_6;\n  assign add_6 = x + y;\n  assign out = add_6;\nendmodule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EНа следующем этапе нужно прогнать этот verilog через \u003Ca href=\"https:\u002F\u002Fgithub.com\u002FYosysHQ\u002Fyosys\" rel=\"noopener noreferrer nofollow\"\u003EYosys\u003C\u002Fa\u003E, это зрелый комплект для синтеза схем. В контексте нашего проекта Yosys решает две задачи:   \u003C\u002Fp\u003E\u003Cul\u003E\u003Cli\u003E\u003Cp\u003EПреобразует высокоуровневые операции в заданный набор логических вентилей (оперирующих отдельными битами)   \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003Cli\u003E\u003Cp\u003EОптимизирует полученную в результате схему, так, чтобы её размер получился минимальным  \u003C\u002Fp\u003E\u003C\u002Fli\u003E\u003C\u002Ful\u003E\u003Cp\u003EXLS также на это способен, и, если хотите в этом убедиться, можете заменить у сборочного правила \u003Ccode\u003Eoptimizer\u003C\u002Fcode\u003E атрибут \u003Ccode\u003Eyosys\u003C\u002Fcode\u003E на \u003Ccode\u003Exls\u003C\u002Fcode\u003E. Но мы обнаружили, что у Yosys схемы, как правило, получаются в 2-3 раза меньше. Скрипт, который мы даём yosys, находится в файле \u003Ccode\u003Efhe_yosys.bzl\u003C\u002Fcode\u003E. В этом файле заключены макросы bazel и правила, касающиеся вызова Yosys. Вывод программы-сумматора получается таким:   \u003C\u002Fp\u003E\u003Cpre\u003E\u003Ccode\u003Emodule add(x, y, out);\n  wire _000_;\n  wire _001_;\n  wire _002_;\n  [...]\n  wire _131_;\n  wire _132_;\n  output [31:0] out;\n  wire [31:0] out;\n  input [31:0] x;\n  wire [31:0] x;\n  input [31:0] y;\n  wire [31:0] y;\n  nand2 _133_ (.A(x[12]), .B(y[12]), .Y(_130_));\n  xor2 _134_ ( .A(x[12]), .B(y[12]), .Y(_131_));\n  nand2 _135_ ( .A(x[11]), .B(y[11]), .Y(_132_));\n  or2 _136_ ( .A(x[11]), .B(y[11]), .Y(_000_));\n  nand2 _137_ ( .A(x[10]), .B(y[10]), .Y(_001_));\n  xor2 _138_ ( .A(x[10]), .B(y[10]), .Y(_002_));\n  nand2 _139_ ( .A(x[9]), .B(y[9]), .Y(_003_));\n  or2 _140_ ( .A(x[9]), .B(y[9]), .Y(_004_));\n  nand2 _141_ ( .A(x[8]), .B(y[8]), .Y(_005_));\n  xor2 _142_ ( .A(x[8]), .B(y[8]), .Y(_006_));\n  nand2 _143_ ( .A(x[7]), .B(y[7]), .Y(_007_));\n  or2 _144_ ( .A(x[7]), .B(y[7]), .Y(_008_));\n  [...]\n  xor2 _291_ ( .A(_006_), .B(_035_), .Y(out[8]));\n  xnor2 _292_ ( .A(x[9]), .B(y[9]), .Y(_128_));\n  xnor2 _293_ ( .A(_037_), .B(_128_), .Y(out[9]));\n  xor2 _294_ ( .A(_002_), .B(_039_), .Y(out[10]));\n  xnor2 _295_ ( .A(x[11]), .B(y[11]), .Y(_129_));\n  xnor2 _296_ ( .A(_041_), .B(_129_), .Y(out[11]));\n  xor2 _297_ ( .A(_131_), .B(_043_), .Y(out[12]));\nendmodule\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cp\u003EПолучается схема, в которой всего 165 вентилей.\u003C\u002Fp\u003E\u003Cp\u003EЗатем на этапе генерации кода производится файл \u003Ccode\u003Eadd_fhe_lib.cc\u003C\u002Fcode\u003E, загружающий схему в интерпретатор, а интерпретатор умеет отобразить операцию \u003Ccode\u003Eand2\u003C\u002Fcode\u003E на выбранный библиотечный вызов бэкендовой криптосистемы (см. \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fgoogle\u002Ffully-homomorphic-encryption\u002Fblob\u002Fmain\u002Ftranspiler\u002Fyosys_openfhe_runner.cc\" rel=\"noopener noreferrer nofollow\"\u003Eисходный код бэкенда OpenFHE\u003C\u002Fa\u003E) и использует планирование пула потоков на ЦП, чтобы ускорить вычисление всей схемы.\u003C\u002Fp\u003E\u003Cp\u003EЧто касается схемы string_cap, файл \u003Ca href=\"https:\u002F\u002Fpastebin.com\u002Fraw\u002F1friPEPh\" rel=\"noopener noreferrer nofollow\"\u003Eopt.ir\u003C\u002Fa\u003E демонстрирует более разнообразное внутреннее представление XLS, в том числе, операции по расширению знака, индексированию и срезу массивов, а также мультиплексированию веток (\u003Ccode\u003Esel\u003C\u002Fcode\u003E). В результате оптимизации получается \u003Ca href=\"https:\u002F\u002Fpastebin.com\u002Fraw\u002FDMhP941T\" rel=\"noopener noreferrer nofollow\"\u003E684-вентильная схема\u003C\u002Fa\u003E (хотя, многие из этих вентилей являются «инвертирующими» или «буферные», а значит, обходятся для ПГШ фактически даром).\u003C\u002Fp\u003E\u003Cp\u003EКомпилятор также выдаёт файл \u003Ccode\u003E.dot\u003C\u002Fcode\u003E, который можно отобразить \u003Ca href=\"https:\u002F\u002Fgithub.com\u002Fj2kun\u002Fj2kun.github.io\u002Fblob\u002Fmain\u002Fsvg\u002Fstring_cap_openfhe_yosys_interpreted.netlist.v.dot.svg\" rel=\"noopener noreferrer nofollow\"\u003Eв формате SVG\u003C\u002Fa\u003E (внимание, размер SVG ~2,3 МибиБ). Осмотрев схему, вы убедитесь, что она достаточно неглубокая и широкая, что позволяет планировщику потоков развернуться в этой схеме с параллелизмом, и в результате она станет быстро работать. Тем временем сумматор 32-разрядных чисел, пусть на него и приходится всего около 25% вентилей – схема гораздо более глубокая и, следовательно, параллелизма в нём меньше.\u003C\u002Fp\u003E\u003Ch2\u003EПоддерживаемые программы для ввода C++ и издержки на шифрование\u003C\u002Fh2\u003E\u003Cp\u003EВыше у нас была экскурсия по компилятору, но, если вы собираетесь писать программы при помощи этого компилятора, необходимо учитывать несколько вещей.\u003C\u002Fp\u003E\u003Cp\u003EВо-первых, поддерживаемое этим компилятором подмножество C++ довольно невелико. Как упоминалось выше, все данные должны иметь статические размеры. Таким образом, нельзя написать программу, которая обрабатывала бы произвольные изображения. Вместо этого придётся взять верхнюю границу размера изображения, в соответствии с этим заполнить изображение нулями и только потом шифровать, а затем написать программу, которая бы оперировала изображением именно такого размера. В том же ключе выбранные вами целочисленные типы нетривиальным образом повлияют на производительность. Чтобы в этом убедиться, замените тип \u003Ccode\u003Eint\u003C\u002Fcode\u003E в 32-разрядном сумматоре на \u003Ccode\u003Echar\u003C\u002Fcode\u003E и посмотрите, какая схема у вас получится.\u003C\u002Fp\u003E\u003Cp\u003EАналогично, в циклах нужно предусмотреть статические ограничения на количество итераций. Точнее, xlscc должен быть в состоянии полностью размотать каждый цикл. Таким образом, допускаются некоторые формы циклов while и такая рекурсия, которая доказуемо завершается. Здесь возможны некоторые проблемы, если во вводимом коде содержатся циклы со сложными критериями выхода (например, \u003Ccode\u003Ebreak\u003C\u002Fcode\u003E контролируется при помощи if\u002Felse). Также в таком случае нужно тщательно продумывать, как именно писать циклы, хотя, работа над компилятором продолжается, и возможно, что в будущем он возьмёт это продумывание на себя.\u003C\u002Fp\u003E\u003Cp\u003EНаконец, если шифровать каждый бит обычного текста, это серьёзно сказывается на использовании доступного пространства. Каждая операция по шифрованию отдельного бита соответствует списку примерно из 700 32-разрядных целых чисел. Если вы хотите зашифровать монохромное изображение размером 100×100 пикселей, каждый пиксель которого выражается 8-разрядным целым числом (0-255), вам понадобится \u003Cstrong\u003E218 МибиБ,\u003C\u002Fstrong\u003E чтобы сохранить все эти пиксели в памяти. Это примерно 20 000-кратные издержки. Для сравнения, видеоклип на песню Рика Эстли “Never Gonna Give You Up” при качестве 360p занимает около 9 МибиБ (что довольно мало для трёхминутного видео!). Если же этот видеоклип будет зашифрован по ПГШ, то его размер составит \u003Cstrong\u003E188 ГибиБ\u003C\u002Fstrong\u003E, что (осторожная оценка) соответствует 20 полнометражным фильмам в качестве 1080p. В некоторых других схемах ПГШ предусмотрены меньшие размеры шифротекста, но это достигается за счёт ещё более высоких требований к оперативной памяти, в которой будут производиться вычисления. Поэтому, если вы собираетесь эксплуатировать программы для обработки видео – это осуществимо, но работу потребуется должным образом распределить, а также продумать, как максимально ужать данные перед шифрованием. Например, можно работать при низком разрешении, в тонах серого, с пониженной кадровой частотой. Все эти меры также в целом ускорят работу программ.\u003C\u002Fp\u003E\u003Cp\u003EДо новых встреч!\u003C\u002Fp\u003E\u003Cp\u003E\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"fhe"},{"titleHtml":"компилятор"},{"titleHtml":"шифрование"},{"titleHtml":"оптимизация"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7bc\u002F7e8\u002F1c8\u002F7bc7e81c85f1a3b17fdb3bc800b63b3b.png","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7bc\u002F7e8\u002F1c8\u002F7bc7e81c85f1a3b17fdb3bc800b63b3b.png","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F717848\\\u002F\"},\"headline\":\"Компилятор с полностью гомоморфным шифрованием от Google\",\"datePublished\":\"2023-02-19T12:36:09+03:00\",\"dateModified\":\"2023-02-19T18:06:41+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Sivchenko_translate\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования (вот объявление об этом в рассылке). С тех пор я учас...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F717848\\\u002F#post-content-body\",\"about\":[\"h_crypto\",\"h_programming\",\"h_cpp\",\"h_compilers\",\"f_develop\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F717848\\\u002F2ffb5cd42998b306be858a79da78af13\\\u002F\"]}","metaDescription":"Ещё в мае 2022 года я переориентировал пару команд в Google на разработку полностью гомоморфного шифрования ( вот объявление об этом в рассылке ). С тех пор я участвовал в работе над многими...","mainImageUrl":null,"amp":true,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":null,"readingTime":19,"complexity":null,"isEditorial":true}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"QT разработчик","vacanciesCount":14,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fc_plus_plus_qt_developer","itemHubs":["qt_software","cpp"]},{"title":"Программист C++","vacanciesCount":117,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fprogrammist_c_plus_plus","itemHubs":["cpp"]}],"hubs":"crypto,programming,cpp,compilers"},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"updates":{"countNewPostsBySubscription":null,"countNewPostsAll":33,"countNewNewsAll":7},"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"courses":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-238","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F552\u002F8b6\u002Fb04\u002F5528b6b043be178d6cb353938a37c41f.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Flotus-main"},"title":"Найти дзен","lang":"ru","startTime":"2023-02-16T12:00:00+03:00","finishTime":"2023-02-26T11:43:00+03:00","slides":[{"id":"story-238_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5b0\u002F96a\u002Fba8\u002F5b096aba81be66041a2aa907dece5800.jpg","button":null},{"id":"story-238_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F710\u002Faaf\u002Fd5e\u002F710aafd5e1dee1d68ec384e25062562d.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Flotus-1","colorType":"light"}},{"id":"story-238_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fabd\u002Ffa8\u002F3ad\u002Fabdfa83ad425d6093bf5b562498d4a0e.jpg","button":{"title":"Чем и кому?","link":"https:\u002F\u002Fu.habr.com\u002Flotus-2","colorType":"light"}},{"id":"story-238_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F74d\u002F464\u002F9af\u002F74d4649af8509dd19e49f44be684bfcd.jpg","button":{"title":"Как это работает?","link":"https:\u002F\u002Fu.habr.com\u002Flotus-3","colorType":"light"}},{"id":"story-238_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f1\u002Ffbb\u002F5a6\u002F4f1fbb5a6daa2c5839e920db487cb8c1.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fu.habr.com\u002Flotus-4","colorType":"light"}},{"id":"story-238_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8d9\u002Fa2c\u002F146\u002F8d9a2c14645db00326f575c448144b49.jpg","button":{"title":"Как обнаружить?","link":"https:\u002F\u002Fu.habr.com\u002Flotus-5","colorType":"light"}},{"id":"story-238_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7f0\u002F531\u002F294\u002F7f0531294cedd2e9e4dd047ea21b493b.jpg","button":{"title":"Посмотреть","link":"https:\u002F\u002Fu.habr.com\u002Flotus-6","colorType":"light"}}]},{"id":"story-234","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F16a\u002Fe4a\u002Fb61\u002F16ae4ab611326cc11d0d8919c149d95c.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002FqQNg9"},"title":"Консультации на Хабр Экспертах: бэкенд","lang":"ru","startTime":"2023-02-15T15:33:00+03:00","finishTime":"2023-02-22T15:27:00+03:00","slides":[{"id":"story-234_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F523\u002F9ed\u002F058\u002F5239ed058e84d21597e19ca56650f880.png","button":null},{"id":"story-234_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F207\u002F976\u002F160\u002F207976160ce35d4fbd90cb705d597fe9.png","button":null},{"id":"story-234_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F38c\u002F675\u002Fd4f\u002F38c675d4f4c5ba17441f2c43949ca4b3.png","button":null},{"id":"story-234_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F287\u002F395\u002F4a4\u002F2873954a46af32bf23ca60d0c2c00c16.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FqQNg9","colorType":"dark"}}]},{"id":"story-228","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F026\u002F1fe\u002Fc97\u002F0261fec9713f03e7bbaec8a99fd0a95b.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Недельный топ годноты от компаний","lang":"ru","startTime":"2023-02-15T11:00:00+03:00","finishTime":"2023-02-21T17:00:00+03:00","slides":[{"id":"story-228_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3d5\u002Fe21\u002F351\u002F3d5e21351512ad34216523b08ede4024.jpg","button":null},{"id":"story-228_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8ef\u002Fb1e\u002F7f4\u002F8efb1e7f4a6f5986dbbc2cdd1dd2c447.jpg","button":{"title":"Выбрать сценарий","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftimeweb\u002Fblog\u002F711288\u002F","colorType":"light"}},{"id":"story-228_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F03d\u002Ffa3\u002F79d\u002F03dfa379dbc41cedb33d93b658876d76.jpg","button":{"title":"Как именно?","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fbelayaraduga\u002Fblog\u002F713636\u002F","colorType":"light"}},{"id":"story-228_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0c2\u002F6e0\u002Ff07\u002F0c26e0f07bef607419cfc016005b7975.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ffirst\u002Fblog\u002F714940\u002F","colorType":"light"}},{"id":"story-228_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F668\u002F4c8\u002F0ee\u002F6684c80ee37964dc482d1e4059236c86.jpg","button":{"title":"Смотреть обзор","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fjetinfosystems\u002Fblog\u002F713284\u002F","colorType":"light"}},{"id":"story-228_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8e5\u002F05f\u002Ffa0\u002F8e505ffa0510a1c7ab84eecb2e31f88e.jpg","button":{"title":"Научиться","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fods\u002Fblog\u002F709222\u002F","colorType":"light"}},{"id":"story-228_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F362\u002F4dd\u002Fc41\u002F3624ddc414b0ee14009364669e892adb.jpg","button":{"title":"Ознакомиться","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F715192\u002F","colorType":"light"}},{"id":"story-228_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe1b\u002Ff76\u002F602\u002Fe1bf7660228906801c055ed106e88875.jpg","button":{"title":"Узнать больше","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fgetmatch\u002Fblog\u002F714448\u002F","colorType":"light"}}]},{"id":"story-224","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4fa\u002F899\u002F490\u002F4fa899490d1c57ec7064ea09e8d50a14.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fwebcast_MLOps"},"title":"От MLOps к TriceratОps","lang":"ru","startTime":"2023-02-14T10:00:47+03:00","finishTime":"2023-02-21T23:59:00+03:00","slides":[{"id":"story-224_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F607\u002Fded\u002F888\u002F607ded88881e3c2b400eb781da7e1b1d.png","button":null},{"id":"story-224_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F915\u002Fdb0\u002F681\u002F915db0681d302a5736b4b29689bc2dc1.png","button":{"title":"Симптомы","link":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=rK2V4J6Z7CU&t=747s","colorType":"light"}},{"id":"story-224_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F514\u002F8fc\u002F078\u002F5148fc078b174adbb89583a7d8e20ad8.png","button":{"title":"Рецепт полностью","link":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=rK2V4J6Z7CU&t=1065s","colorType":"light"}},{"id":"story-224_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2a3\u002F41f\u002F544\u002F2a341f544d0576086b9f48783854934f.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=rK2V4J6Z7CU&t=2273s","colorType":"light"}},{"id":"story-224_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F518\u002Fdde\u002F7e8\u002F518dde7e8d747cb1f3fce200094abaee.png","button":{"title":"В чём подвох","link":"https:\u002F\u002Fwww.youtube.com\u002Fwatch?v=rK2V4J6Z7CU&t=2912s","colorType":"light"}},{"id":"story-224_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcce\u002Fa7e\u002F58b\u002Fccea7e58b28908ec545db0e361347a43.jpg","button":{"title":"Посмотреть","link":"https:\u002F\u002Fyoutu.be\u002FyLsY984z_iI?list=PLTlO6nV_TaGCFJ4AZM5IA7JnMDSpoC0_Y","colorType":"light"}}]},{"id":"story-222","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F312\u002Fabe\u002Fd4c\u002F312abed4c2617f05f485c19ae101de7e.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Любовь, Хабр и роботы","lang":"ru","startTime":"2023-02-14T09:00:14+03:00","finishTime":"2023-02-26T23:59:00+03:00","slides":[{"id":"story-222_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd35\u002Fce5\u002F716\u002Fd35ce5716f14544be26d53e05dc155ab.jpg","button":null},{"id":"story-222_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F191\u002Fb9c\u002F449\u002F191b9c449738d2cb2333ffa8daa1bd39.jpg","button":{"title":"Читать переводы","link":"https:\u002F\u002Fu.habr.com\u002Fval1","colorType":"light"}},{"id":"story-222_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7c6\u002F61d\u002F6d9\u002F7c661d6d915ca10f037ccc7307fa36ec.jpg","button":{"title":"Что получилось?","link":"https:\u002F\u002Fu.habr.com\u002Fval2","colorType":"light"}},{"id":"story-222_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F02c\u002F20a\u002Fa28\u002F02c20aa28f1e1cb7d70943bd96eb5ac7.jpg","button":{"title":"Созерцать","link":"https:\u002F\u002Fu.habr.com\u002Fval3","colorType":"light"}},{"id":"story-222_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe94\u002F9d6\u002F03e\u002Fe949d603e63cf1c98dcc4597ba41abfa.jpg","button":{"title":"На свидание","link":"https:\u002F\u002Fu.habr.com\u002Fval4","colorType":"light"}},{"id":"story-222_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7b0\u002F3b3\u002Fed9\u002F7b03b3ed931ce73a0cda771b5e39c813.jpg","button":{"title":"Нашёл?","link":"https:\u002F\u002Fu.habr.com\u002Fval5","colorType":"light"}},{"id":"story-222_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F594\u002Fff6\u002Fbad\u002F594ff6badc0503fa3ca0dffafc31d3a3.jpg","button":{"title":"И сколько же?","link":"https:\u002F\u002Fu.habr.com\u002Fval6","colorType":"light"}},{"id":"story-222_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F452\u002Ff87\u002F9aa\u002F452f879aaf0db9530f35204663ec00e6.jpg","button":{"title":"Глянуть код","link":"https:\u002F\u002Fu.habr.com\u002Fval7","colorType":"light"}}]},{"id":"story-218","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F95d\u002F032\u002F360\u002F95d03236093f23cb006751a911c1ca1b.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002FIcDGH"},"title":"Активность найма на IT-рынке в январе","lang":"ru","startTime":"2023-02-13T10:40:00+03:00","finishTime":"2023-02-20T23:59:41+03:00","slides":[{"id":"story-218_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F63e\u002Fcd3\u002F3ff\u002F63ecd33ff8e108e28fcb72af09339823.png","button":null},{"id":"story-218_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0d1\u002F442\u002Ffa0\u002F0d1442fa021337f0c716405b19bd9aac.png","button":null},{"id":"story-218_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F16c\u002F7c1\u002F755\u002F16c7c17552d38519e88e3ac166ae4826.png","button":null},{"id":"story-218_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F802\u002Fbb8\u002Fed1\u002F802bb8ed1bddd0bf8afff9d90507fe8a.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002FIcDGH","colorType":"dark"}}]},{"id":"story-214","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F02e\u002F69c\u002F1b8\u002F02e69c1b8cc1292fe53929083a93f699.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"ИБ от Луки: топ-7 самых рейтинговых постов","lang":"ru","startTime":"2023-02-09T13:45:00+03:00","finishTime":"2023-02-19T23:59:00+03:00","slides":[{"id":"story-214_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F1aa\u002F5cc\u002F9d7\u002F1aa5cc9d7d557d97845d7d2bc0b1fe6a.jpg","button":null},{"id":"story-214_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd34\u002Fdc1\u002Ffee\u002Fd34dc1fee24eef1780fcb50decad4c6f.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-01","colorType":"light"}},{"id":"story-214_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F3e6\u002F2c4\u002F857\u002F3e62c4857decb9a45a38deacbf607879.jpg","button":{"title":"Читать пост","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-02","colorType":"light"}},{"id":"story-214_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa72\u002F490\u002Fd35\u002Fa72490d3551469f32d8895f0cc4899ff.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-03","colorType":"light"}},{"id":"story-214_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9f4\u002Ffed\u002F927\u002F9f4fed92715d9632655fa6ee5c281afa.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-04","colorType":"light"}},{"id":"story-214_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6be\u002Fbd5\u002Fe91\u002F6bebd5e913cc08b41010e9188e35156c.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-05","colorType":"light"}},{"id":"story-214_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2b3\u002F98b\u002Fa15\u002F2b398ba15bfb71e57d306aad220d466c.jpg","button":{"title":"Читать пост","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-06","colorType":"light"}},{"id":"story-214_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa9e\u002Fac9\u002Ffba\u002Fa9eac9fba81f7ae1feb21f2ddb42635a.jpg","button":{"title":"Читать","link":"https:\u002F\u002Fu.habr.com\u002Fluka2-07","colorType":"light"}}]},{"id":"story-202","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F355\u002F61d\u002F02e\u002F35561d02e68fad97acb3023f5ed0943e.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002Fitzp2022-2"},"title":"Зарплаты в IT во второй половине 2022","lang":"ru","startTime":"2023-02-06T11:00:00+03:00","finishTime":"2023-02-19T23:59:00+03:00","slides":[{"id":"story-202_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F872\u002F6da\u002F434\u002F8726da4345864736c32cea5f6d0e8520.png","button":null},{"id":"story-202_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F079\u002F168\u002F80c\u002F07916880c5cd1a3e489233861be84a72.png","button":null},{"id":"story-202_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F600\u002F579\u002F3ab\u002F6005793ab7a69e006a6b13026dbf89a5.png","button":null},{"id":"story-202_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcb8\u002Fdc0\u002F099\u002Fcb8dc00992a4cd63c5d614b57e8037b5.png","button":null},{"id":"story-202_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Faff\u002F90f\u002Fe80\u002Faff90fe80f9466fe702f08b13658e8f2.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fitzp2022-2","colorType":"dark"}}]},{"id":"story-190","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fac3\u002F3cd\u002F1b0\u002Fac33cd1b02027add0414f306d5e37731.png","title":"Мир Plat.Form (НСПК)","link":"https:\u002F\u002Fu.habr.com\u002Fstories_mir_QRcode"},"title":"О QR-коде в гравюрах и хокку","lang":"ru","startTime":"2023-02-02T12:30:00+03:00","finishTime":"2023-02-19T23:59:00+03:00","slides":[{"id":"story-190_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5bb\u002F2f6\u002F42c\u002F5bb2f642cf18bbacbfd01bb1736d303d.jpg","button":{"title":"Подслушать","link":"https:\u002F\u002Fu.habr.com\u002Fstories_mir_QRcode","colorType":"dark"}},{"id":"story-190_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F9b5\u002Fc66\u002F564\u002F9b5c665645bf62db2907bfe22b3decf4.png","button":{"title":"Узнать почему","link":"https:\u002F\u002Fu.habr.com\u002Fstories_mir_QRcode","colorType":"dark"}},{"id":"story-190_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc4e\u002F457\u002F8c0\u002Fc4e4578c0ae364b388a38a78023007e1.jpg","button":{"title":"Как он работает","link":"https:\u002F\u002Fu.habr.com\u002Fstories_mir_QRcode","colorType":"dark"}},{"id":"story-190_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Febb\u002Fa53\u002Fe42\u002Febba53e42c52e27a0e815af78be5bdd9.png","button":{"title":"Узнать подробности","link":"https:\u002F\u002Fu.habr.com\u002Fstories_mir_QRcode","colorType":"dark"}}]},{"id":"story-186","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb6b\u002F720\u002F180\u002Fb6b72018041811571246ddf5ef07bd33.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002Fstory_season-kuber"},"title":"Столкнуться с кубом","lang":"ru","startTime":"2023-02-01T11:30:00+03:00","finishTime":"2023-02-28T23:59:00+03:00","slides":[{"id":"story-186_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2b0\u002F5e8\u002Fffb\u002F2b05e8ffb30634f0f7f5c9602d8e43e6.png","button":null},{"id":"story-186_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdfb\u002F838\u002F9c1\u002Fdfb8389c197e915942f9144978b91ce4.png","button":null},{"id":"story-186_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F634\u002Fc42\u002Fdfd\u002F634c42dfddb260cdf37f9c9b9d3f34ea.png","button":null},{"id":"story-186_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F401\u002F9f5\u002F59e\u002F4019f559e6c090ded0b46d6deeb4883c.png","button":null},{"id":"story-186_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F82a\u002F9cd\u002Fa48\u002F82a9cda4870156765b749271aca48241.png","button":{"title":"Смотреть участников","link":"https:\u002F\u002Fu.habr.com\u002Fstory_season-kuber_members","colorType":"light"}}]},{"id":"story-152","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa49\u002F0d3\u002F609\u002Fa490d3609f29b6dfc53a7b88ab47ca64.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa"},"title":"Сеньоры — очень странные люди","lang":"ru","startTime":"2023-01-23T11:00:00+03:00","finishTime":"2023-03-01T23:59:00+03:00","slides":[{"id":"story-152_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbbb\u002F901\u002F063\u002Fbbb9010630ae483ed1f41ec4e2572c13.png","button":null},{"id":"story-152_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f8\u002F66c\u002F14f\u002F4f866c14f0ca8999334438d7f17c0e3a.png","button":null},{"id":"story-152_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6b9\u002Fa07\u002Fa61\u002F6b9a07a612df213ac3a1c179301828df.png","button":null},{"id":"story-152_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff6b\u002Fadb\u002Fb99\u002Ff6badbb9969d7e34ef4f7492767c6a77.png","button":null},{"id":"story-152_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd9c\u002F9ac\u002F878\u002Fd9c9ac878bec5b494699e0080dd2e813.png","button":null},{"id":"story-152_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdb1\u002Faf9\u002Fc3b\u002Fdb1af9c3bb557f6cee698cf67610f977.png","button":null},{"id":"story-152_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5cf\u002Fbed\u002F65b\u002F5cfbed65bd20b7051b1aac2b9d6e807e.png","button":null},{"id":"story-152_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa8\u002F251\u002F4a9\u002Ffa82514a9471cd455339e97178d8c021.png","button":null},{"id":"story-152_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbd5\u002F901\u002Fe95\u002Fbd5901e952d9cf638355a3cc8b0c0911.png","button":{"title":"Хочу помочь джуну","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script> 
  <script src="https://assets.habr.com/habr-web/js/chunk-vendors.a5368ccd.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/6741.eb1970d2.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/app.34e7f643.js" defer></script> 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script> 
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script> 
  <script type="text/javascript">
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script> 
  <noscript> 
   <div> 
    <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt=""> 
   </div> 
  </noscript> 
  <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script> 
  <script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>  
 </body>
</html>