<!doctype html>
<html lang="ru" data-vue-meta="%7B%22lang%22:%7B%22ssr%22:%22ru%22%7D%7D"> 
 <head> 
  <meta charset="UTF-8"> 
  <meta name="viewport" content="width=device-width,initial-scale=1.0,viewport-fit=cover,maximum-scale=1,user-scalable=0"> 
  <meta name="referrer" content="unsafe-url"> 
  <title>Развёртывание программных систем в Kubernetes с помощью Jsonnet / Хабр</title> 
  <style>
    /* cyrillic-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSxf6TF0.woff2) format('woff2');
      unicode-range: U+0460-052F, U+1C80-1C88, U+20B4, U+2DE0-2DFF, U+A640-A69F, U+FE2E-FE2F;
    }

    /* cyrillic */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveQhf6TF0.woff2) format('woff2');
      unicode-range: U+0400-045F, U+0490-0491, U+04B0-04B1, U+2116;
    }

    /* latin-ext */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveSBf6TF0.woff2) format('woff2');
      unicode-range: U+0100-024F, U+0259, U+1E00-1EFF, U+2020, U+20A0-20AB, U+20AD-20CF, U+2113, U+2C60-2C7F, U+A720-A7FF;
    }

    /* latin */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/s/firasans/v11/va9B4kDNxMZdWfMOD5VnZKveRhf6.woff2) format('woff2');
      unicode-range: U+0000-00FF, U+0131, U+0152-0153, U+02BB-02BC, U+02C6, U+02DA, U+02DC, U+2000-206F, U+2074, U+20AC, U+2122, U+2191, U+2193, U+2212, U+2215, U+FEFF, U+FFFD;
    }

    /* non-breaking hyphen */
    @font-face {
      font-family: 'Fira Sans';
      font-style: normal;
      font-weight: 500;
      font-display: swap;
      src: url(https://fonts.gstatic.com/l/font?kit=KFOlCnqEu92Fr1MmEU9vBh0_IsHAlmrO6g&skey=ee881451c540fdec&v=v29) format('woff2');
      unicode-range: U+02011;
    }
  </style> 
  <link rel="preload" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/chunk-vendors.129fcbcb.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/css/app.2dc3dce9.css" as="style">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/app.8a380906.js" as="script">
  <link rel="preload" href="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" as="script"> 
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/chunk-vendors.b6238726.css">
  <link rel="stylesheet" href="https://assets.habr.com/habr-web/css/app.2dc3dce9.css"> 
  <script>window.i18nFetch = new Promise((res, rej) => {
          const xhr = new XMLHttpRequest();
          xhr.open('GET', '/js/i18n/ru-compiled.99fdff73029c662d76a25e7927355795.json');
          xhr.responseType = 'json';
          xhr.onload = function(e) {
            if (this.status === 200) {
              res({ru: xhr.response});
            } else {
              rej(e);
            }
          };
          xhr.send();
        });</script> 
  <script data-vue-meta="ssr" type="application/ld+json" data-vmid="ldjson-schema">{"@context":"http:\/\/schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https:\/\/habr.com\/ru\/post\/720556\/"},"headline":"Развёртывание программных систем в Kubernetes с помощью Jsonnet","datePublished":"2023-03-05T18:10:25+03:00","dateModified":"2023-03-05T18:38:25+03:00","author":{"@type":"Person","name":"Арсений Жижелев"},"publisher":{"@type":"Organization","name":"Habr","logo":{"@type":"ImageObject","url":"https:\/\/habrastorage.org\/webt\/a_\/lk\/9m\/a_lk9mjkccjox-zccjrpfolmkmq.png"}},"description":"Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескол...","url":"https:\/\/habr.com\/ru\/post\/720556\/#post-content-body","about":["h_devops","h_kubernetes","h_funcprog","f_develop","f_admin"],"image":["https:\/\/habr.com\/share\/publication\/720556\/18d347438fae4f447c2a5f46f4187372\/"]}</script> 
  <script src="//www.googletagservices.com/tag/js/gpt.js" async></script> 
  <style>.grecaptcha-badge{visibility: hidden;}</style> 
  <meta name="habr-version" content="2.114.0"> 
  <meta data-vue-meta="ssr" property="fb:app_id" content="444736788986613">
  <meta data-vue-meta="ssr" property="fb:pages" content="472597926099084">
  <meta data-vue-meta="ssr" name="twitter:card" content="summary_large_image">
  <meta data-vue-meta="ssr" name="twitter:site" content="@habr_com">
  <meta data-vue-meta="ssr" property="og:site_name" content="Хабр" data-vmid="og:site_name">
  <meta data-vue-meta="ssr" property="og:title" content="Развёртывание программных систем в Kubernetes с помощью Jsonnet" data-vmid="og:title">
  <meta data-vue-meta="ssr" name="twitter:title" content="Развёртывание программных систем в Kubernetes с помощью Jsonnet" data-vmid="twitter:title">
  <meta data-vue-meta="ssr" name="aiturec:title" content="Развёртывание программных систем в Kubernetes с помощью Jsonnet" data-vmid="aiturec:title">
  <meta data-vue-meta="ssr" name="description" content="Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment,..." data-vmid="description">
  <meta data-vue-meta="ssr" itemprop="description" content="Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment,..." data-vmid="description:itemprop">
  <meta data-vue-meta="ssr" property="og:description" content="Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment,..." data-vmid="og:description">
  <meta data-vue-meta="ssr" name="twitter:description" content="Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment,..." data-vmid="twitter:description">
  <meta data-vue-meta="ssr" property="aiturec:description" content="Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment,..." data-vmid="aiturec:description">
  <meta data-vue-meta="ssr" itemprop="image" content="https://habr.com/share/publication/720556/18d347438fae4f447c2a5f46f4187372/" data-vmid="image:itemprop">
  <meta data-vue-meta="ssr" property="og:image" content="https://habr.com/share/publication/720556/18d347438fae4f447c2a5f46f4187372/" data-vmid="og:image">
  <meta data-vue-meta="ssr" property="og:image:width" content="1200" data-vmid="og:image:width">
  <meta data-vue-meta="ssr" property="og:image:height" content="630" data-vmid="og:image:height">
  <meta data-vue-meta="ssr" property="aiturec:image" content="https://habr.com/share/publication/720556/18d347438fae4f447c2a5f46f4187372/" data-vmid="aiturec:image">
  <meta data-vue-meta="ssr" name="twitter:image" content="https://habr.com/share/publication/720556/18d347438fae4f447c2a5f46f4187372/" data-vmid="twitter:image">
  <meta data-vue-meta="ssr" property="vk:image" content="https://habr.com/share/publication/720556/18d347438fae4f447c2a5f46f4187372/?format=vk" data-vmid="vk:image">
  <meta data-vue-meta="ssr" property="aiturec:item_id" content="720556" data-vmid="aiturec:item_id">
  <meta data-vue-meta="ssr" property="aiturec:datetime" content="2023-03-05T15:10:25.000Z" data-vmid="aiturec:datetime">
  <meta data-vue-meta="ssr" content="https://habr.com/ru/post/720556/" property="og:url" data-vmid="og:url">
  <meta data-vue-meta="ssr" property="og:type" content="article" data-vmid="og:type">
  <meta data-vue-meta="ssr" property="og:locale" content="ru_RU" data-vmid="og:locale">
  <meta data-vue-meta="ssr" name="keywords" content="k8s, Kubernetes, Jsonnet, системный подход, continuous deployment, разработка ПО, CI/CD, DevOps"> 
  <link data-vue-meta="ssr" href="https://habr.com/ru/rss/post/720556/?fl=ru" type="application/rss+xml" title="" rel="alternate" name="rss">
  <link data-vue-meta="ssr" href="https://habr.com/ru/post/720556/" rel="canonical" data-vmid="canonical">
  <link data-vue-meta="ssr" rel="image_src" href="https://habr.com/share/publication/720556/18d347438fae4f447c2a5f46f4187372/" data-vmid="image:href"> 
  <meta name="apple-mobile-web-app-status-bar-style" content="#303b44"> 
  <meta name="msapplication-TileColor" content="#629FBC"> 
  <meta name="apple-mobile-web-app-capable" content="yes"> 
  <meta name="mobile-web-app-capable" content="yes"> 
  <link rel="shortcut icon" type="image/png" sizes="16x16" href="https://assets.habr.com/habr-web/img/favicons/favicon-16.png"> 
  <link rel="shortcut icon" type="image/png" sizes="32x32" href="https://assets.habr.com/habr-web/img/favicons/favicon-32.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="76x76" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-76.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="120x120" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="152x152" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-152.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="180x180" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-180.png"> 
  <link rel="apple-touch-icon" type="image/png" sizes="256x256" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-256.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1136x640.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2436x1125.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1792x828.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_828x1792.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_1334x750.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2208x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 812px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1125x2436.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 736px) and (-webkit-device-pixel-ratio: 3) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1242x2208.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2732x2048.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 414px) and (device-height: 896px) and (-webkit-device-pixel-ratio: 3) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2688x1242.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2224x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 375px) and (device-height: 667px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_750x1334.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 1024px) and (device-height: 1366px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x2732.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2388x1668.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1112px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2224.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 320px) and (device-height: 568px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_640x1136.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 834px) and (device-height: 1194px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1668x2388.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: landscape)" href="https://assets.habr.com/habr-web/img/splashes/splash_2048x1536.png"> 
  <link rel="apple-touch-startup-image" media="screen and (device-width: 768px) and (device-height: 1024px) and (-webkit-device-pixel-ratio: 2) and (orientation: portrait)" href="https://assets.habr.com/habr-web/img/splashes/splash_1536x2048.png"> 
  <link rel="mask-icon" color="#77a2b6" href="https://assets.habr.com/habr-web/img/favicons/apple-touch-icon-120.svg"> 
  <link crossorigin="use-credentials" href="/manifest.webmanifest" rel="manifest"> 
  <script async src="https://unpkg.com/pwacompat" crossorigin="anonymous"></script> 
  <script>window.yaContextCb = window.yaContextCb || []</script> 
  <script src="https://yandex.ru/ads/system/context.js" async></script> 
 </head> 
 <body> 
  <div id="app" data-server-rendered="true" data-async-called="true">
   <div class="tm-layout__wrapper">
    <!----> 
    <div></div> <!----> 
    <header class="tm-header">
     <div class="tm-page-width">
      <div class="tm-header__container">
       <!----> <span class="tm-header__logo-wrap"><a href="/ru/" class="tm-header__logo tm-header__logo_ru">
         <svg height="16" width="16" class="tm-svg-img tm-header__icon">
          <title>Хабр</title> <use xlink:href="/img/habr-logo-ru.svg#logo"></use>
         </svg></a> <span class="tm-header__beta-sign" style="display:none;">β</span></span> 
       <div class="tm-dropdown tm-header__projects">
        <div class="tm-dropdown__head">
         <button class="tm-header__dropdown-toggle">
          <svg height="16" width="16" class="tm-svg-img tm-header__icon tm-header__icon_dropdown">
           <title>Открыть список</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#arrow-down"></use>
          </svg></button>
        </div> <!---->
       </div> <a href="/ru/sandbox/start/" class="tm-header__become-author-btn"> Как стать автором </a> 
       <div class="tm-feature tm-header__feature tm-feature tm-feature_variant-inline">
        <!---->
       </div> <!----> <!---->
      </div>
     </div>
    </header> 
    <div class="tm-layout">
     <div class="tm-page-progress-bar"></div> 
     <div data-menu-sticky="true" class="tm-base-layout__header tm-base-layout__header_is-sticky">
      <div class="tm-page-width">
       <div class="tm-base-layout__header-wrapper">
        <div class="tm-main-menu">
         <div class="tm-main-menu__section">
          <nav class="tm-main-menu__section-content">
           <!----> <a href="/ru/all/" class="tm-main-menu__item"> Все потоки </a> <a href="/ru/flows/develop/" class="tm-main-menu__item"> Разработка </a><a href="/ru/flows/admin/" class="tm-main-menu__item"> Администрирование </a><a href="/ru/flows/design/" class="tm-main-menu__item"> Дизайн </a><a href="/ru/flows/management/" class="tm-main-menu__item"> Менеджмент </a><a href="/ru/flows/marketing/" class="tm-main-menu__item"> Маркетинг </a><a href="/ru/flows/popsci/" class="tm-main-menu__item"> Научпоп </a>
          </nav>
         </div>
        </div> 
        <div class="tm-header-user-menu tm-base-layout__user-menu">
         <a href="/ru/search/" class="tm-header-user-menu__item tm-header-user-menu__search">
          <svg height="24" width="24" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_search tm-header-user-menu__icon_dark">
           <title>Поиск</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#search"></use>
          </svg></a> <!----> <!----> <!----> 
         <div class="tm-header-user-menu__item tm-header-user-menu__user_desktop">
          <div class="tm-dropdown">
           <div class="tm-dropdown__head">
            <svg height="24" width="24" data-test-id="menu-toggle-guest" class="tm-svg-img tm-header-user-menu__icon tm-header-user-menu__icon_dark">
             <title>Профиль</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#header-user"></use>
            </svg> <!---->
           </div> <!---->
          </div> <!---->
         </div> <!---->
        </div>
       </div>
      </div>
     </div> <!----> 
     <div class="tm-page-width"></div> 
     <main class="tm-layout__container">
      <div hl="ru" data-async-called="true" class="tm-page">
       <div class="tm-page-width">
        <!----> 
        <div class="tm-page__wrapper">
         <div class="tm-page__main tm-page__main_has-sidebar">
          <div class="pull-down">
           <!----> 
           <div class="pull-down__header" style="height:0px;">
            <div class="pull-down__content" style="bottom:10px;">
             <svg height="24" width="24" class="tm-svg-img pull-down__arrow">
              <title>Обновить</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#pull-arrow"></use>
             </svg>
            </div>
           </div> 
           <div class="tm-article-presenter"> 
            <div class="tm-article-presenter__body">
             <div class="tm-misprint-area">
              <div class="tm-misprint-area__wrapper">
               <article class="tm-article-presenter__content tm-article-presenter__content_narrow">
                <div class="tm-article-presenter__header"> 
                 <div class="tm-article-snippet tm-article-presenter__snippet tm-article-snippet">
                  <div class="tm-article-snippet__meta-container">
                   <div class="tm-article-snippet__meta">
                    <span class="tm-user-info tm-article-snippet__author"><a href="/ru/users/primetalk/" title="primetalk" class="tm-user-info__userpic">
                      <div class="tm-entity-image">
                       <svg height="24" width="24" class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink">
                        <!----> <use xlink:href="/img/megazord-v28.2b11c25e..svg#placeholder-user"></use>
                       </svg>
                      </div></a> <span class="tm-user-info__user"><a href="/ru/users/primetalk/" class="tm-user-info__username"> primetalk <!----></a> <span class="tm-article-datetime-published"><time datetime="2023-03-05T15:10:25.000Z" title="2023-03-05, 18:10">1 час назад</time></span></span></span>
                   </div> <!---->
                  </div> 
                  <h1 lang="ru" class="tm-article-snippet__title tm-article-snippet__title_h1"><span>Развёртывание программных систем в Kubernetes с помощью Jsonnet</span></h1> 
                  <div class="tm-article-snippet__stats">
                   <div class="tm-article-complexity tm-article-complexity_complexity-medium">
                    <span class="tm-svg-icon__wrapper tm-article-complexity__icon">
                     <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                      <title>Уровень сложности</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#complexity-medium"></use>
                     </svg></span> <span class="tm-article-complexity__label"> Средний </span>
                   </div> 
                   <div class="tm-article-reading-time">
                    <span class="tm-svg-icon__wrapper tm-article-reading-time__icon">
                     <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                      <title>Время на прочтение</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#clock"></use>
                     </svg></span> <span class="tm-article-reading-time__label"> 10 мин </span>
                   </div> <span class="tm-icon-counter tm-data-icons__item">
                    <svg height="24" width="24" class="tm-svg-img tm-icon-counter__icon">
                     <title>Количество просмотров</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-views"></use>
                    </svg> <span class="tm-icon-counter__value">125</span></span>
                  </div> 
                  <div class="tm-article-snippet__hubs-container">
                   <div class="tm-article-snippet__hubs">
                    <span class="tm-article-snippet__hubs-item"><a href="/ru/hub/devops/" class="tm-article-snippet__hubs-item-link"><span>DevOps</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/kubernetes/" class="tm-article-snippet__hubs-item-link"><span>Kubernetes</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span><span class="tm-article-snippet__hubs-item"><a href="/ru/hub/funcprog/" class="tm-article-snippet__hubs-item-link"><span>Функциональное программирование</span> <span title="Профильный хаб" class="tm-article-snippet__profiled-hub">*</span></a></span>
                   </div>
                  </div> 
                  <div class="tm-article-snippet__labels-container">
                   <div class="tm-article-snippet__labels">
                    <div class="tm-article-snippet__label tm-article-snippet__label_variant-opinion">
                     <span> Мнение </span>
                    </div> 
                   </div>
                  </div> <!----> <!---->
                 </div>
                </div> <!----> 
                <div data-gallery-root="" lang="ru" class="tm-article-body">
                 <div></div> 
                 <div id="post-content-body">
                  <div>
                   <div class="article-formatted-body article-formatted-body article-formatted-body_version-1">
                    <div xmlns="http://www.w3.org/1999/xhtml">
                     <p>Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment, secret, statefulset,… Конфигурация каждого ресурса задаётся унифицированно с помощью YAML (или JSON) манифеста. Kubernetes API и интерфейс командной строки позволяют манипулировать манифестами ресурсов, а сами ресурсы автоматически приводятся в состояние, соответствующее манифестам.</p>
                     <br> 
                     <p>Для формирования согласованных конфигураций ресурсов используются дополнительные технологии. Например, </p>
                     <br> 
                     <ul> 
                      <li>Helm — генерация манифестов на основе строковых шаблонов + "магазин" готовых компонентов (package manager).</li> 
                      <li>Kustomize — ("Kubernetes cUSTOMIZation") — донастройка манифестов путём внесения исправлений в различные свойства.</li> 
                      <li>Jsonnet — генерация манифестов с использованием легковесного функционального языка, предназначенного для генерации JSON.</li> 
                     </ul>
                     <br> 
                     <p>Для синхронизации проектов, хранящихся в репозитории git, с фактическим состоянием инфраструктуры в каком-либо кластере может использоваться специальное приложение, работающее в рамках концепции GitOps, например ArgoCD. Причём поддерживаются как проекты, содержащие собственно манифесты, так и проекты, основанные на вышеперечисленных генераторах/модификаторах.</p>
                     <br> 
                     <p>Эти генераторы широко применяются в различных приложениях и, в целом, позволяют решить задачи, связанные с развёртыванием инфраструктуры. Однако, имеются существенные отличия в подходах, что определяет возможности и потенциальный охват задач.</p>
                     <br> 
                     <p>Рассмотрим, какие требования было бы разумно предъявить к языку описания инфраструктуры. (В этой заметке излагается взгляд автора, занимающегося разработкой программного обеспечения. Другие стороны, например, команды эксплуатации, могут иметь иной взгляд на этот вопрос.)</p><a name="habracut"></a>
                     <br> 
                     <h2 id="trebovaniya-k-yazyku-programmirovaniya-infrastruktury">Требования к языку программирования инфраструктуры</h2>
                     <br> 
                     <p>Какие есть потребности у организаций с точки зрения развёртывания и поддержки приложений?</p>
                     <br> 
                     <ol> 
                      <li>Развёртывание сложной системы, состоящей из нескольких взаимосвязанных компонентов (сервисов/баз данных/...).</li> 
                      <li>Поддержка работы нескольких окружений, включая создание новых окружений, обновление версий компонентов и откат к предыдущим версиям.</li> 
                      <li>Поддержка нескольких конфигураций приложений (разного масштаба, разных типов баз данных, разного состава компонентов, ...).</li> 
                      <li>Быстрое развёртывание и удаление тестовых конфигураций — "эфемерные окружения". Причём для разных тестов и экспериментов могут использоваться отличающиеся конфигурации.</li> 
                     </ol>
                     <br> 
                     <p>Какие возможности языка описания инфраструктуры хотелось бы видеть?</p>
                     <br> 
                     <ol> 
                      <li><strong>Следование принципу DRY</strong> — возможность описания множества конфигураций таким образом, чтобы исключить дублирование кода.</li> 
                      <li><strong>Параметризация</strong> — возможность влиять на конфигурацию с помощью параметров.</li> 
                      <li>Возможность повторного использования элементов конфигурации.</li> 
                      <li><strong>Абстрагирование</strong> и <strong>подстановка</strong> — возможность дать имя части конфигурации и при упоминании имени подставлять содержимое.</li> 
                      <li><strong>Инкапсуляция</strong> — возможность сфокусироваться на важных параметрах с точки зрения системы и исключить из области видимости менее важные параметры.</li> 
                      <li>"<strong>Генетический</strong>" или "<strong>генеративный</strong>" подход — порождение полной конфигурации из относительно небольшого объекта. Отличается от <strong>клонирования</strong> — (aka copy-paste), при котором новая конфигурация производится путём копирования и модификации существующей.</li> 
                      <li><strong>Системный подход</strong> — система состоит из связанных между собой компонентов. Каждый компонент может представлять собой подсистему.</li> 
                     </ol>
                     <br> 
                     <h2 id="ochen-kratkoe-vvedenie-v-helm">Очень краткое введение в Helm</h2>
                     <br> 
                     <p>Helm основан на использовании существующего в языке Go механизма строковых шаблонов. Вся конфигурация разделена на две части — набор шаблонов и <code>values.yaml</code>. Внутри шаблонов имеется доступ к <code>.Values</code>, <code>.Release</code>, <code>.Chart</code>.</p>
                     <br> 
                     <p>Пример:</p>
                     <br> 
                     <pre><code class="plaintext">apiVersion: v1
kind: ConfigMap
metadata:
  name: {{ .Release.Name }}-configmap
data:
  myvalue: "Hello World"</code></pre>
                     <br> 
                     <p>Helm позиционируется также как менеджер пакетов для Kubernetes. Например, можно развернуть Postgres одной командой:</p>
                     <br> 
                     <pre><code class="plaintext">helm repo add bitnami https://charts.bitnami.com/bitnami
helm install my-postgres bitnami/postgresql</code></pre>
                     <br> 
                     <p>Более подробно с возможностями Helm можно ознакомиться в <a href="https://helm.sh/docs/" rel="nofollow noopener noreferrer">документации</a>.</p>
                     <br> 
                     <h3 id="nedostatki-helm">Недостатки Helm</h3>
                     <br> 
                     <ol> 
                      <li>Непосредственно поддерживается ровно один уровень вызова функции-шаблона. Параметры записываются в values.yaml, а затем все шаблоны вызываются с этим одним большим аргументом. (Справедливости ради следует отметить, что имеется также экзотическая и редко используемая возможность вызова функции в Lisp-стиле.)</li> 
                      <li>Несмотря на декларируемую возможность использования Library charts, пользоваться ими практически неудобно и невозможно (см.например, <a href="https://banzaicloud.com/blog/helm3-the-good-the-bad-and-the-ugly/#library-charthttpshelmshdocstopicslibrary_charts-support" rel="nofollow noopener noreferrer">Helm 3, the Good, the Bad and the Ugly</a>). По-видимому, это связано с той же причиной.</li> 
                      <li>В основе шаблонизатора лежит обработка строк без строгой типизации и без удобной возможности создания структур данных, описывающих высокоуровневые концепции.</li> 
                      <li>Собственно язык шаблонов далёк от совершенства. Любые программные конструкции заключаются в esc-последовательности — <code>{{ выражение }}</code>. А чистый текст вокруг — это просто строка-литерал, которая будет представлена в итоговом документе "как есть". Т.е. в текст вкраплены кусочки кода. Для подхода copy-paste, это должно быть удобно, но при необходимости конструировать абстракции это только мешает. Собственно <code>выражение</code> пишется на более-менее удобном функциональном языке, который, к сожалению, может порождать только текст.</li> 
                      <li>Отдельно стоит упомянуть обработку пробелов (whitespace). Этот аспект, не играющий никакой роли с точки зрения архитектуры приложения, внезапно оказывается неисчерпаемым источником трудноуловимых багов. В синтаксисе предусмотрены специальные значки-операторы для обработки пробелов, в коде регулярно встречаются специальные команды, например, <code>indent 12</code> для добавления необходимого числа пробелов. При использовании излюбленного приёма copy-paste эти команды, естественно, ломаются… </li> 
                     </ol>
                     <br> 
                     <h2 id="ochen-kratkoe-vvedenie-v-kustomize">Очень краткое введение в kustomize</h2>
                     <br> 
                     <p>Kustomize придерживается принципа <em>минимализма абстракций</em>. Исходная конфигурация представлена напрямую в виде yaml-файлов, либо генерируется другими средствами. Затем Kustomize применяет "патчи", модифицирующие конфигурацию. Патчи представляют собой yaml-файл, который накладывается поверх исходной конфигурации — "оверлей" (overlay). Также поддерживаются несколько вспомогательных инструментов-команд ("фич"), например, для генерации configMap'ов, добавления префиксов/суффиксов, добавления меток (label).</p>
                     <br> 
                     <p>Пример:</p>
                     <br> 
                     <p><code>base.yaml</code>:</p>
                     <br> 
                     <pre><code class="plaintext">apiVersion: apps/v1
kind: Deployment
spec:
  replicas: 1
...</code></pre>
                     <br> 
                     <p><code>set-replicas-to-7-patch.yaml</code>:</p>
                     <br> 
                     <pre><code class="plaintext">apiVersion: apps/v1
kind: Deployment
spec:
  replicas: 7</code></pre>
                     <br> 
                     <p><code>kustomization.yaml</code>:</p>
                     <br> 
                     <pre><code class="plaintext">bases:
- base.yaml
patches:
- set-replicas-to-7-patch.yaml</code></pre>
                     <br> 
                     <h3 id="nedostatki-kustomize">Недостатки kustomize</h3>
                     <br> 
                     <ol> 
                      <li>Продукт не является полноценным генератором манифестов. Это лишь способ внести исправления в уже сгенерированные манифесты. Для этого используются "патчи" — указания, каким образом перезаписать поле, находящееся глубоко в структуре манифестов.</li> 
                      <li>Громоздкость конструкций ("патчей"). Чтобы исправить какое-то свойство, необходимо указать полный путь до этого свойства.</li> 
                      <li>Отсутствие поддержки массивов. Например, нет простой возможности изменить количество одинаковых компонентов.</li> 
                      <li>Для реализации сложных операций требуется отдельная "фича"/трансформатор. Например, некоторое время тому назад отсутствовала возможность изменения элементов в списке. Затем была реализована новая "фича" — <a href="https://adminswerk.de/kustomize-wildcard-replace-list/" rel="nofollow noopener noreferrer">replacements</a>.</li> 
                      <li>Не "генеративный" подход, а "модифицирующий". Страдает от тех же недостатков, что и наследование. Например, при изменении базы, потребуются нетривиальные изменения во всей цепочке модификаторов.</li> 
                     </ol>
                     <br> 
                     <h2 id="kratkoe-vvedenie-v-jsonnet">Краткое введение в Jsonnet</h2>
                     <br> 
                     <p>Jsonnet — это язык программирования (на Хабре есть заметки — <a href="https://habr.com/ru/company/geekfamily/blog/256363/">Гугл предлагает усилить JSON с помощью Jsonnet</a>, <a href="https://habr.com/ru/post/483626/">Как описать 100 Gitlab джоб в 100 строк на Jsonnet</a>), который можно охарактеризовать следующими свойствами:</p>
                     <br> 
                     <ul> 
                      <li>чисто функциональный (функции — первоклассные, структуры данных неизменяемые, без побочных эффектов);</li> 
                      <li>с динамической типизацией (типы — null, булевый, вещественное число, строки, массивы, объекты, функции);</li> 
                      <li>с ленивыми вычислениями (вычисление значений откладывается как можно дальше);</li> 
                      <li>аргументы функций — позиционные и именованные, могут иметь значения по умолчанию. При вызове позиционные аргументы должны быть указаны до именованных;</li> 
                      <li>с поддержкой модулей — файлов jsonnet, включаемых (с логической точки зрения) целиком в точке импорта;</li> 
                      <li>герметичный — проект jsonnet полностью включает все элементы, которые используются в программе. Все внешние зависимости должны быть разрешены до запуска jsonnet (например, с использованием пакетного менеджера jsonnet-bundler).</li> 
                     </ul>
                     <br> 
                     <p>Совокупность этих свойств описывается дизайном языка (<a href="https://jsonnet.org/articles/design.html" rel="nofollow noopener noreferrer">https://jsonnet.org/articles/design.html</a>). </p>
                     <br> 
                     <p>Язык в первую очередь предназначен для генерации конфигураций сложных многокомпонентных систем. Конфигурации генерируются в формате JSON, YAML, INI. В частности, можно генерировать YAML-манифесты Kubernetes (а затем отправить на сервер с использованием <a href="https://tanka.dev/" rel="nofollow noopener noreferrer">Tanka</a> или <a href="https://qbec.io/" rel="nofollow noopener noreferrer">Qbec</a>). С помощью jsonnet можно полностью описать все детали сложной системы, соединить компоненты между собой требуемым образом, на основе параметров вычислить конфигурацию, которая будет обладать заданными свойствами (например, требуемой производительностью).</p>
                     <br> 
                     <p>Пример:</p>
                     <br> 
                     <pre><code class="plaintext">local Person(name='Alice') = {
  name: name,
  welcome: 'Hello ' + name + '!',
};
{
  person1: Person(),
  person2: Person('Bob'),
}</code></pre>
                     <br> 
                     <h2 id="nabor-abstrakciy-dlya-programmnyh-sistem-v-kubernetes">Набор абстракций для программных систем в Kubernetes</h2>
                     <br> 
                     <p>Гибкость Jsonnet позволяет реализовать широкий диапазон решений, отличающихся своими нефункциональными свойствами. В зависимости от выбранных абстракций, внешних параметров, именования частей системы, решения будут либо гибкими и удобными, либо жёсткими и неочевидными.</p>
                     <br> 
                     <p>В качестве концептуальной основы организации программного кода, описывающего инфраструктуру программной системы, мы будем использовать "системный подход". При этом сложная система рассматривается как совокупность компонентов, связанных между собой связями. Компоненты, в свою очередь, также являются подсистемами, состоящими из компонентов следующего уровня.</p>
                     <br> 
                     <h3 id="predstavlenie-podsistem-i-komponentov">Представление подсистем и компонентов</h3>
                     <br> 
                     <p>Каждый компонент представляется функцией, возвращающей манифесты для всей инфраструктуры, требуемой для работы этого компонента. Эту функцию удобно объявить в отдельном модуле в <code>lib/&lt;subsystem or component&gt;/main.libsonnet</code>. На вход такая функция принимает:</p>
                     <br> 
                     <ul> 
                      <li>зависимости — связи с соседними компонентами;</li> 
                      <li>метки и имена, идентифицирующие компонент в составе надсистемы;</li> 
                      <li>параметры масштаба, выраженные в терминах предметной области;</li> 
                      <li>версии образов;</li> 
                      <li>иные параметры, влияющие на развёртывание компонента.</li> 
                     </ul>
                     <br> 
                     <p>Рассмотрим эти параметры подробнее.</p>
                     <br> 
                     <h3 id="predstavlenie-zavisimostey">Представление зависимостей</h3>
                     <br> 
                     <p>Для установления связи с соседними компонентами обычно требуется ряд значений — адрес хоста, порт, учётные данные. Эти значения не являются независимыми, изменение одного значения не приведёт к переключению на другой компонент, а только лишь к ошибке. Для переключения связи на другой компонент необходимо заменить все значения сразу на другой согласованный набор.</p>
                     <br> 
                     <p>Для исключения ошибок согласованный набор значений, описывающий подключение к другому компоненту, удобно представить одной строкой — URL, именем секрета или именем configmap'а. Если подключение не содержит секретного значения (пароля/токена), то достаточно использовать URL или configmap. Если хотя бы одно значение секретное, то необходимо сохранить весь набор в secret, а для описания зависимости использовать имя секрета. </p>
                     <br> 
                     <p>Например, если необходимо представить связь с базой данных, то можно использовать имя секрета, содержащего такие поля:</p>
                     <br> 
                     <ul> 
                      <li>host — адрес хоста,</li> 
                      <li>port — порт,</li> 
                      <li>database — имя базы данных,</li> 
                      <li>user — имя пользователя,</li> 
                      <li>password — пароль,</li> 
                      <li>schema — имя схемы БД (своего рода "тип"). Позволяет убедиться, что подключение осуществляется к корректной базе данных.</li> 
                     </ul>
                     <br> 
                     <h3 id="imenovanie-komponentov">Именование компонентов</h3>
                     <br> 
                     <p>Имя компонента указывается в генерируемом манифесте в метке <code>"app.kubernetes.io/name"</code>. Так как компонент является частью системы верхнего уровня, и в одном кластере может находиться много экземпляров одного типа компонента, логичным выглядит включение имени родительской системы в качестве префикса имени компонента. Тем самым обеспечивается уникальность имён в кластере и удобная возможность понять, к какой подсистеме относится данный компонент. В Kubernetes имеется также стандартная метка <code>"app.kubernetes.io/partof"</code>, которую можно использовать для указания на родительскую систему. Для удобства обработки имён и префиксов, можно в качестве параметра передавать путь к компоненту как список имени компонента и локальных имён всех надсистем, а затем с помощью функции <code>std.join</code> получить строковое представление.</p>
                     <br> 
                     <h3 id="metki">Метки</h3>
                     <br> 
                     <p>Ключевым фактором, обеспечивающим корректную работу kubernetes, является использование меток на всех ресурсах. Метки позволяют соотнести компоненты между собой, отнести их к каким-либо подсистемам, организовать разграничение доступа, обеспечить переход на новые версии указанных систем ("выкатить", rollout), организовать автомасштабирование требуемых компонентов.</p>
                     <br> 
                     <p>Для того, чтобы все компоненты системы получили правильные и согласованные метки, необходимо формировать эти метки централизованно. Создаётся локальный модуль (в папке <code>lib/</code>), предоставляющий объект <code>systemLabels</code>, который отвечает за формирование меток на уровне текущей системы. У этого объекта должен быть соответствующая функция, порождающая такой же объект для подсистемы. Т.к. имя компонента описывается меткой и определяется положением компонента в иерархии, логично именование осуществлять с помощью этого же объекта.</p>
                     <br> 
                     <h3 id="determinirovannoe-masshtabirovanie">Детерминированное масштабирование</h3>
                     <br> 
                     <p>Kubernetes поддерживает автоматическое масштабирование (<code>HorizontalPodAutoscaler</code>) путём отслеживания параметров нагрузки. Для многих систем с переменной непредсказуемой нагрузкой такой подход к масштабированию является наилучшим. Тем не менее, сам процесс масштабирования занимает некоторое время, что может привести к отказам или задержкам, пока система не достигнет оптимального масштаба.</p>
                     <br> 
                     <p>Если нам заранее известна требуемая производительность всей системы (например, необходимо обрабатывать N запросов в секунду), то мы можем вычислить параметры масштаба для каждого компонента системы, пользуясь экспериментально определёнными коэффициентами. Тем самым система изначально при развёртывании будет иметь оптимальный масштаб. (Безусловно, следует сохранять механизм автоматического масштабирования для купирования случайных отклонений нагрузки.)</p>
                     <br> 
                     <p>Коэффициент масштаба становится ещё одним параметром уровня систем/компонентов.</p>
                     <br> 
                     <h3 id="versionirovanie-obrazov">Версионирование образов</h3>
                     <br> 
                     <p>Чтобы система функционировала стабильно и корректно, все компоненты должны использовать фиксированные версии образов, протестированные на совместимость. По-видимому, структура системы меняется реже, чем версии образов, и происходит это в значительной степени независимо. Исходя из принципа "разделения ответственности" (separation of concerns), удобно версии образов выделить в отдельный файл <code>.libsonnet</code>. В таком файле каждому типу образа будет соответствовать либо номер версии, либо полный url образа (в зависимости от того, допустимо ли указать адрес репозитория образов в виде константы).</p>
                     <br> 
                     <pre><code class="plaintext">{
  "component1": "v1.2.3",
  "component2": "1.2.3",
  "ourComponent3": "repo.example.com/path/image@2.3.4",
  "ourComponent4": importstr "file-with-image-url.txt"
}</code></pre>
                     <br> 
                     <p>Использование директивы <code>importstr</code> позволят автоматизировать выбор нового образа, полученного при локальной сборке компонента.</p>
                     <br> 
                     <p>Объект с версиями передаётся всем подсистемам и компоненам в неизменном виде, тем самым гарантируется, что все компоненты системы будут между собой совместимы.</p>
                     <br> 
                     <h1 id="zaklyuchenie">Заключение</h1>
                     <br> 
                     <p>Jsonnet обладает достаточной гибкостью, и позволяет реализовать набор крупных блоков, из которых можно строить целое семейство систем, отличающихся составом компонентов, производительностью, и другими желательными функциональными и нефункциональными свойствами, и гарантировать совместимость всех компонентов по версиям. В сравнении с популярными альтернативами (Helm, kustomize), Jsonnet даёт возможность легко реализовать концепцию эфемерных окружений, создаваемых на короткий срок для проведения каких-либо экспериментов или регресионных тестов. За счёт следования принципу DRY и ортогонального проектирования, независимые аспекты конфигураций описываются в одном экземпляре и становятся доступны во всех окружениях, где это необходимо.</p>
                    </div>
                   </div>
                  </div> <!----> <!---->
                 </div> <!----> <!---->
                </div> <!----> 
                <div class="tm-article-presenter__meta">
                 <div class="tm-separated-list tm-article-presenter__meta-list">
                  <span class="tm-separated-list__title">Теги:</span> 
                  <ul class="tm-separated-list__list">
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bk8s%5D" class="tm-tags-list__link">k8s</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BKubernetes%5D" class="tm-tags-list__link">Kubernetes</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BJsonnet%5D" class="tm-tags-list__link">Jsonnet</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%81%D0%B8%D1%81%D1%82%D0%B5%D0%BC%D0%BD%D1%8B%D0%B9%20%D0%BF%D0%BE%D0%B4%D1%85%D0%BE%D0%B4%5D" class="tm-tags-list__link">системный подход</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5Bcontinuous%20deployment%5D" class="tm-tags-list__link">continuous deployment</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5B%D1%80%D0%B0%D0%B7%D1%80%D0%B0%D0%B1%D0%BE%D1%82%D0%BA%D0%B0%20%D0%9F%D0%9E%5D" class="tm-tags-list__link">разработка ПО</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BCI%2FCD%5D" class="tm-tags-list__link">CI/CD</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/search/?target_type=posts&amp;order=relevance&amp;q=%5BDevOps%5D" class="tm-tags-list__link">DevOps</a></li>
                  </ul>
                 </div> 
                 <div class="tm-separated-list tm-article-presenter__meta-list">
                  <span class="tm-separated-list__title">Хабы:</span> 
                  <ul class="tm-separated-list__list">
                   <li class="tm-separated-list__item"><a href="/ru/hub/devops/" class="tm-hubs-list__link">DevOps</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/hub/kubernetes/" class="tm-hubs-list__link">Kubernetes</a></li>
                   <li class="tm-separated-list__item"><a href="/ru/hub/funcprog/" class="tm-hubs-list__link">Функциональное программирование</a></li>
                  </ul>
                 </div>
                </div>
               </article>
              </div> <!---->
             </div> 
             <div class="tm-article-sticky-panel">
              <div class="tm-data-icons tm-article-sticky-panel__icons">
               <div class="tm-article-rating tm-data-icons__item">
                <div class="tm-votes-meter tm-article-rating__votes-switcher">
                 <svg height="24" width="24" class="tm-svg-img tm-votes-meter__icon tm-votes-meter__icon tm-votes-meter__icon_appearance-article">
                  <title>Рейтинг</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-rating"></use>
                 </svg> <span class="tm-votes-meter__value tm-votes-meter__value tm-votes-meter__value_appearance-article tm-votes-meter__value_rating">0</span>
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div> <!----> <!----> <button title="Добавить в закладки" type="button" class="bookmarks-button tm-data-icons__item"><span class="tm-svg-icon__wrapper bookmarks-button__icon">
                 <svg height="24" width="24" class="tm-svg-img tm-svg-icon">
                  <title>Добавить в закладки</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-favorite"></use>
                 </svg></span> <span title="Количество пользователей, добавивших публикацию в закладки" class="bookmarks-button__counter"> 2 </span></button> 
               <div title="Читать комментарии" class="tm-article-comments-counter-link tm-data-icons__item">
                <a href="/ru/post/720556/comments/" class="tm-article-comments-counter-link__link">
                 <svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon">
                  <title>Комментарии</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-comments"></use>
                 </svg> <span class="tm-article-comments-counter-link__value"> 0 </span></a> <!---->
               </div> 
               <div title="Поделиться" class="tm-sharing tm-data-icons__item">
                <button type="button" class="tm-sharing__button">
                 <svg viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg" class="tm-sharing__icon">
                  <path fill="currentColor" d="M13.8 13.8V18l7.2-6.6L13.8 5v3.9C5 8.9 3 18.6 3 18.6c2.5-4.4 6-4.8 10.8-4.8z"></path>
                 </svg></button> 
                <div class="v-portal" style="display:none;"></div>
               </div> 
               <div class="v-portal" style="display:none;"></div>
              </div> 
             </div>
            </div> 
            <div class="v-portal" style="display:none;"></div> 
            <div class="tm-article-presenter__footer">
             <div class="tm-article-blocks">
              <!----> 
              <div></div> 
              <section class="tm-block tm-block tm-block_spacing-bottom">
               <!----> 
               <div class="tm-block__body tm-block__body tm-block__body_variant-balanced">
                <div class="tm-article-author"> 
                 <div class="tm-user-card tm-article-author__user-card tm-user-card tm-user-card_variant-article">
                  <div class="tm-user-card__info-container">
                   <div class="tm-user-card__header">
                    <div class="tm-user-card__header-data">
                     <a href="/ru/users/primetalk/" class="tm-user-card__userpic tm-user-card__userpic_size-40">
                      <div class="tm-entity-image">
                       <svg class="tm-svg-img tm-image-placeholder tm-image-placeholder_pink">
                        <!----> <use xlink:href="/img/megazord-v28.2b11c25e..svg#placeholder-user"></use>
                       </svg>
                      </div></a> 
                     <div class="tm-user-card__meta">
                      <div title=" 45 голосов " class="tm-counter-container tm-karma tm-karma">
                       <div class="tm-counter-container__header">
                        <div class="tm-karma__votes tm-karma__votes_positive">
                          13 
                        </div>
                       </div> 
                       <div class="tm-counter-container__footer">
                        <div class="tm-karma__text">
                          Карма 
                        </div> 
                        <div class="v-portal" style="display:none;"></div>
                       </div>
                      </div> 
                      <div title="Рейтинг пользователя" class="tm-counter-container">
                       <div class="tm-counter-container__header"> 
                        <div class="tm-votes-lever tm-votes-lever tm-votes-lever_appearance-rating">
                         <!----> 
                         <div class="tm-votes-lever__score tm-votes-lever__score tm-votes-lever__score_appearance-rating">
                          <span class="tm-votes-lever__score-counter tm-votes-lever__score-counter tm-votes-lever__score-counter_rating"> 0 </span>
                         </div> <!---->
                        </div>
                       </div> 
                       <div class="tm-counter-container__footer">
                        <span class="tm-rating__text tm-rating__text"> Рейтинг </span>
                       </div>
                      </div>
                     </div>
                    </div>
                   </div> 
                   <div class="tm-user-card__info tm-user-card__info tm-user-card__info_variant-article">
                    <div class="tm-user-card__title tm-user-card__title tm-user-card__title_variant-article">
                     <span class="tm-user-card__name tm-user-card__name tm-user-card__name_variant-article">Арсений Жижелев</span> <a href="/ru/users/primetalk/" class="tm-user-card__nickname tm-user-card__nickname tm-user-card__nickname_variant-article"> @primetalk </a> <!---->
                    </div> 
                    <p class="tm-user-card__short-info tm-user-card__short-info tm-user-card__short-info_variant-article">Пользователь</p>
                   </div>
                  </div> 
                  <div class="tm-user-card__buttons tm-user-card__buttons tm-user-card__buttons_variant-article">
                   <!----> <!----> <!----> <!----> <!---->
                  </div>
                 </div> <!---->
                </div> 
                <div class="v-portal" style="display:none;"></div>
               </div> <!---->
              </section> 
              <div class="tm-adfox-banner__container tm-page-article__banner">
               <!----> 
               <div id="adfox_164725660339535756" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-leaderboard"></div>
              </div> 
              <div class="tm-article-blocks__comments">
               <div class="tm-article-page-comments">
                <div class="tm-article-comments-counter-link tm-article-comments-counter-button">
                 <a href="/ru/post/720556/comments/" class="tm-article-comments-counter-link__link tm-article-comments-counter-link__link_button-style">
                  <svg height="24" width="24" class="tm-svg-img tm-article-comments-counter-link__icon tm-article-comments-counter-link__icon_contrasted">
                   <title>Комментарии</title> <use xlink:href="/img/megazord-v28.2b11c25e..svg#counter-comments"></use>
                  </svg> <span class="tm-article-comments-counter-link__value tm-article-comments-counter-link__value_contrasted"> Комментировать </span></a> <!---->
                </div>
               </div>
              </div> 
              <section class="tm-block tm-block tm-block_spacing-bottom">
               <header class="tm-block__header tm-block__header tm-block__header_variant-borderless">
                <div class="tm-block__header-container">
                 <h2 class="tm-block__title tm-block__title tm-block__title_variant-large">Публикации</h2> 
                </div> <!---->
               </header> 
               <div class="tm-block__body tm-block__body tm-block__body_variant-condensed-slim">
                <div class="tm-tabs tm-tabs">
                 <div>
                  <span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_active tm-tabs__tab-link_slim"> Лучшие за сутки </button></span><span class="tm-tabs__tab-item"><button class="tm-tabs__tab-link tm-tabs__tab-link tm-tabs__tab-link_slim"> Похожие </button></span>
                 </div> <!---->
                </div> 
                <div class="similar-and-daily__tab-view">
                 <div>
                  <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> 
                  <div class="tm-placeholder-article-cards">
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                   <div class="tm-placeholder-article-card">
                    <div class="tm-placeholder__user">
                     <div class="tm-placeholder__user-pic loads"></div> 
                     <div class="tm-placeholder__user-date loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__title">
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div> 
                     <div class="tm-placeholder__line tm-placeholder-article-card__title-line loads"></div>
                    </div> 
                    <div class="tm-placeholder-article-card__icons tm-placeholder__counters">
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                     <div class="tm-placeholder-data-icon">
                      <div class="tm-placeholder__icon tm-placeholder__icon_large loads"></div> 
                      <div class="tm-placeholder__line tm-placeholder__line_icon-text"></div>
                     </div>
                    </div>
                   </div>
                  </div> <!----> <!----> <!----> <!---->
                 </div> <!---->
                </div>
               </div> <!---->
              </section> 
              <div>
               <div>
                <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> 
                <div class="tm-placeholder-promo">
                 <div class="tm-placeholder-promo__header">
                  <div class="tm-placeholder__line tm-placeholder__line_promo-title"></div>
                 </div> 
                 <div class="tm-placeholder-promo__body">
                  <div class="tm-placeholder-promo__posts">
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div> 
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div> 
                   <div class="tm-placeholder-promo__post">
                    <div class="tm-placeholder-promo__image"></div> 
                    <div class="tm-placeholder__line tm-placeholder__line_post-title"></div>
                   </div>
                  </div> 
                  <div class="tm-placeholder-promo__dots">
                   <div class="tm-placeholder-promo__dot"></div> 
                   <div class="tm-placeholder-promo__dot"></div> 
                   <div class="tm-placeholder-promo__dot"></div>
                  </div>
                 </div>
                </div> <!----> <!----> <!----> <!----> <!---->
               </div>
              </div> 
              <div>
               <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> 
               <div class="tm-placeholder-inset tm-placeholder-tasks">
                <div class="tm-placeholder-inset__header">
                 <div class="tm-placeholder__line tm-placeholder__line_inset-header loads"></div>
                </div> 
                <div class="tm-placeholder-inset__body">
                 <ul class="tm-placeholder-list">
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                  <li class="tm-placeholder-list__item tm-placeholder-list__item_inset">
                   <div class="tm-placeholder-list__title-container">
                    <div class="tm-placeholder__line tm-placeholder__line_item-title loads"></div>
                   </div> 
                   <div class="tm-project-block-items__properties">
                    <span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span><span class="tm-project-block-items__property-item"><span class="tm-placeholder__line loads" style="width: 100px;"></span></span>
                   </div></li>
                 </ul>
                </div> 
                <div class="tm-placeholder-inset__footer">
                 <div class="tm-placeholder__line tm-placeholder__line_inset-footer loads"></div>
                </div>
               </div> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!----> <!---->
              </div> <!----> 
             </div>
            </div>
           </div>
          </div>
         </div> 
         <div class="tm-page__sidebar">
          <div class="tm-layout-sidebar">
           <div class="tm-layout-sidebar__ads tm-layout-sidebar__ads_initial">
            <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_top">
             <!----> 
             <div id="adfox_164725680533065327" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-half-page"></div>
            </div>
           </div> 
           <div class="tm-sexy-sidebar tm-sexy-sidebar_initial" style="margin-top:0px;">
            <!----> 
            <section data-navigatable="" tabindex="0" data-async-called="true" class="tm-block tm-stories-block tm-block tm-block_spacing-around">
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Истории</h2> 
              </div> <!---->
             </header> 
             <div class="tm-block__body tm-block__body tm-block__body_variant-equal-small">
              <div class="tm-stories-empty">
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
               <div class="tm-stories-card-empty">
                <div class="tm-stories-card-empty__image"></div> 
                <div class="tm-stories-card-empty__title">
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div> 
                 <div class="tm-stories-card-empty__title-block"></div>
                </div>
               </div>
              </div> <!---->
             </div> <!---->
            </section> 
            <section data-async-called="true" class="tm-block tm-block tm-block_spacing-around">
             <header class="tm-block__header tm-block__header">
              <div class="tm-block__header-container">
               <h2 class="tm-block__title tm-block__title">Работа</h2> 
              </div> <!---->
             </header> 
             <div class="tm-block__body tm-block__body">
              <div class="tm-vacancies-block__item">
               <a href="https://career.habr.com/vacancies/devops" target="_blank" class="tm-vacancies-block__vacancy-title"> DevOps инженер </a> 
               <div class="tm-vacancies-block__vacancies-count">
                 54 вакансии 
               </div>
              </div>
             </div> 
             <footer class="tm-block__footer">
              <a href="https://career.habr.com/catalog" class="tm-block-extralink"> Все вакансии </a>
             </footer>
            </section> 
            <div class="tm-adfox-banner__container tm-layout-sidebar__banner tm-layout-sidebar__banner_bottom">
             <!----> 
             <div id="adfox_164725691003361602" class="tm-adfox-banner tm-adfox-banner tm-adfox-banner_variant-medium-rectangle"></div>
            </div>
           </div>
          </div>
         </div>
        </div>
       </div>
      </div>
     </main> <!---->
    </div> 
    <div class="tm-footer-menu">
     <div class="tm-page-width">
      <div class="tm-footer-menu__container">
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Ваш аккаунт </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr/?back=/ru/post/720556/&amp;hl=ru" rel="nofollow" target="_self"> Войти </a></li>
          <li class="tm-footer-menu__list-item"><a href="/kek/v1/auth/habrahabr-register/?back=/ru/post/720556/&amp;hl=ru" rel="nofollow" target="_self"> Регистрация </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Разделы </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/" class="footer-menu__item-link router-link-active"> Публикации </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/news/" class="footer-menu__item-link"> Новости </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/hubs/" class="footer-menu__item-link"> Хабы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/companies/" class="footer-menu__item-link"> Компании </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/users/" class="footer-menu__item-link"> Авторы </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/sandbox/" class="footer-menu__item-link"> Песочница </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Информация </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/help/" class="footer-menu__item-link"> Устройство сайта </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/authors/codex/" class="footer-menu__item-link"> Для авторов </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/companies/corpblogs/" class="footer-menu__item-link"> Для компаний </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/docs/docs/transparency/" class="footer-menu__item-link"> Документы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/agreement" target="_blank"> Соглашение </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://account.habr.com/info/confidential/" target="_blank"> Конфиденциальность </a></li>
         </ul>
        </div>
       </div>
       <div class="tm-footer-menu__block">
        <p class="tm-footer-menu__block-title"> Услуги </p> 
        <div class="tm-footer-menu__block-content">
         <ul class="tm-footer-menu__list">
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/corporate-blogs/" target="_blank"> Корпоративный блог </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/advertising/" target="_blank"> Медийная реклама </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/native-special/" target="_blank"> Нативные проекты </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/education-programs/" target="_blank"> Образовательные программы </a></li>
          <li class="tm-footer-menu__list-item"><a href="https://company.habr.com/ru/hello-startup/" target="_blank"> Стартапам </a></li>
          <li class="tm-footer-menu__list-item"><a href="/ru/megaprojects/" class="footer-menu__item-link"> Мегапроекты </a></li>
         </ul>
        </div>
       </div>
      </div>
     </div>
    </div> 
    <div class="tm-footer">
     <div class="tm-page-width">
      <div class="tm-footer__container">
       <!----> 
       <div class="tm-footer__social">
        <a href="https://www.facebook.com/habrahabr.ru" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Facebook</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-facebook"></use>
         </svg></a><a href="https://twitter.com/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Twitter</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-twitter"></use>
         </svg></a><a href="https://vk.com/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>VK</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-vkontakte"></use>
         </svg></a><a href="https://telegram.me/habr_com" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Telegram</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-telegram"></use>
         </svg></a><a href="https://www.youtube.com/channel/UCd_sTwKqVrweTt4oAKY5y4w" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Youtube</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-youtube"></use>
         </svg></a><a href="https://zen.yandex.ru/habr" rel="nofollow noopener noreferrer" target="_blank" class="tm-svg-icon__wrapper tm-social-icons__icon">
         <svg height="16" width="16" class="tm-svg-img tm-svg-icon">
          <title>Яндекс Дзен</title> <use xlink:href="/img/social-icons-sprite.svg#social-logo-zen"></use>
         </svg></a>
       </div> 
       <div class="v-portal" style="display:none;"></div> <button class="tm-footer__link"><!----> Настройка языка </button> <a href="/ru/feedback/" class="tm-footer__link"> Техническая поддержка </a> <a href="/berserk-mode-nope" class="tm-footer__link"> Вернуться на старую версию </a> 
       <div class="tm-footer-copyright">
        <span class="tm-copyright"><span class="tm-copyright__years">© 2006–2023, </span> <span class="tm-copyright__name"><a href="https://company.habr.com/" rel="noopener" target="_blank" class="tm-copyright__link">Habr</a></span></span>
       </div>
      </div>
     </div>
    </div> <!----> <!---->
   </div> 
   <div class="vue-portal-target"></div>
  </div> 
  <script>window.__INITIAL_STATE__={"adblock":{"hasAcceptableAdsFilter":false,"hasAdblock":false},"articlesList":{"articlesList":{"720556":{"id":"720556","timePublished":"2023-03-05T15:10:25+00:00","isCorporative":false,"lang":"ru","titleHtml":"Развёртывание программных систем в Kubernetes с помощью Jsonnet","leadData":{"textHtml":"\u003Cp\u003EKubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment, secret, statefulset,… Конфигурация каждого ресурса задаётся унифицированно с помощью YAML (или JSON) манифеста. Kubernetes API и интерфейс командной строки позволяют манипулировать манифестами ресурсов, а сами ресурсы автоматически приводятся в состояние, соответствующее манифестам.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EДля формирования согласованных конфигураций ресурсов используются дополнительные технологии. Например, \u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EHelm — генерация манифестов на основе строковых шаблонов + &quot;магазин&quot; готовых компонентов (package manager).\u003C\u002Fli\u003E\r\n\u003Cli\u003EKustomize — (&quot;Kubernetes cUSTOMIZation&quot;) — донастройка манифестов путём внесения исправлений в различные свойства.\u003C\u002Fli\u003E\r\n\u003Cli\u003EJsonnet — генерация манифестов с использованием легковесного функционального языка, предназначенного для генерации JSON.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u003E\r\n\u003Cp\u003EДля синхронизации проектов, хранящихся в репозитории git, с фактическим состоянием инфраструктуры в каком-либо кластере может использоваться специальное приложение, работающее в рамках концепции GitOps, например ArgoCD. Причём поддерживаются как проекты, содержащие собственно манифесты, так и проекты, основанные на вышеперечисленных генераторах\u002Fмодификаторах.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EЭти генераторы широко применяются в различных приложениях и, в целом, позволяют решить задачи, связанные с развёртыванием инфраструктуры. Однако, имеются существенные отличия в подходах, что определяет возможности и потенциальный охват задач.\u003C\u002Fp\u003E\u003Cbr\u003E\r\n\u003Cp\u003EРассмотрим, какие требования было бы разумно предъявить к языку описания инфраструктуры. (В этой заметке излагается взгляд автора, занимающегося разработкой программного обеспечения. Другие стороны, например, команды эксплуатации, могут иметь иной взгляд на этот вопрос.)\u003C\u002Fp\u003E","imageUrl":null,"buttonTextHtml":"Читать дальше &rarr;","image":null},"editorVersion":"1.0","postType":"article","postLabels":[],"author":{"id":"483828","alias":"primetalk","fullname":"Арсений Жижелев","avatarUrl":null,"speciality":null,"scoreStats":{"score":13,"votesCount":45},"rating":0,"relatedData":null,"contacts":[],"authorContacts":[],"paymentDetails":{"paymentYandexMoney":null,"paymentPayPalMe":null,"paymentWebmoney":null}},"statistics":{"commentsCount":0,"favoritesCount":2,"readingCount":125,"score":0,"votesCount":0,"votesCountPlus":0,"votesCountMinus":0},"hubs":[{"id":"20788","alias":"devops","type":"collective","title":"DevOps","titleHtml":"DevOps","isProfiled":true,"relatedData":null},{"id":"22196","alias":"kubernetes","type":"collective","title":"Kubernetes","titleHtml":"Kubernetes","isProfiled":true,"relatedData":null},{"id":"17853","alias":"funcprog","type":"collective","title":"Функциональное программирование","titleHtml":"Функциональное программирование","isProfiled":true,"relatedData":null}],"flows":[{"id":"1","alias":"develop","title":"Разработка","titleHtml":"Разработка"},{"id":"6","alias":"admin","title":"Администрирование","titleHtml":"Администрирование"}],"relatedData":null,"textHtml":"\u003Cdiv xmlns=\"http:\u002F\u002Fwww.w3.org\u002F1999\u002Fxhtml\"\u003E\u003Cp\u003EKubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment, secret, statefulset,… Конфигурация каждого ресурса задаётся унифицированно с помощью YAML (или JSON) манифеста. Kubernetes API и интерфейс командной строки позволяют манипулировать манифестами ресурсов, а сами ресурсы автоматически приводятся в состояние, соответствующее манифестам.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля формирования согласованных конфигураций ресурсов используются дополнительные технологии. Например, \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003EHelm — генерация манифестов на основе строковых шаблонов + \"магазин\" готовых компонентов (package manager).\u003C\u002Fli\u003E\r\n\u003Cli\u003EKustomize — (\"Kubernetes cUSTOMIZation\") — донастройка манифестов путём внесения исправлений в различные свойства.\u003C\u002Fli\u003E\r\n\u003Cli\u003EJsonnet — генерация манифестов с использованием легковесного функционального языка, предназначенного для генерации JSON.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля синхронизации проектов, хранящихся в репозитории git, с фактическим состоянием инфраструктуры в каком-либо кластере может использоваться специальное приложение, работающее в рамках концепции GitOps, например ArgoCD. Причём поддерживаются как проекты, содержащие собственно манифесты, так и проекты, основанные на вышеперечисленных генераторах\u002Fмодификаторах.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЭти генераторы широко применяются в различных приложениях и, в целом, позволяют решить задачи, связанные с развёртыванием инфраструктуры. Однако, имеются существенные отличия в подходах, что определяет возможности и потенциальный охват задач.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EРассмотрим, какие требования было бы разумно предъявить к языку описания инфраструктуры. (В этой заметке излагается взгляд автора, занимающегося разработкой программного обеспечения. Другие стороны, например, команды эксплуатации, могут иметь иной взгляд на этот вопрос.)\u003C\u002Fp\u003E\u003Ca name=\"habracut\"\u003E\u003C\u002Fa\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"trebovaniya-k-yazyku-programmirovaniya-infrastruktury\"\u003EТребования к языку программирования инфраструктуры\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКакие есть потребности у организаций с точки зрения развёртывания и поддержки приложений?\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EРазвёртывание сложной системы, состоящей из нескольких взаимосвязанных компонентов (сервисов\u002Fбаз данных\u002F...).\u003C\u002Fli\u003E\r\n\u003Cli\u003EПоддержка работы нескольких окружений, включая создание новых окружений, обновление версий компонентов и откат к предыдущим версиям.\u003C\u002Fli\u003E\r\n\u003Cli\u003EПоддержка нескольких конфигураций приложений (разного масштаба, разных типов баз данных, разного состава компонентов, ...).\u003C\u002Fli\u003E\r\n\u003Cli\u003EБыстрое развёртывание и удаление тестовых конфигураций — \"эфемерные окружения\". Причём для разных тестов и экспериментов могут использоваться отличающиеся конфигурации.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКакие возможности языка описания инфраструктуры хотелось бы видеть?\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003E\u003Cstrong\u003EСледование принципу DRY\u003C\u002Fstrong\u003E — возможность описания множества конфигураций таким образом, чтобы исключить дублирование кода.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cstrong\u003EПараметризация\u003C\u002Fstrong\u003E — возможность влиять на конфигурацию с помощью параметров.\u003C\u002Fli\u003E\r\n\u003Cli\u003EВозможность повторного использования элементов конфигурации.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cstrong\u003EАбстрагирование\u003C\u002Fstrong\u003E и \u003Cstrong\u003Eподстановка\u003C\u002Fstrong\u003E — возможность дать имя части конфигурации и при упоминании имени подставлять содержимое.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cstrong\u003EИнкапсуляция\u003C\u002Fstrong\u003E — возможность сфокусироваться на важных параметрах с точки зрения системы и исключить из области видимости менее важные параметры.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\"\u003Cstrong\u003EГенетический\u003C\u002Fstrong\u003E\" или \"\u003Cstrong\u003Eгенеративный\u003C\u002Fstrong\u003E\" подход — порождение полной конфигурации из относительно небольшого объекта. Отличается от \u003Cstrong\u003Eклонирования\u003C\u002Fstrong\u003E — (aka copy-paste), при котором новая конфигурация производится путём копирования и модификации существующей.\u003C\u002Fli\u003E\r\n\u003Cli\u003E\u003Cstrong\u003EСистемный подход\u003C\u002Fstrong\u003E — система состоит из связанных между собой компонентов. Каждый компонент может представлять собой подсистему.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"ochen-kratkoe-vvedenie-v-helm\"\u003EОчень краткое введение в Helm\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EHelm основан на использовании существующего в языке Go механизма строковых шаблонов. Вся конфигурация разделена на две части — набор шаблонов и \u003Ccode\u003Evalues.yaml\u003C\u002Fcode\u003E. Внутри шаблонов имеется доступ к \u003Ccode\u003E.Values\u003C\u002Fcode\u003E, \u003Ccode\u003E.Release\u003C\u002Fcode\u003E, \u003Ccode\u003E.Chart\u003C\u002Fcode\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПример:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003EapiVersion: v1\nkind: ConfigMap\nmetadata:\n  name: {{ .Release.Name }}-configmap\ndata:\n  myvalue: \"Hello World\"\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EHelm позиционируется также как менеджер пакетов для Kubernetes. Например, можно развернуть Postgres одной командой:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003Ehelm repo add bitnami https:\u002F\u002Fcharts.bitnami.com\u002Fbitnami\nhelm install my-postgres bitnami\u002Fpostgresql\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EБолее подробно с возможностями Helm можно ознакомиться в \u003Ca href=\"https:\u002F\u002Fhelm.sh\u002Fdocs\u002F\" rel=\"nofollow noopener noreferrer\"\u003Eдокументации\u003C\u002Fa\u003E.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"nedostatki-helm\"\u003EНедостатки Helm\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EНепосредственно поддерживается ровно один уровень вызова функции-шаблона. Параметры записываются в values.yaml, а затем все шаблоны вызываются с этим одним большим аргументом. (Справедливости ради следует отметить, что имеется также экзотическая и редко используемая возможность вызова функции в Lisp-стиле.)\u003C\u002Fli\u003E\r\n\u003Cli\u003EНесмотря на декларируемую возможность использования Library charts, пользоваться ими практически неудобно и невозможно (см.например, \u003Ca href=\"https:\u002F\u002Fbanzaicloud.com\u002Fblog\u002Fhelm3-the-good-the-bad-and-the-ugly\u002F#library-charthttpshelmshdocstopicslibrary_charts-support\" rel=\"nofollow noopener noreferrer\"\u003EHelm 3, the Good, the Bad and the Ugly\u003C\u002Fa\u003E). По-видимому, это связано с той же причиной.\u003C\u002Fli\u003E\r\n\u003Cli\u003EВ основе шаблонизатора лежит обработка строк без строгой типизации и без удобной возможности создания структур данных, описывающих высокоуровневые концепции.\u003C\u002Fli\u003E\r\n\u003Cli\u003EСобственно язык шаблонов далёк от совершенства. Любые программные конструкции заключаются в esc-последовательности — \u003Ccode\u003E{{ выражение }}\u003C\u002Fcode\u003E. А чистый текст вокруг — это просто строка-литерал, которая будет представлена в итоговом документе \"как есть\". Т.е. в текст вкраплены кусочки кода. Для подхода copy-paste, это должно быть удобно, но при необходимости конструировать абстракции это только мешает. Собственно \u003Ccode\u003Eвыражение\u003C\u002Fcode\u003E пишется на более-менее удобном функциональном языке, который, к сожалению, может порождать только текст.\u003C\u002Fli\u003E\r\n\u003Cli\u003EОтдельно стоит упомянуть обработку пробелов (whitespace). Этот аспект, не играющий никакой роли с точки зрения архитектуры приложения, внезапно оказывается неисчерпаемым источником трудноуловимых багов. В синтаксисе предусмотрены специальные значки-операторы для обработки пробелов, в коде регулярно встречаются специальные команды, например, \u003Ccode\u003Eindent 12\u003C\u002Fcode\u003E для добавления необходимого числа пробелов. При использовании излюбленного приёма copy-paste эти команды, естественно, ломаются… \u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"ochen-kratkoe-vvedenie-v-kustomize\"\u003EОчень краткое введение в kustomize\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EKustomize придерживается принципа \u003Cem\u003Eминимализма абстракций\u003C\u002Fem\u003E. Исходная конфигурация представлена напрямую в виде yaml-файлов, либо генерируется другими средствами. Затем Kustomize применяет \"патчи\", модифицирующие конфигурацию. Патчи представляют собой yaml-файл, который накладывается поверх исходной конфигурации — \"оверлей\" (overlay). Также поддерживаются несколько вспомогательных инструментов-команд (\"фич\"), например, для генерации configMap'ов, добавления префиксов\u002Fсуффиксов, добавления меток (label).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПример:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ccode\u003Ebase.yaml\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003EapiVersion: apps\u002Fv1\nkind: Deployment\nspec:\n  replicas: 1\n...\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ccode\u003Eset-replicas-to-7-patch.yaml\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003EapiVersion: apps\u002Fv1\nkind: Deployment\nspec:\n  replicas: 7\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003E\u003Ccode\u003Ekustomization.yaml\u003C\u002Fcode\u003E:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003Ebases:\n- base.yaml\npatches:\n- set-replicas-to-7-patch.yaml\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"nedostatki-kustomize\"\u003EНедостатки kustomize\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Col\u003E\r\n\u003Cli\u003EПродукт не является полноценным генератором манифестов. Это лишь способ внести исправления в уже сгенерированные манифесты. Для этого используются \"патчи\" — указания, каким образом перезаписать поле, находящееся глубоко в структуре манифестов.\u003C\u002Fli\u003E\r\n\u003Cli\u003EГромоздкость конструкций (\"патчей\"). Чтобы исправить какое-то свойство, необходимо указать полный путь до этого свойства.\u003C\u002Fli\u003E\r\n\u003Cli\u003EОтсутствие поддержки массивов. Например, нет простой возможности изменить количество одинаковых компонентов.\u003C\u002Fli\u003E\r\n\u003Cli\u003EДля реализации сложных операций требуется отдельная \"фича\"\u002Fтрансформатор. Например, некоторое время тому назад отсутствовала возможность изменения элементов в списке. Затем была реализована новая \"фича\" — \u003Ca href=\"https:\u002F\u002Fadminswerk.de\u002Fkustomize-wildcard-replace-list\u002F\" rel=\"nofollow noopener noreferrer\"\u003Ereplacements\u003C\u002Fa\u003E.\u003C\u002Fli\u003E\r\n\u003Cli\u003EНе \"генеративный\" подход, а \"модифицирующий\". Страдает от тех же недостатков, что и наследование. Например, при изменении базы, потребуются нетривиальные изменения во всей цепочке модификаторов.\u003C\u002Fli\u003E\r\n\u003C\u002Fol\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"kratkoe-vvedenie-v-jsonnet\"\u003EКраткое введение в Jsonnet\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EJsonnet — это язык программирования (на Хабре есть заметки — \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fgeekfamily\u002Fblog\u002F256363\u002F\"\u003EГугл предлагает усилить JSON с помощью Jsonnet\u003C\u002Fa\u003E, \u003Ca href=\"https:\u002F\u002Fhabr.com\u002Fru\u002Fpost\u002F483626\u002F\"\u003EКак описать 100 Gitlab джоб в 100 строк на Jsonnet\u003C\u002Fa\u003E), который можно охарактеризовать следующими свойствами:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Eчисто функциональный (функции — первоклассные, структуры данных неизменяемые, без побочных эффектов);\u003C\u002Fli\u003E\r\n\u003Cli\u003Eс динамической типизацией (типы — null, булевый, вещественное число, строки, массивы, объекты, функции);\u003C\u002Fli\u003E\r\n\u003Cli\u003Eс ленивыми вычислениями (вычисление значений откладывается как можно дальше);\u003C\u002Fli\u003E\r\n\u003Cli\u003Eаргументы функций — позиционные и именованные, могут иметь значения по умолчанию. При вызове позиционные аргументы должны быть указаны до именованных;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eс поддержкой модулей — файлов jsonnet, включаемых (с логической точки зрения) целиком в точке импорта;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eгерметичный — проект jsonnet полностью включает все элементы, которые используются в программе. Все внешние зависимости должны быть разрешены до запуска jsonnet (например, с использованием пакетного менеджера jsonnet-bundler).\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EСовокупность этих свойств описывается дизайном языка (\u003Ca href=\"https:\u002F\u002Fjsonnet.org\u002Farticles\u002Fdesign.html\" rel=\"nofollow noopener noreferrer\"\u003Ehttps:\u002F\u002Fjsonnet.org\u002Farticles\u002Fdesign.html\u003C\u002Fa\u003E). \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЯзык в первую очередь предназначен для генерации конфигураций сложных многокомпонентных систем. Конфигурации генерируются в формате JSON, YAML, INI. В частности, можно генерировать YAML-манифесты Kubernetes (а затем отправить на сервер с использованием \u003Ca href=\"https:\u002F\u002Ftanka.dev\u002F\" rel=\"nofollow noopener noreferrer\"\u003ETanka\u003C\u002Fa\u003E или \u003Ca href=\"https:\u002F\u002Fqbec.io\u002F\" rel=\"nofollow noopener noreferrer\"\u003EQbec\u003C\u002Fa\u003E). С помощью jsonnet можно полностью описать все детали сложной системы, соединить компоненты между собой требуемым образом, на основе параметров вычислить конфигурацию, которая будет обладать заданными свойствами (например, требуемой производительностью).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EПример:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003Elocal Person(name='Alice') = {\n  name: name,\n  welcome: 'Hello ' + name + '!',\n};\n{\n  person1: Person(),\n  person2: Person('Bob'),\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Ch2 id=\"nabor-abstrakciy-dlya-programmnyh-sistem-v-kubernetes\"\u003EНабор абстракций для программных систем в Kubernetes\u003C\u002Fh2\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EГибкость Jsonnet позволяет реализовать широкий диапазон решений, отличающихся своими нефункциональными свойствами. В зависимости от выбранных абстракций, внешних параметров, именования частей системы, решения будут либо гибкими и удобными, либо жёсткими и неочевидными.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EВ качестве концептуальной основы организации программного кода, описывающего инфраструктуру программной системы, мы будем использовать \"системный подход\". При этом сложная система рассматривается как совокупность компонентов, связанных между собой связями. Компоненты, в свою очередь, также являются подсистемами, состоящими из компонентов следующего уровня.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"predstavlenie-podsistem-i-komponentov\"\u003EПредставление подсистем и компонентов\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКаждый компонент представляется функцией, возвращающей манифесты для всей инфраструктуры, требуемой для работы этого компонента. Эту функцию удобно объявить в отдельном модуле в \u003Ccode\u003Elib\u002F&lt;subsystem or component\u003E\u002Fmain.libsonnet\u003C\u002Fcode\u003E. На вход такая функция принимает:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Eзависимости — связи с соседними компонентами;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eметки и имена, идентифицирующие компонент в составе надсистемы;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eпараметры масштаба, выраженные в терминах предметной области;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eверсии образов;\u003C\u002Fli\u003E\r\n\u003Cli\u003Eиные параметры, влияющие на развёртывание компонента.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EРассмотрим эти параметры подробнее.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"predstavlenie-zavisimostey\"\u003EПредставление зависимостей\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля установления связи с соседними компонентами обычно требуется ряд значений — адрес хоста, порт, учётные данные. Эти значения не являются независимыми, изменение одного значения не приведёт к переключению на другой компонент, а только лишь к ошибке. Для переключения связи на другой компонент необходимо заменить все значения сразу на другой согласованный набор.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля исключения ошибок согласованный набор значений, описывающий подключение к другому компоненту, удобно представить одной строкой — URL, именем секрета или именем configmap'а. Если подключение не содержит секретного значения (пароля\u002Fтокена), то достаточно использовать URL или configmap. Если хотя бы одно значение секретное, то необходимо сохранить весь набор в secret, а для описания зависимости использовать имя секрета. \u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EНапример, если необходимо представить связь с базой данных, то можно использовать имя секрета, содержащего такие поля:\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cul\u003E\r\n\u003Cli\u003Ehost — адрес хоста,\u003C\u002Fli\u003E\r\n\u003Cli\u003Eport — порт,\u003C\u002Fli\u003E\r\n\u003Cli\u003Edatabase — имя базы данных,\u003C\u002Fli\u003E\r\n\u003Cli\u003Euser — имя пользователя,\u003C\u002Fli\u003E\r\n\u003Cli\u003Epassword — пароль,\u003C\u002Fli\u003E\r\n\u003Cli\u003Eschema — имя схемы БД (своего рода \"тип\"). Позволяет убедиться, что подключение осуществляется к корректной базе данных.\u003C\u002Fli\u003E\r\n\u003C\u002Ful\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"imenovanie-komponentov\"\u003EИменование компонентов\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EИмя компонента указывается в генерируемом манифесте в метке \u003Ccode\u003E\"app.kubernetes.io\u002Fname\"\u003C\u002Fcode\u003E. Так как компонент является частью системы верхнего уровня, и в одном кластере может находиться много экземпляров одного типа компонента, логичным выглядит включение имени родительской системы в качестве префикса имени компонента. Тем самым обеспечивается уникальность имён в кластере и удобная возможность понять, к какой подсистеме относится данный компонент. В Kubernetes имеется также стандартная метка \u003Ccode\u003E\"app.kubernetes.io\u002Fpartof\"\u003C\u002Fcode\u003E, которую можно использовать для указания на родительскую систему. Для удобства обработки имён и префиксов, можно в качестве параметра передавать путь к компоненту как список имени компонента и локальных имён всех надсистем, а затем с помощью функции \u003Ccode\u003Estd.join\u003C\u002Fcode\u003E получить строковое представление.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"metki\"\u003EМетки\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКлючевым фактором, обеспечивающим корректную работу kubernetes, является использование меток на всех ресурсах. Метки позволяют соотнести компоненты между собой, отнести их к каким-либо подсистемам, организовать разграничение доступа, обеспечить переход на новые версии указанных систем (\"выкатить\", rollout), организовать автомасштабирование требуемых компонентов.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EДля того, чтобы все компоненты системы получили правильные и согласованные метки, необходимо формировать эти метки централизованно. Создаётся локальный модуль (в папке \u003Ccode\u003Elib\u002F\u003C\u002Fcode\u003E), предоставляющий объект \u003Ccode\u003EsystemLabels\u003C\u002Fcode\u003E, который отвечает за формирование меток на уровне текущей системы. У этого объекта должен быть соответствующая функция, порождающая такой же объект для подсистемы. Т.к. имя компонента описывается меткой и определяется положением компонента в иерархии, логично именование осуществлять с помощью этого же объекта.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"determinirovannoe-masshtabirovanie\"\u003EДетерминированное масштабирование\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EKubernetes поддерживает автоматическое масштабирование (\u003Ccode\u003EHorizontalPodAutoscaler\u003C\u002Fcode\u003E) путём отслеживания параметров нагрузки. Для многих систем с переменной непредсказуемой нагрузкой такой подход к масштабированию является наилучшим. Тем не менее, сам процесс масштабирования занимает некоторое время, что может привести к отказам или задержкам, пока система не достигнет оптимального масштаба.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЕсли нам заранее известна требуемая производительность всей системы (например, необходимо обрабатывать N запросов в секунду), то мы можем вычислить параметры масштаба для каждого компонента системы, пользуясь экспериментально определёнными коэффициентами. Тем самым система изначально при развёртывании будет иметь оптимальный масштаб. (Безусловно, следует сохранять механизм автоматического масштабирования для купирования случайных отклонений нагрузки.)\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EКоэффициент масштаба становится ещё одним параметром уровня систем\u002Fкомпонентов.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch3 id=\"versionirovanie-obrazov\"\u003EВерсионирование образов\u003C\u002Fh3\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EЧтобы система функционировала стабильно и корректно, все компоненты должны использовать фиксированные версии образов, протестированные на совместимость. По-видимому, структура системы меняется реже, чем версии образов, и происходит это в значительной степени независимо. Исходя из принципа \"разделения ответственности\" (separation of concerns), удобно версии образов выделить в отдельный файл \u003Ccode\u003E.libsonnet\u003C\u002Fcode\u003E. В таком файле каждому типу образа будет соответствовать либо номер версии, либо полный url образа (в зависимости от того, допустимо ли указать адрес репозитория образов в виде константы).\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cpre\u003E\u003Ccode class=\"plaintext\"\u003E{\n  \"component1\": \"v1.2.3\",\n  \"component2\": \"1.2.3\",\n  \"ourComponent3\": \"repo.example.com\u002Fpath\u002Fimage@2.3.4\",\n  \"ourComponent4\": importstr \"file-with-image-url.txt\"\n}\u003C\u002Fcode\u003E\u003C\u002Fpre\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EИспользование директивы \u003Ccode\u003Eimportstr\u003C\u002Fcode\u003E позволят автоматизировать выбор нового образа, полученного при локальной сборке компонента.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EОбъект с версиями передаётся всем подсистемам и компоненам в неизменном виде, тем самым гарантируется, что все компоненты системы будут между собой совместимы.\u003C\u002Fp\u003E\u003Cbr\u002F\u003E\r\n\u003Ch1 id=\"zaklyuchenie\"\u003EЗаключение\u003C\u002Fh1\u003E\u003Cbr\u002F\u003E\r\n\u003Cp\u003EJsonnet обладает достаточной гибкостью, и позволяет реализовать набор крупных блоков, из которых можно строить целое семейство систем, отличающихся составом компонентов, производительностью, и другими желательными функциональными и нефункциональными свойствами, и гарантировать совместимость всех компонентов по версиям. В сравнении с популярными альтернативами (Helm, kustomize), Jsonnet даёт возможность легко реализовать концепцию эфемерных окружений, создаваемых на короткий срок для проведения каких-либо экспериментов или регресионных тестов. За счёт следования принципу DRY и ортогонального проектирования, независимые аспекты конфигураций описываются в одном экземпляре и становятся доступны во всех окружениях, где это необходимо.\u003C\u002Fp\u003E\u003C\u002Fdiv\u003E","tags":[{"titleHtml":"k8s"},{"titleHtml":"Kubernetes"},{"titleHtml":"Jsonnet"},{"titleHtml":"системный подход"},{"titleHtml":"continuous deployment"},{"titleHtml":"разработка ПО"},{"titleHtml":"CI\u002FCD"},{"titleHtml":"DevOps"}],"metadata":{"stylesUrls":[],"scriptUrls":[],"shareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F720556\u002F18d347438fae4f447c2a5f46f4187372\u002F","shareImageWidth":1200,"shareImageHeight":630,"vkShareImageUrl":"https:\u002F\u002Fhabr.com\u002Fshare\u002Fpublication\u002F720556\u002F18d347438fae4f447c2a5f46f4187372\u002F?format=vk","schemaJsonLd":"{\"@context\":\"http:\\\u002F\\\u002Fschema.org\",\"@type\":\"Article\",\"mainEntityOfPage\":{\"@type\":\"WebPage\",\"@id\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F720556\\\u002F\"},\"headline\":\"Развёртывание программных систем в Kubernetes с помощью Jsonnet\",\"datePublished\":\"2023-03-05T18:10:25+03:00\",\"dateModified\":\"2023-03-05T18:38:25+03:00\",\"author\":{\"@type\":\"Person\",\"name\":\"Арсений Жижелев\"},\"publisher\":{\"@type\":\"Organization\",\"name\":\"Habr\",\"logo\":{\"@type\":\"ImageObject\",\"url\":\"https:\\\u002F\\\u002Fhabrastorage.org\\\u002Fwebt\\\u002Fa_\\\u002Flk\\\u002F9m\\\u002Fa_lk9mjkccjox-zccjrpfolmkmq.png\"}},\"description\":\"Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескол...\",\"url\":\"https:\\\u002F\\\u002Fhabr.com\\\u002Fru\\\u002Fpost\\\u002F720556\\\u002F#post-content-body\",\"about\":[\"h_devops\",\"h_kubernetes\",\"h_funcprog\",\"f_develop\",\"f_admin\"],\"image\":[\"https:\\\u002F\\\u002Fhabr.com\\\u002Fshare\\\u002Fpublication\\\u002F720556\\\u002F18d347438fae4f447c2a5f46f4187372\\\u002F\"]}","metaDescription":"Kubernetes (k8s) является де-факто стандартом для развёртывания приложений. В терминах K8s приложение представляет собой набор сконфигурированных ресурсов нескольких типов — pod, service, deployment,...","mainImageUrl":null,"amp":false,"customTrackerLinks":[]},"polls":[],"commentsEnabled":true,"rulesRemindEnabled":false,"votesEnabled":true,"status":"published","plannedPublishTime":null,"checked":null,"hasPinnedComments":false,"format":"opinion","readingTime":10,"complexity":"medium","isEditorial":false}},"articlesIds":{},"isLoading":false,"pagesCount":{},"route":{},"reasonsList":null,"view":"cards","lastVisitedRoute":{},"ssrCommentsArticleIds":[""],"karma":{"userReasonsList":null}},"authorContribution":{"authors":{}},"betaTest":{"currentAnnouncement":null,"announcements":{},"announcementCards":null,"announcementComments":{},"announcementCommentThreads":{},"announcementCommentingStatuses":{},"archivedList":[]},"authorStatistics":{"articleRefs":{},"articleIds":{},"pagesCount":{},"route":{},"viewsCount":[],"maxStatsCount":{}},"career":{"seoLandings":[{"title":"DevOps инженер","vacanciesCount":54,"itemUrl":"https:\u002F\u002Fcareer.habr.com\u002Fvacancies\u002Fdevops","itemHubs":["devops","build_automation","sys_admin","virtualization","kubernetes"]}],"hubs":"devops,kubernetes,funcprog"},"comments":{"articleComments":{},"articlePinnedComments":{},"searchCommentsResults":null,"pagesCount":null,"commentAccess":{},"scrollParents":{},"pageArticleComments":{"lastViewedComment":0,"postId":null,"lastCommentTimestamp":"","moderated":[],"moderatedIds":[],"commentRoute":""}},"companies":{"companyRefs":{},"companyIds":{},"companyTopIds":{},"pagesCount":{},"companyProfiles":{},"companiesCategories":[],"companiesCategoriesTotalCount":0,"companiesWidgets":{},"companiesWorkers":{},"companiesFans":{},"route":{},"isLoading":false,"companyWorkersLoading":false,"companyFansLoading":false,"vacancies":{},"companiesGalleries":{},"companiesBanners":{},"companiesLandingVacancies":{},"companiesTechnologies":{},"workplaceInfo":null},"companyAdmin":{"companyInfo":null,"companyInfoLoading":false,"faqArticles":null,"brandingPreviewImageUrl":null,"jivoStatus":0,"adminNotifications":null},"companiesContribution":{"hubs":{},"flows":{},"companyRefs":{}},"companyHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"conversation":{"messages":[],"respondent":null,"isLoadMore":false},"conversations":{"conversations":[],"unreadCount":0,"pagesCount":0},"desktopState":{"desktopFl":null,"desktopHl":null,"isChecked":false,"isLoginDemanded":false},"docs":{"menu":{},"articles":{},"mainMenu":[],"loading":{"main":false,"dropdown":false,"article":false}},"feature":{"isProbablyVisible":true},"flows":{"updates":{"countNewPostsBySubscription":null,"countNewPostsAll":30,"countNewNewsAll":10},"flows":[{"alias":"develop","id":"1","route":{"name":"FLOW_PAGE","params":{"flowName":"develop"}}},{"alias":"admin","id":"6","route":{"name":"FLOW_PAGE","params":{"flowName":"admin"}}},{"alias":"design","id":"2","route":{"name":"FLOW_PAGE","params":{"flowName":"design"}}},{"alias":"management","id":"3","route":{"name":"FLOW_PAGE","params":{"flowName":"management"}}},{"alias":"marketing","id":"4","route":{"name":"FLOW_PAGE","params":{"flowName":"marketing"}}},{"alias":"popsci","id":"7","route":{"name":"FLOW_PAGE","params":{"flowName":"popsci"}}}]},"global":{"isPwa":false,"device":"desktop","isHabrCom":true},"hubs":{"hubRefs":{},"hubIds":{},"pagesCount":{},"isLoading":false,"route":{}},"hubsBlock":{"hubRefs":{},"hubIds":{}},"i18n":{"fl":"ru","hl":"ru"},"info":{"infoPage":{},"isLoading":true},"location":{"urlStruct":{"protocol":null,"slashes":null,"auth":null,"host":null,"port":null,"hostname":null,"hash":null,"search":null,"query":{},"pathname":null,"path":null,"href":""}},"me":{"user":null,"uuid":null,"ppgDemanded":false,"karmaResetInfo":{"canReincarnate":null,"wasReincarnated":null,"currentScore":null},"notes":null},"modal":{"modals":[]},"mostReadingList":{"mostReadingListIds":[],"mostReadingListRefs":null,"promoPost":null},"ppa":{"articles":{},"card":null,"transactions":null,"totalTransactions":null,"isAccessible":null},"projectsBlocks":{"activeBlocks":{"tasks":"project-block-article"}},"promoData":{"isLoading":false,"hasLoaded":false,"featurer":null,"megaposts":null,"promoLinks":null,"promoPosts":null},"pullRefresh":{"shouldRefresh":false},"sandbox":{"articleIds":[],"articleRefs":{},"pagesCount":null,"route":{},"lastVisitedRoute":{},"isLoading":false},"search":{"searchQueryError":null},"settingsOther":{"inputs":{"uiLang":{"errors":[],"ref":null,"value":""},"articlesLangEnglish":{"errors":[],"ref":null,"value":false},"articlesLangRussian":{"errors":[],"ref":null,"value":false},"agreement":{"errors":[],"ref":null,"value":false},"email":{"errors":[],"ref":null,"value":true},"digest":{"errors":[],"ref":null,"value":true}}},"similarList":{"similarListIds":[],"similarListRefs":null},"ssr":{"error":null,"isDataLoaded":false,"isDataLoading":false,"isHydrationFailed":false,"isServer":false},"stories":{"stories":[{"id":"story-274","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F386\u002F1a0\u002F577\u002F3861a057738e4cf78f3fc173d952c827.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Топ-7 годноты из блогов компаний","lang":"ru","startTime":"2023-03-02T11:00:00+03:00","finishTime":"2023-03-07T10:15:00+03:00","slides":[{"id":"story-274_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F52c\u002F81a\u002Fe91\u002F52c81ae913532c5df7e90245845ce07c.png","button":null},{"id":"story-274_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff9b\u002Fc65\u002Ff9a\u002Ff9bc65f9a46ebd95a3babce143e6770a.jpg","button":{"title":"Клавиатурный зоопарк","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fcloud4y\u002Fblog\u002F716934\u002F","colorType":"light"}},{"id":"story-274_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa77\u002F2d7\u002Fb4e\u002Fa772d7b4e782a580cf72c5c996514a1f.jpg","button":{"title":"Три приёмника","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F716988\u002F","colorType":"light"}},{"id":"story-274_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F78c\u002Fb59\u002F01c\u002F78cb5901c06e97ec94f07bfd6ca12a68.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fruvds\u002Fblog\u002F716058\u002F","colorType":"dark"}},{"id":"story-274_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbe2\u002Fa46\u002F500\u002Fbe2a4650077735388744eb7d2e1ef7dd.jpg","button":{"title":"Очумелые ручки","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fselectel\u002Fblog\u002F718134\u002F","colorType":"dark"}},{"id":"story-274_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F7f1\u002F18d\u002F8e3\u002F7f118d8e3f6fc09179c73dde840dd425.jpg","button":{"title":"Узнать причины","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Ftimeweb\u002Fblog\u002F713220\u002F","colorType":"light"}},{"id":"story-274_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F028\u002F038\u002F9f5\u002F0280389f5fb85f9f821fa45ccbaa8803.jpg","button":{"title":"Как это сделать","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fcloud4y\u002Fblog\u002F717342\u002F","colorType":"light"}},{"id":"story-274_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcb0\u002F02d\u002F7c4\u002Fcb002d7c42c03e59d7f124f10cbe4b4d.jpg","button":{"title":"Нырнуть в сеть","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fsouthbridge\u002Fblog\u002F717634\u002F","colorType":"dark"}}]},{"id":"story-272","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F82b\u002Fdd7\u002F7d8\u002F82bdd77d8ef7304d3b1b599191c2bb1c.png","title":"Сезоны Хабра","link":"https:\u002F\u002Fu.habr.com\u002F5P6i7"},"title":"Открыт сезон ML","lang":"ru","startTime":"2023-03-02T09:00:41+03:00","finishTime":"2023-03-31T20:53:00+03:00","slides":[{"id":"story-272_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F27f\u002Fd3a\u002Fddf\u002F27fd3addfe06da09592bdcf61db15795.jpg","button":null},{"id":"story-272_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F935\u002F582\u002F992\u002F935582992e378add33c898451b2a0d9f.jpg","button":null},{"id":"story-272_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe13\u002Feb8\u002Fa24\u002Fe13eb8a24b60622d3da72fd6e7ed3fda.jpg","button":null},{"id":"story-272_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa85\u002F83f\u002F5cc\u002Fa8583f5ccfae747135343f0e68c84112.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002F5P6i7","colorType":"light"}},{"id":"story-272_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F60d\u002F1cb\u002F98c\u002F60d1cb98cdd42d2696ebc0ec54740a23.jpg","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002F5P6i7","colorType":"light"}}]},{"id":"story-118","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fjh\u002F3n\u002Fhy\u002Fjh3nhyovspbtyqndibvbttgsprc.png","title":"Хабр Новости","link":"https:\u002F\u002Fu.habr.com\u002FcvdBy"},"title":"Лучшие фотографии «Джеймса Уэбба» за год","lang":"ru","startTime":"2023-03-01T11:00:00+03:00","finishTime":"2023-03-05T23:59:00+03:00","slides":[{"id":"story-118_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fml\u002Fcn\u002Fqx\u002Fmlcnqxuawiz09l-viwmfzybgesw.png","button":null},{"id":"story-118_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvn\u002F7g\u002Fqt\u002Fvn7gqtssznilh0-zkjmgyq25vpo.png","button":null},{"id":"story-118_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fzg\u002Fi-\u002F1y\u002Fzgi-1ysesbd_givgtouinc97tby.png","button":null},{"id":"story-118_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fvm\u002Frz\u002F_v\u002Fvmrz_vbuvvaj8gsheuhwscrlt8c.png","button":null},{"id":"story-118_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fmq\u002Fs5\u002Fgk\u002Fmqs5gkpfk-iijv2gnlud3huxgpo.png","button":null},{"id":"story-118_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002F93\u002Fuv\u002Fxb\u002F93uvxboezmintyjwjgb5vrf1zcm.png","button":null},{"id":"story-118_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fu4\u002Fdy\u002Fcd\u002Fu4dycdmg1jiinbfztn3zkpocne0.png","button":null},{"id":"story-118_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Ffy\u002Fqr\u002Flg\u002Ffyqrlgev36v3pa3-zy8maak8ipe.png","button":null},{"id":"story-118_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fwebt\u002Fx7\u002Fx8\u002Ftf\u002Fx7x8tfe8l1ahi_zmusdmtp0b_sy.png","button":{"title":"Подробности","link":"https:\u002F\u002Fu.habr.com\u002FcvdBy","colorType":"light"}}]},{"id":"story-264","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcbd\u002Fe44\u002F753\u002Fcbde44753048ff6655f9f33752fd816a.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002FnTaXn"},"title":"Cколько тратят в IT: сеньор бэкендер","lang":"ru","startTime":"2023-02-28T15:50:00+03:00","finishTime":"2023-03-07T23:59:00+03:00","slides":[{"id":"story-264_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd99\u002Ff45\u002Ff14\u002Fd99f45f14dc03b2394a86f50f76844f4.png","button":null},{"id":"story-264_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F0e3\u002F529\u002F607\u002F0e3529607bca82d7b8214d422f20ab67.png","button":null},{"id":"story-264_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8ae\u002F39e\u002Fa4f\u002F8ae39ea4fd82c27289b24594adf3c0c0.png","button":null},{"id":"story-264_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F971\u002F361\u002Fd57\u002F971361d574204d51ffe35d8c9cfef943.png","button":null},{"id":"story-264_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F342\u002F5c0\u002Fee7\u002F3425c0ee73301cff942e3d9276ce4a79.png","button":{"title":"Подробности","link":"https:\u002F\u002Fu.habr.com\u002FnTaXn","colorType":"dark"}}]},{"id":"story-262","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F2fa\u002Fc8a\u002Fba8\u002F2fac8aba82b995297abea595da7990d1.png","title":"Хабр","link":"https:\u002F\u002Fhabr.com\u002Fru\u002Fcompany\u002Fhabr\u002Fblog\u002F"},"title":"Наука сна","lang":"ru","startTime":"2023-02-28T12:15:00+03:00","finishTime":"2023-03-15T23:59:00+03:00","slides":[{"id":"story-262_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa90\u002F725\u002F61c\u002Fa9072561c280c46933ff54fd8702cade.jpg","button":null},{"id":"story-262_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffd7\u002F658\u002F956\u002Ffd7658956ea825b1c317c7f688c48058.jpg","button":{"title":"Читать лекцию","link":"https:\u002F\u002Fu.habr.com\u002Fson01","colorType":"light"}},{"id":"story-262_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F366\u002Fd2e\u002F707\u002F366d2e70725209177fa82a4119139c86.jpg","button":{"title":"При чём же?","link":"https:\u002F\u002Fu.habr.com\u002Fson02","colorType":"light"}},{"id":"story-262_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4bd\u002F40f\u002F731\u002F4bd40f731bfbf571a709dd2f357f06b4.jpg","button":{"title":"Заглянуть в дневник","link":"https:\u002F\u002Fu.habr.com\u002Fson03","colorType":"light"}},{"id":"story-262_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F944\u002F7ad\u002Fe2f\u002F9447ade2f38c3c36790be75bf4462047.jpg","button":{"title":"Последствия","link":"https:\u002F\u002Fu.habr.com\u002Fson04","colorType":"light"}},{"id":"story-262_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F74c\u002Fce1\u002F4dc\u002F74cce14dc903b245dca90df3f2747abb.jpg","button":{"title":"Смотреть список","link":"https:\u002F\u002Fu.habr.com\u002Fson05","colorType":"light"}},{"id":"story-262_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbc9\u002Fa62\u002F9f0\u002Fbc9a629f0c5ef2027cf7796749a06914.jpg","button":{"title":"Следы в истории","link":"https:\u002F\u002Fu.habr.com\u002Fson06","colorType":"light"}},{"id":"story-262_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F085\u002F0ee\u002F868\u002F0850ee868132e1ec4ec3b24caf7e719a.jpg","button":{"title":"Что придумали?","link":"https:\u002F\u002Fu.habr.com\u002Fson07","colorType":"light"}}]},{"id":"story-252","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff19\u002F48d\u002Fd15\u002Ff1948dd155701f88d36e11387c1660ef.png","title":"Geek Travel","link":"https:\u002F\u002Fu.habr.com\u002F9TZjL"},"title":"Где искать северное сияние в России","lang":"ru","startTime":"2023-02-21T11:35:00+03:00","finishTime":"2023-03-12T11:22:00+03:00","slides":[{"id":"story-252_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F506\u002F188\u002F83b\u002F50618883bc97ce517531018d3290d961.jpg","button":{"title":"К посту","link":"https:\u002F\u002Fu.habr.com\u002F9TZjL","colorType":"light"}},{"id":"story-252_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fe42\u002Fa71\u002Fe8e\u002Fe42a71e8eb5583814647f5ad55f9e0ae.jpg","button":null},{"id":"story-252_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F685\u002Fdbe\u002F4ff\u002F685dbe4ffe3940eca28ede7406898846.jpg","button":null},{"id":"story-252_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F383\u002F63b\u002F1f4\u002F38363b1f459d5daace0e4502f0780737.jpg","button":null},{"id":"story-252_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F32b\u002F665\u002F0c4\u002F32b6650c448d698b9ca4dba128afb56e.jpg","button":null},{"id":"story-252_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F95e\u002F0b2\u002F5be\u002F95e0b25be55ae919dbebbac6142e670d.jpg","button":null},{"id":"story-252_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F616\u002F1d4\u002Ff84\u002F6161d4f849be8d4e4aeee88ea2e3d572.jpg","button":null}]},{"id":"story-246","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fc41\u002F8cc\u002Fca9\u002Fc418ccca924faf05c11530c5071e627b.png","title":"Хабр Карьера","link":"https:\u002F\u002Fu.habr.com\u002Fitzp2022-new"},"title":"Зарплаты в IT во второй половине 2022","lang":"ru","startTime":"2023-02-20T11:05:00+03:00","finishTime":"2023-03-05T23:59:00+03:00","slides":[{"id":"story-246_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbe2\u002F07d\u002F19f\u002Fbe207d19f3cdc4b89e3618025c071ea0.png","button":null},{"id":"story-246_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fcda\u002F93e\u002Fed7\u002Fcda93eed762714814ddfc51c4712f4ed.png","button":null},{"id":"story-246_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fb8a\u002Fde4\u002F87f\u002Fb8ade487fa6556af459e032adebf852d.png","button":null},{"id":"story-246_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F8f6\u002Fb32\u002F844\u002F8f6b328448ed968a18a60a0cd745bd34.png","button":{"title":"Подробнее","link":"https:\u002F\u002Fu.habr.com\u002Fitzp2022-new","colorType":"dark"}}]},{"id":"story-152","author":{"logo":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fa49\u002F0d3\u002F609\u002Fa490d3609f29b6dfc53a7b88ab47ca64.png","title":"Хабр","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa"},"title":"Сеньоры — очень странные люди","lang":"ru","startTime":"2023-01-23T11:00:00+03:00","finishTime":"2023-03-31T23:59:00+03:00","slides":[{"id":"story-152_1","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbbb\u002F901\u002F063\u002Fbbb9010630ae483ed1f41ec4e2572c13.png","button":null},{"id":"story-152_2","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F4f8\u002F66c\u002F14f\u002F4f866c14f0ca8999334438d7f17c0e3a.png","button":null},{"id":"story-152_3","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F6b9\u002Fa07\u002Fa61\u002F6b9a07a612df213ac3a1c179301828df.png","button":null},{"id":"story-152_4","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ff6b\u002Fadb\u002Fb99\u002Ff6badbb9969d7e34ef4f7492767c6a77.png","button":null},{"id":"story-152_5","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fd9c\u002F9ac\u002F878\u002Fd9c9ac878bec5b494699e0080dd2e813.png","button":null},{"id":"story-152_6","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fdb1\u002Faf9\u002Fc3b\u002Fdb1af9c3bb557f6cee698cf67610f977.png","button":null},{"id":"story-152_7","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002F5cf\u002Fbed\u002F65b\u002F5cfbed65bd20b7051b1aac2b9d6e807e.png","button":null},{"id":"story-152_8","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Ffa8\u002F251\u002F4a9\u002Ffa82514a9471cd455339e97178d8c021.png","button":null},{"id":"story-152_9","image":"https:\u002F\u002Fhabrastorage.org\u002Fgetpro\u002Fhabr\u002Fupload_files\u002Fbd5\u002F901\u002Fe95\u002Fbd5901e952d9cf638355a3cc8b0c0911.png","button":{"title":"Хочу помочь джуну","link":"https:\u002F\u002Fu.habr.com\u002Fstory_HiM-anketa","colorType":"light"}}]}]},"technotext":{"years":[],"technotextDocForNominees":null,"technotextDocForWinners":null,"technotextInfo":{},"technotextInfoLoading":false,"technotextWinners":{},"technotextWinnersLoading":false},"userHubsContribution":{"contributionRefs":{"hubRefs":{},"hubIds":{}}},"userInvites":{"availableInvites":0,"usedInvitesIds":[],"usedInvitesRefs":{},"usedInvitesPagesCount":0,"unusedInvitesIds":[],"unusedInvitesRefs":{},"unusedInvitesPagesCount":0},"userVotes":{"karmaVotesList":[],"karmaVotesPagesCount":null,"karmaVotesListLoading":false,"commentsVotesList":[],"commentsVotesPagesCount":null,"commentsVotesListLoading":false,"postsVotesList":[],"postsVotesPagesCount":null,"postsVotesListLoading":false,"userVotesList":[],"userVotesPagesCount":null,"userVotesListLoading":false},"users":{"authorRefs":{},"authorIds":{},"pagesCount":{},"authorProfiles":{},"userHubs":{},"userInvitations":{},"authorFollowers":{},"authorFollowed":{},"userSpecialization":{},"karmaStats":[],"statistics":null,"isLoading":false,"authorFollowersLoading":false,"authorFollowedLoading":false,"userHubsLoading":false,"userInvitationsLoading":false,"route":{}},"viewport":{"prevScrollY":{},"scrollY":0,"width":0},"tracker":{"items":{},"pagesCache":{},"markedViewedSilently":{},"markedRead":{},"unreadCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null},"unviewedCounters":{"applications":null,"system":null,"mentions":null,"subscribers":null,"posts_and_comments":null}}};(function(){var s;(s=document.currentScript||document.scripts[document.scripts.length-1]).parentNode.removeChild(s);}());</script> 
  <script src="https://assets.habr.com/habr-web/js/chunk-vendors.129fcbcb.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/7298.c8f1d73c.js" defer></script>
  <script src="https://assets.habr.com/habr-web/js/app.8a380906.js" defer></script> 
  <script async src="https://www.googletagmanager.com/gtag/js?id=UA-726094-1"></script> 
  <script>
      window.dataLayer = window.dataLayer || [];
      function gtag(){dataLayer.push(arguments);}
      gtag('js', new Date());
    </script> 
  <script type="text/javascript">
    (function(m,e,t,r,i,k,a){m[i]=m[i]||function(){(m[i].a=m[i].a||[]).push(arguments)};
    m[i].l=1*new Date();k=e.createElement(t),a=e.getElementsByTagName(t)[0],k.async=1,k.src=r,a.parentNode.insertBefore(k,a)})
    (window, document, "script", "https://mc.yandex.ru/metrika/tag.js", "ym");

    ym(24049213, "init", {
      defer:true,
      trackLinks:true,
      accurateTrackBounce:true,
      webvisor:false,
    });
  </script> 
  <noscript> 
   <div> 
    <img src="https://mc.yandex.ru/watch/24049213" style="position:absolute; left:-9999px;" alt=""> 
   </div> 
  </noscript> 
  <script type="text/javascript">
      window.addEventListener('load', function () {
        setTimeout(() => {
          const img = new Image();
          img.src = 'https://vk.com/rtrg?p=VK-RTRG-421343-57vKE';
        }, 0);
      });
    </script> 
  <script src="/js/ads.js" onload="window['zhY4i4nJ9K'] = true"></script>  
 </body>
</html>